!function(root,factory){"use strict";"function"==typeof define&&define.amd?define([],factory):"object"==typeof exports?module.exports=factory():root.viewportUnitsBuggyfill=factory()}(this,function(){"use strict";function debounce(func,wait){var timeout;return function(){var context=this,args=arguments,callback=function(){func.apply(context,args)};clearTimeout(timeout),timeout=setTimeout(callback,wait)}}function inIframe(){try{return window.self!==window.top}catch(e){return!0}}function initialize(initOptions){initialized||(initOptions===!0&&(initOptions={force:!0}),options=initOptions||{},options.isMobileSafari=isMobileSafari,options.isBadStockAndroid=isBadStockAndroid,(options.force||isMobileSafari||isOldInternetExplorer||isBadStockAndroid||isOperaMini||options.hacks&&options.hacks.required(options))&&(options.hacks&&options.hacks.initialize(options),initialized=!0,styleNode=document.createElement("style"),styleNode.id="patched-viewport",document.head.appendChild(styleNode),importCrossOriginLinks(function(){var _refresh=debounce(refresh,options.refreshDebounceWait||100);window.addEventListener("orientationchange",_refresh,!0),window.addEventListener("pageshow",_refresh,!0),(options.force||isOldInternetExplorer||inIframe())&&(window.addEventListener("resize",_refresh,!0),options._listeningToResize=!0),options.hacks&&options.hacks.initializeEvents(options,refresh,_refresh),refresh()})))}function updateStyles(){styleNode.textContent=getReplacedViewportUnits(),styleNode.parentNode.appendChild(styleNode)}function refresh(){initialized&&(findProperties(),setTimeout(function(){updateStyles()},1))}function findProperties(){return declarations=[],forEach.call(document.styleSheets,function(sheet){"patched-viewport"!==sheet.ownerNode.id&&sheet.cssRules&&"ignore"!==sheet.ownerNode.getAttribute("data-viewport-units-buggyfill")&&(sheet.media&&sheet.media.mediaText&&window.matchMedia&&!window.matchMedia(sheet.media.mediaText).matches||forEach.call(sheet.cssRules,findDeclarations))}),declarations}function findDeclarations(rule){if(7===rule.type){var value;try{value=rule.cssText}catch(e){return}return viewportUnitExpression.lastIndex=0,void(viewportUnitExpression.test(value)&&(declarations.push([rule,null,value]),options.hacks&&options.hacks.findDeclarations(declarations,rule,null,value)))}if(!rule.style){if(!rule.cssRules)return;return void forEach.call(rule.cssRules,function(_rule){findDeclarations(_rule)})}forEach.call(rule.style,function(name){var value=rule.style.getPropertyValue(name);viewportUnitExpression.lastIndex=0,viewportUnitExpression.test(value)&&(declarations.push([rule,name,value]),options.hacks&&options.hacks.findDeclarations(declarations,rule,name,value))})}function getReplacedViewportUnits(){dimensions=getViewport();var open,close,css=[],buffer=[];return declarations.forEach(function(item){var _item=overwriteDeclaration.apply(null,item),_open=_item.selector.length?_item.selector.join(" {\n")+" {\n":"",_close=new Array(_item.selector.length+1).join("\n}");return _open&&_open===open?(_open&&!open&&(open=_open,close=_close),void buffer.push(_item.content)):(buffer.length&&(css.push(open+buffer.join("\n")+close),buffer.length=0),void(_open?(open=_open,close=_close,buffer.push(_item.content)):(css.push(_item.content),open=null,close=null)))}),buffer.length&&css.push(open+buffer.join("\n")+close),isOperaMini&&css.push("* { content: normal !important; }"),css.join("\n\n")}function overwriteDeclaration(rule,name,value){var _value,_selectors=[];_value=value.replace(viewportUnitExpression,replaceValues),options.hacks&&(_value=options.hacks.overwriteDeclaration(rule,name,_value)),name&&(_selectors.push(rule.selectorText),_value=name+": "+_value+";");for(var _rule=rule.parentRule;_rule;)_selectors.unshift("@media "+_rule.media.mediaText),_rule=_rule.parentRule;return{selector:_selectors,content:_value}}function replaceValues(match,number,unit){var _base=dimensions[unit],_number=parseFloat(number)/100;return _number*_base+"px"}function getViewport(){var vh=window.innerHeight,vw=window.innerWidth;return{vh:vh,vw:vw,vmax:Math.max(vw,vh),vmin:Math.min(vw,vh)}}function importCrossOriginLinks(next){var _waiting=0,decrease=function(){_waiting--,_waiting||next()};forEach.call(document.styleSheets,function(sheet){sheet.href&&origin(sheet.href)!==origin(location.href)&&(_waiting++,convertLinkToStyle(sheet.ownerNode,decrease))}),_waiting||next()}function origin(url){return url.slice(0,url.indexOf("/",url.indexOf("://")+3))}function convertLinkToStyle(link,next){getCors(link.href,function(){var style=document.createElement("style");style.media=link.media,style.setAttribute("data-href",link.href),style.textContent=this.responseText,link.parentNode.replaceChild(style,link),next()},next)}function getCors(url,success,error){var xhr=new XMLHttpRequest;if("withCredentials"in xhr)xhr.open("GET",url,!0);else{if("undefined"==typeof XDomainRequest)throw new Error("cross-domain XHR not supported");xhr=new XDomainRequest,xhr.open("GET",url)}return xhr.onload=success,xhr.onerror=error,xhr.send(),xhr}var options,dimensions,declarations,styleNode,initialized=!1,userAgent=window.navigator.userAgent,viewportUnitExpression=/([+-]?[0-9.]+)(vh|vw|vmin|vmax)/g,forEach=[].forEach,isOldInternetExplorer=!1,isOperaMini=userAgent.indexOf("Opera Mini")>-1,isMobileSafari=/(iPhone|iPod|iPad).+AppleWebKit/i.test(userAgent)&&function(){var iOSversion=userAgent.match(/OS (\d)/);return iOSversion&&iOSversion.length>1&&parseInt(iOSversion[1])<8}(),isBadStockAndroid=function(){var isAndroid=userAgent.indexOf(" Android ")>-1;if(!isAndroid)return!1;var isStockAndroid=userAgent.indexOf("Version/")>-1;if(!isStockAndroid)return!1;var versionNumber=parseFloat((userAgent.match("Android ([0-9.]+)")||[])[1]);return 4.4>=versionNumber}();return isOldInternetExplorer||(isOldInternetExplorer=!!navigator.userAgent.match(/Trident.*rv[ :]*11\./)),{version:"0.5.0",findProperties:findProperties,getCss:getReplacedViewportUnits,init:initialize,refresh:refresh}}),function(){"use strict";function FastClick(layer,options){function bind(method,context){return function(){return method.apply(context,arguments)}}var oldOnClick;if(options=options||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=options.touchBoundary||10,this.layer=layer,this.tapDelay=options.tapDelay||200,this.tapTimeout=options.tapTimeout||700,!FastClick.notNeeded(layer)){for(var methods=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],context=this,i=0,l=methods.length;l>i;i++)context[methods[i]]=bind(context[methods[i]],context);deviceIsAndroid&&(layer.addEventListener("mouseover",this.onMouse,!0),layer.addEventListener("mousedown",this.onMouse,!0),layer.addEventListener("mouseup",this.onMouse,!0)),layer.addEventListener("click",this.onClick,!0),layer.addEventListener("touchstart",this.onTouchStart,!1),layer.addEventListener("touchmove",this.onTouchMove,!1),layer.addEventListener("touchend",this.onTouchEnd,!1),layer.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(layer.removeEventListener=function(type,callback,capture){var rmv=Node.prototype.removeEventListener;"click"===type?rmv.call(layer,type,callback.hijacked||callback,capture):rmv.call(layer,type,callback,capture)},layer.addEventListener=function(type,callback,capture){var adv=Node.prototype.addEventListener;"click"===type?adv.call(layer,type,callback.hijacked||(callback.hijacked=function(event){event.propagationStopped||callback(event)}),capture):adv.call(layer,type,callback,capture)}),"function"==typeof layer.onclick&&(oldOnClick=layer.onclick,layer.addEventListener("click",function(event){oldOnClick(event)},!1),layer.onclick=null)}}var deviceIsWindowsPhone=navigator.userAgent.indexOf("Windows Phone")>=0,deviceIsAndroid=navigator.userAgent.indexOf("Android")>0&&!deviceIsWindowsPhone,deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent)&&!deviceIsWindowsPhone,deviceIsIOS4=deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),deviceIsIOSWithBadTarget=deviceIsIOS&&/OS [6-7]_\d/.test(navigator.userAgent),deviceIsBlackBerry10=navigator.userAgent.indexOf("BB10")>0;FastClick.prototype.needsClick=function(target){switch(target.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(target.disabled)return!0;break;case"input":if(deviceIsIOS&&"file"===target.type||target.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(target.className)},FastClick.prototype.needsFocus=function(target){switch(target.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!deviceIsAndroid;case"input":switch(target.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!target.disabled&&!target.readOnly;default:return/\bneedsfocus\b/.test(target.className)}},FastClick.prototype.sendClick=function(targetElement,event){var clickEvent,touch;document.activeElement&&document.activeElement!==targetElement&&document.activeElement.blur(),touch=event.changedTouches[0],clickEvent=document.createEvent("MouseEvents"),clickEvent.initMouseEvent(this.determineEventType(targetElement),!0,!0,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,!1,!1,!1,!1,0,null),clickEvent.forwardedTouchEvent=!0,targetElement.dispatchEvent(clickEvent)},FastClick.prototype.determineEventType=function(targetElement){return deviceIsAndroid&&"select"===targetElement.tagName.toLowerCase()?"mousedown":"click"},FastClick.prototype.focus=function(targetElement){var length;deviceIsIOS&&targetElement.setSelectionRange&&0!==targetElement.type.indexOf("date")&&"time"!==targetElement.type&&"month"!==targetElement.type?(length=targetElement.value.length,targetElement.setSelectionRange(length,length)):targetElement.focus()},FastClick.prototype.updateScrollParent=function(targetElement){var scrollParent,parentElement;if(scrollParent=targetElement.fastClickScrollParent,!scrollParent||!scrollParent.contains(targetElement)){parentElement=targetElement;do{if(parentElement.scrollHeight>parentElement.offsetHeight){scrollParent=parentElement,targetElement.fastClickScrollParent=parentElement;break}parentElement=parentElement.parentElement}while(parentElement)}scrollParent&&(scrollParent.fastClickLastScrollTop=scrollParent.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(eventTarget){return eventTarget.nodeType===Node.TEXT_NODE?eventTarget.parentNode:eventTarget},FastClick.prototype.onTouchStart=function(event){var targetElement,touch,selection;if(event.targetTouches.length>1)return!0;if(targetElement=this.getTargetElementFromEventTarget(event.target),touch=event.targetTouches[0],deviceIsIOS){if(selection=window.getSelection(),selection.rangeCount&&!selection.isCollapsed)return!0;if(!deviceIsIOS4){if(touch.identifier&&touch.identifier===this.lastTouchIdentifier)return event.preventDefault(),!1;this.lastTouchIdentifier=touch.identifier,this.updateScrollParent(targetElement)}}return this.trackingClick=!0,this.trackingClickStart=event.timeStamp,this.targetElement=targetElement,this.touchStartX=touch.pageX,this.touchStartY=touch.pageY,event.timeStamp-this.lastClickTime<this.tapDelay&&event.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(event){var touch=event.changedTouches[0],boundary=this.touchBoundary;return Math.abs(touch.pageX-this.touchStartX)>boundary||Math.abs(touch.pageY-this.touchStartY)>boundary},FastClick.prototype.onTouchMove=function(event){return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(event.target)||this.touchHasMoved(event))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},FastClick.prototype.findControl=function(labelElement){return void 0!==labelElement.control?labelElement.control:labelElement.htmlFor?document.getElementById(labelElement.htmlFor):labelElement.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(event){var forElement,trackingClickStart,targetTagName,scrollParent,touch,targetElement=this.targetElement;if(!this.trackingClick)return!0;if(event.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(event.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=event.timeStamp,trackingClickStart=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,deviceIsIOSWithBadTarget&&(touch=event.changedTouches[0],targetElement=document.elementFromPoint(touch.pageX-window.pageXOffset,touch.pageY-window.pageYOffset)||targetElement,targetElement.fastClickScrollParent=this.targetElement.fastClickScrollParent),targetTagName=targetElement.tagName.toLowerCase(),"label"===targetTagName){if(forElement=this.findControl(targetElement)){if(this.focus(targetElement),deviceIsAndroid)return!1;targetElement=forElement}}else if(this.needsFocus(targetElement))return event.timeStamp-trackingClickStart>100||deviceIsIOS&&window.top!==window&&"input"===targetTagName?(this.targetElement=null,!1):(this.focus(targetElement),this.sendClick(targetElement,event),deviceIsIOS&&"select"===targetTagName||(this.targetElement=null,event.preventDefault()),!1);return deviceIsIOS&&!deviceIsIOS4&&(scrollParent=targetElement.fastClickScrollParent,scrollParent&&scrollParent.fastClickLastScrollTop!==scrollParent.scrollTop)?!0:(this.needsClick(targetElement)||(event.preventDefault(),this.sendClick(targetElement,event)),!1)},FastClick.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(event){return this.targetElement?event.forwardedTouchEvent?!0:event.cancelable&&(!this.needsClick(this.targetElement)||this.cancelNextClick)?(event.stopImmediatePropagation?event.stopImmediatePropagation():event.propagationStopped=!0,event.stopPropagation(),event.preventDefault(),!1):!0:!0},FastClick.prototype.onClick=function(event){var permitted;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===event.target.type&&0===event.detail?!0:(permitted=this.onMouse(event),permitted||(this.targetElement=null),permitted)},FastClick.prototype.destroy=function(){var layer=this.layer;deviceIsAndroid&&(layer.removeEventListener("mouseover",this.onMouse,!0),layer.removeEventListener("mousedown",this.onMouse,!0),layer.removeEventListener("mouseup",this.onMouse,!0)),layer.removeEventListener("click",this.onClick,!0),layer.removeEventListener("touchstart",this.onTouchStart,!1),layer.removeEventListener("touchmove",this.onTouchMove,!1),layer.removeEventListener("touchend",this.onTouchEnd,!1),layer.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(layer){var metaViewport,chromeVersion,blackberryVersion,firefoxVersion;if("undefined"==typeof window.ontouchstart)return!0;if(chromeVersion=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!deviceIsAndroid)return!0;if(metaViewport=document.querySelector("meta[name=viewport]")){if(-1!==metaViewport.content.indexOf("user-scalable=no"))return!0;if(chromeVersion>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(deviceIsBlackBerry10&&(blackberryVersion=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),blackberryVersion[1]>=10&&blackberryVersion[2]>=3&&(metaViewport=document.querySelector("meta[name=viewport]")))){if(-1!==metaViewport.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===layer.style.msTouchAction||"manipulation"===layer.style.touchAction?!0:(firefoxVersion=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],firefoxVersion>=27&&(metaViewport=document.querySelector("meta[name=viewport]"),metaViewport&&(-1!==metaViewport.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))?!0:"none"===layer.style.touchAction||"manipulation"===layer.style.touchAction)},FastClick.attach=function(layer,options){return new FastClick(layer,options)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return FastClick}):"undefined"!=typeof module&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick}(),function($,exports){"use strict";$.fn.djax=function(selector,exceptions,replaceBlockWithFunc){if(!history.pushState)return $(this);var self=this,blockSelector=selector,excludes=exceptions&&exceptions.length?exceptions:[],replaceBlockWith=replaceBlockWithFunc?replaceBlockWithFunc:$.fn.replaceWith;window.history.replaceState({url:window.location.href,title:$("title").text()},$("title").text(),window.location.href),self.clearDjaxing=function(){self.djaxing=!1},self.attachClick=function(element,event){var link=$(element),exception=!1;return $.each(excludes,function(index,exclusion){-1!==link.attr("href").indexOf(exclusion)&&(exception=!0),-1!==window.location.href.indexOf(exclusion)&&(exception=!0)}),exception?$(element):(event.preventDefault(),self.djaxing?(setTimeout(self.clearDjaxing,1e3),$(element)):($(window).trigger("djaxClick",[element]),self.reqUrl=link.attr("href"),self.triggered=!1,void self.navigate(link.attr("href"),!0)))},self.navigate=function(url,add){var blocks=$(blockSelector);self.djaxing=!0,$(window).trigger("djaxLoading",[{url:url}]);var replaceBlocks=function(response){if(url!==self.reqUrl)return self.navigate(self.reqUrl,!1),!0;var result=$(response),newBlocks=$(result).find(blockSelector);add&&window.history.pushState({url:url,title:$(result).filter("title").text()},$(result).filter("title").text(),url),$("title").text($(result).filter("title").text()),blocks.each(function(){var id="#"+$(this).attr("id"),newBlock=newBlocks.filter(id),block=$(this);$("a",newBlock).filter(function(){return this.hostname===location.hostname}).addClass("dJAX_internal").on("click",function(event){return self.attachClick(this,event)}),newBlock.length?block.html()!==newBlock.html()&&replaceBlockWith.call(block,newBlock):block.remove()}),$.each(newBlocks,function(){var $previousSibling,newBlock=$(this),id="#"+$(this).attr("id");$(id).length||($previousSibling=$(result).find(id).prev(),$previousSibling.length?newBlock.insertAfter("#"+$previousSibling.attr("id")):newBlock.prependTo("#"+newBlock.parent().attr("id"))),$("a",newBlock).filter(function(){return this.hostname===location.hostname}).addClass("dJAX_internal").on("click",function(event){return self.attachClick(this,event)})}),self.triggered||($(window).trigger("djaxLoad",[{url:url,title:$(result).filter("title").text(),response:response}]),self.triggered=!0,self.djaxing=!1)};$.get(url,function(response){replaceBlocks(response)}).error(function(response){console.log("error",response),replaceBlocks(response.responseText)})},$(this).find("a").filter(function(){return this.hostname===location.hostname}).addClass("dJAX_internal").on("click",function(event){return self.attachClick(this,event)}),$(window).bind("popstate",function(event){self.triggered=!1,event.originalEvent.state&&(self.reqUrl=event.originalEvent.state.url,self.navigate(event.originalEvent.state.url,!1))})}}(jQuery,window),function(root,factory){"use strict";"function"==typeof define&&define.amd?define("seriously",function(){var Seriously=factory(root);return root.Seriously||(root.Seriously=Seriously),Seriously}):"object"==typeof exports?module.exports=factory(root):"function"!=typeof root.Seriously&&(root.Seriously=factory(root))}(this,function(window){"use strict";function getElement(input,tags){var element,tag;if("string"==typeof input)element=document.querySelector(input);else if(!input)return!1;return input.tagName&&(element=input),element?(tag=element.tagName.toLowerCase(),tags&&tags.indexOf(tag)<0?input:element):input}function extend(dest,src){var property,descriptor;dest.prototype&&src.prototype&&dest.prototype!==src.prototype&&extend(dest.prototype,src.prototype);for(property in src)src.hasOwnProperty(property)&&(descriptor=Object.getOwnPropertyDescriptor(src,property),descriptor.get||descriptor.set?Object.defineProperty(dest,property,{configurable:!0,enumerable:!0,get:descriptor.get,set:descriptor.set}):dest[property]=src[property]);return dest}function consoleMethod(name){var method;if(!console)return nop;if("function"==typeof console[name])method=console[name];else{if("function"!=typeof console.log)return nop;method=console.log}return method.bind?method.bind(console):function(){method.apply(console,arguments)}}function hslToRgb(h,s,l,a,out){function hueToRgb(m1,m2,h){return h%=1,0>h&&(h+=1),1/6>h?m1+(m2-m1)*h*6:.5>h?m2:2/3>h?m1+(m2-m1)*(2/3-h)*6:m1}var m1,m2;return m2=.5>l?l*(s+1):l+s-l*s,m1=2*l-m2,out||(out=[]),out[0]=hueToRgb(m1,m2,h+1/3),out[1]=hueToRgb(m1,m2,h),out[2]=hueToRgb(m1,m2,h-1/3),out[3]=a,out}function colorArrayToHex(color){var i,val,hex,s="#",len=color[3]<1?4:3;for(i=0;len>i;i++)val=Math.min(255,Math.round(255*color[i]||0)),hex=val.toString(16),16>val&&(hex="0"+hex),s+=hex;return s}function isArrayLike(obj){return Array.isArray(obj)||obj&&obj.BYTES_PER_ELEMENT&&"length"in obj}function setTimeoutZero(fn){function timeoutFunction(){timeouts.length&&timeouts.shift()()}if("function"!=typeof fn)throw new Error("setTimeoutZero argument is not a function");return timeouts.push(fn),"file:"===window.location.protocol?void setTimeout(timeoutFunction,0):void window.postMessage("seriously-timeout-message",window.location)}function getWebGlContext(canvas,options){var context;try{context=window.WebGLDebugUtils&&options&&options.debugContext?window.WebGLDebugUtils.makeDebugContext(canvas.getContext("webgl",options)):canvas.getContext("webgl",options)}catch(expError){}if(!context)try{context=canvas.getContext("experimental-webgl",options)}catch(error){}return context}function getTestContext(){var canvas;return testContext&&testContext.getError()===testContext.CONTEXT_LOST_WEBGL&&(testContext=void 0),testContext||!window.WebGLRenderingContext||incompatibility?testContext:(canvas=document.createElement("canvas"),testContext=getWebGlContext(canvas),testContext?canvas.addEventListener("webglcontextlost",function contextLost(event){event.preventDefault(),testContext&&testContext.canvas===this&&(testContext=void 0,canvas.removeEventListener("webglcontextlost",contextLost,!1))},!1):Seriously.logger.warn("Unable to access WebGL."),testContext)}function checkSource(source){var element,canvas,ctx,texture;if(element=getElement(source,["img","canvas","video"]),!element)return!1;if(canvas=document.createElement("canvas"),!canvas)return Seriously.logger.warn("Browser does not support canvas or Seriously.js"),!1;if(0===element.naturalWidth&&"IMG"===element.tagName)return Seriously.logger.warn("Image not loaded"),!1;if(0===element.readyState&&0===element.videoWidth&&"VIDEO"===element.tagName)return Seriously.logger.warn("Video not loaded"),!1;if(ctx=getTestContext()){texture=ctx.createTexture(),texture||Seriously.logger.error("Test WebGL context has been lost"),ctx.bindTexture(ctx.TEXTURE_2D,texture);try{ctx.texImage2D(ctx.TEXTURE_2D,0,ctx.RGBA,ctx.RGBA,ctx.UNSIGNED_BYTE,element)}catch(textureError){return textureError.code===window.DOMException.SECURITY_ERR?Seriously.logger.log("Unable to access cross-domain image"):Seriously.logger.error("Error storing image to texture: "+textureError.message),ctx.deleteTexture(texture),!1}ctx.deleteTexture(texture)}else{ctx=canvas.getContext("2d");try{ctx.drawImage(element,0,0),ctx.getImageData(0,0,1,1)}catch(drawImageError){return drawImageError.code===window.DOMException.SECURITY_ERR?Seriously.logger.log("Unable to access cross-domain image"):Seriously.logger.error("Error drawing image to canvas: "+drawImageError.message),!1}}return!0}function validateInputSpecs(plugin){function normalizeEnumOption(option,i){var key,name;isArrayLike(option)?(key=option[0],name=option[1]||key):key=option,"string"==typeof key?key=key.toLowerCase():"number"==typeof key?key=String(key):key||(key=""),options[key]=name,i||(input.firstValue=key)}function passThrough(value){return value}var input,options,name;for(name in plugin.inputs)if(plugin.inputs.hasOwnProperty(name)){if(plugin.reserved.indexOf(name)>=0||Object.prototype[name])throw new Error("Reserved input name: "+name);input=plugin.inputs[name],input.name=name,isNaN(input.min)&&(input.min=-(1/0)),isNaN(input.max)&&(input.max=1/0),isNaN(input.minCount)&&(input.minCount=-(1/0)),isNaN(input.maxCount)&&(input.maxCount=1/0),isNaN(input.step)&&(input.step=0),"enum"===input.type&&input.options&&isArrayLike(input.options)&&input.options.length&&(options={},input.options.forEach(normalizeEnumOption),input.options=options),"vector"===input.type?input.dimensions<2?input.dimensions=2:input.dimensions>4?input.dimensions=4:!input.dimensions||isNaN(input.dimensions)?input.dimensions=4:input.dimensions=Math.round(input.dimensions):input.dimensions=1,input.shaderDirty=!!input.shaderDirty,"function"!=typeof input.validate&&(input.validate=Seriously.inputValidators[input.type]||passThrough),plugin.defaultImageInput||"image"!==input.type||(plugin.defaultImageInput=name)}}function FrameBuffer(gl,width,height,options){var frameBuffer,renderBuffer,tex,status,useFloat=options===!0?options:options&&options.useFloat;useFloat=!1,useFloat?this.type=gl.FLOAT:this.type=gl.UNSIGNED_BYTE,frameBuffer=gl.createFramebuffer(),gl.bindFramebuffer(gl.FRAMEBUFFER,frameBuffer),options&&options.texture?(this.texture=options.texture,gl.bindTexture(gl.TEXTURE_2D,this.texture),this.ownTexture=!1):(this.texture=gl.createTexture(),gl.bindTexture(gl.TEXTURE_2D,this.texture),gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),this.ownTexture=!0);try{this.type===gl.FLOAT?(tex=new Float32Array(width*height*4),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,width,height,0,gl.RGBA,gl.FLOAT,tex)):(gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,width,height,0,gl.RGBA,gl.UNSIGNED_BYTE,null),this.type=gl.UNSIGNED_BYTE)}catch(e){this.type=gl.UNSIGNED_BYTE,tex=new Uint8Array(width*height*4),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,width,height,0,gl.RGBA,gl.UNSIGNED_BYTE,tex)}if(renderBuffer=gl.createRenderbuffer(),gl.bindRenderbuffer(gl.RENDERBUFFER,renderBuffer),gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_COMPONENT16,width,height),gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_ATTACHMENT,gl.RENDERBUFFER,renderBuffer),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,this.texture,0),status=gl.checkFramebufferStatus(gl.FRAMEBUFFER),status===gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT)throw new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");if(status===gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT)throw new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");if(status===gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS)throw new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");if(status===gl.FRAMEBUFFER_UNSUPPORTED)throw new Error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");if(status!==gl.FRAMEBUFFER_COMPLETE)throw new Error("Incomplete framebuffer: "+status);gl.bindTexture(gl.TEXTURE_2D,null),gl.bindRenderbuffer(gl.RENDERBUFFER,null),gl.bindFramebuffer(gl.FRAMEBUFFER,null),this.gl=gl,this.frameBuffer=frameBuffer,this.renderBuffer=renderBuffer,this.width=width,this.height=height}function ShaderProgram(gl,vertexShaderSource,fragmentShaderSource){function compileShader(source,fragment){var shader,j;if(shader=fragment?gl.createShader(gl.FRAGMENT_SHADER):gl.createShader(gl.VERTEX_SHADER),gl.shaderSource(shader,source),gl.compileShader(shader),!gl.getShaderParameter(shader,gl.COMPILE_STATUS)){for(source=source.split(/[\n\r]/),j=0;j<source.length;j++)source[j]=j+1+":	"+source[j];throw source.unshift("Error compiling "+(fragment?"fragment":"vertex")+" shader:"),Seriously.logger.error(source.join("\n")),new Error("Shader error: "+gl.getShaderInfoLog(shader))}return shader}function makeShaderSetter(info,loc){if(info.type===gl.SAMPLER_2D)return function(value){info.glTexture=gl["TEXTURE"+value],gl.uniform1i(loc,value)};if(info.type===gl.BOOL||info.type===gl.INT)return info.size>1?function(value){gl.uniform1iv(loc,value)}:function(value){gl.uniform1i(loc,value)};if(info.type===gl.FLOAT)return info.size>1?function(value){gl.uniform1fv(loc,value)}:function(value){gl.uniform1f(loc,value)};if(info.type===gl.FLOAT_VEC2)return function(obj){gl.uniform2f(loc,obj[0],obj[1])};if(info.type===gl.FLOAT_VEC3)return function(obj){gl.uniform3f(loc,obj[0],obj[1],obj[2])};if(info.type===gl.FLOAT_VEC4)return function(obj){gl.uniform4f(loc,obj[0],obj[1],obj[2],obj[3])};if(info.type===gl.FLOAT_MAT3)return function(mat3){gl.uniformMatrix3fv(loc,!1,mat3)};if(info.type===gl.FLOAT_MAT4)return function(mat4){gl.uniformMatrix4fv(loc,!1,mat4)};throw new Error("Unknown shader uniform type: "+info.type)}function makeShaderGetter(loc){return function(){return gl.getUniform(program,loc)}}var program,vertexShader,fragmentShader,shaderError,i,l,obj,programError="";if(vertexShader=compileShader(vertexShaderSource),fragmentShader=compileShader(fragmentShaderSource,!0),program=gl.createProgram(),gl.attachShader(program,vertexShader),shaderError=gl.getShaderInfoLog(vertexShader),shaderError&&(programError+="Vertex shader error: "+shaderError+"\n"),gl.attachShader(program,fragmentShader),shaderError=gl.getShaderInfoLog(fragmentShader),shaderError&&(programError+="Fragment shader error: "+shaderError+"\n"),gl.linkProgram(program),!gl.getProgramParameter(program,gl.LINK_STATUS))throw programError+=gl.getProgramInfoLog(program),gl.deleteProgram(program),gl.deleteShader(vertexShader),gl.deleteShader(fragmentShader),new Error("Could not initialise shader: "+programError);for(gl.useProgram(program),this.uniforms={},l=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS),i=0;l>i;++i)obj={info:gl.getActiveUniform(program,i)},obj.name=obj.info.name,obj.loc=gl.getUniformLocation(program,obj.name),obj.set=makeShaderSetter(obj.info,obj.loc),obj.get=makeShaderGetter(obj.loc),this.uniforms[obj.name]=obj,this[obj.name]||(this[obj.name]=obj);for(this.attributes={},this.location={},l=gl.getProgramParameter(program,gl.ACTIVE_ATTRIBUTES),i=0;l>i;++i)obj={info:gl.getActiveAttrib(program,i)},obj.name=obj.info.name,obj.location=gl.getAttribLocation(program,obj.name),this.attributes[obj.name]=obj,this.location[obj.name]=obj.location;this.gl=gl,this.program=program,this.destroy=function(){var key;gl&&(gl.deleteProgram(program),gl.deleteShader(vertexShader),gl.deleteShader(fragmentShader));for(key in this)this.hasOwnProperty(key)&&delete this[key];program=null,vertexShader=null,fragmentShader=null}}function Seriously(options){function makeGlModel(shape,gl){var vertex,index,texCoord;return gl?(vertex=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,vertex),gl.bufferData(gl.ARRAY_BUFFER,shape.vertices,gl.STATIC_DRAW),vertex.size=3,index=gl.createBuffer(),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,index),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,shape.indices,gl.STATIC_DRAW),texCoord=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,texCoord),gl.bufferData(gl.ARRAY_BUFFER,shape.coords,gl.STATIC_DRAW),texCoord.size=2,{vertex:vertex,index:index,texCoord:texCoord,length:shape.indices.length,mode:shape.mode||gl.TRIANGLES}):!1}function buildRectangleModel(gl){var shape={};return shape.vertices=new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0]),shape.indices=new Uint16Array([0,1,2,0,2,3]),shape.coords=new Float32Array([0,0,1,0,1,1,0,1]),makeGlModel(shape,gl)}function attachContext(context){var i,node;if(!gl){if(context.canvas.addEventListener("webglcontextlost",destroyContext,!1),context.canvas.addEventListener("webglcontextrestored",restoreContext,!1),context.isContextLost())return void Seriously.logger.warn("Unable to attach lost WebGL context. Will try again when context is restored.");
for(gl=context,glCanvas=context.canvas,rectangleModel=buildRectangleModel(gl),baseShader=new ShaderProgram(gl,baseVertexShader,baseFragmentShader),i=0;i<effects.length;i++)node=effects[i],node.gl=gl,node.initialize(),node.buildShader();for(i=0;i<sources.length;i++)node=sources[i],node.initialize();for(i=0;i<targets.length;i++)node=targets[i],node.model||(node.model=rectangleModel,node.shader=baseShader)}}function restoreContext(){var context,target,i,node;if(primaryTarget&&!gl){if(target=primaryTarget.target,target instanceof WebGLFramebuffer)return void Seriously.logger.error("Unable to restore target built on WebGLFramebuffer");if(context=getWebGlContext(target,{alpha:!0,premultipliedAlpha:!1,preserveDrawingBuffer:!0,stencil:!0,debugContext:primaryTarget.debugContext})){if(context.isContextLost())return void Seriously.logger.error("Unable to restore WebGL Context");for(attachContext(context),primaryTarget.renderToTexture?primaryTarget.frameBuffer=new FrameBuffer(gl,primaryTarget.width,primaryTarget.height,!1):primaryTarget.frameBuffer={frameBuffer:null},i=0;i<nodes.length;i++)node=nodes[i],node.setDirty(),node.emit("webglcontextrestored");Seriously.logger.log("WebGL context restored")}}}function destroyContext(event){var i,node;for(event&&(Seriously.logger.warn("WebGL context lost"),event.preventDefault()),rafId&&(cancelAnimFrame(rafId),rafId=0),glCanvas&&glCanvas.removeEventListener("webglcontextlost",destroyContext,!1),i=0;i<effects.length;i++)node=effects[i],node.gl=null,node.initialized=!1,node.baseShader=null,node.model=null,node.frameBuffer=null,node.texture=null,node.shader&&node.shader.destroy&&node.shader.destroy(),node.shaderDirty=!0,node.shader=null,node.effect.lostContext&&node.effect.lostContext.call(node),event&&node.emit("webglcontextlost");for(i=0;i<sources.length;i++)node=sources[i],node.texture=null,node.initialized=!1,node.allowRefresh=!1,event&&node.emit("webglcontextlost");for(i=0;i<transforms.length;i++)node=transforms[i],node.frameBuffer=null,node.texture=null,event&&node.emit("webglcontextlost");for(i=0;i<targets.length;i++)node=targets[i],node.model=!1,node.frameBuffer=null,event&&node.emit("webglcontextlost");baseShader&&baseShader.destroy&&baseShader.destroy(),gl&&(gl.deleteBuffer(rectangleModel.vertex),gl.deleteBuffer(rectangleModel.texCoord),gl.deleteBuffer(rectangleModel.index)),rectangleModel&&(delete rectangleModel.vertex,delete rectangleModel.texCoord,delete rectangleModel.index),rectangleModel=null,baseShader=null,gl=null,glCanvas=null}function renderDaemon(now){var i,node,media,keepRunning=!1;if(rafId=0,preCallbacks.length)for(keepRunning=!0,i=0;i<preCallbacks.length;i++)preCallbacks[i].call(seriously,now);if(sources&&sources.length)for(keepRunning=!0,i=0;i<sources.length;i++)node=sources[i],media=node.source,(node.dirty||node.checkDirty&&node.checkDirty())&&(node.dirty=!1,node.setDirty());for(i=0;i<targets.length;i++)node=targets[i],node.auto&&node.dirty&&node.render();if(postCallbacks.length)for(keepRunning=!0,i=0;i<postCallbacks.length;i++)postCallbacks[i].call(seriously);keepRunning&&!rafId&&(rafId=requestAnimationFrame(renderDaemon))}function draw(shader,model,uniforms,frameBuffer,node,options){var name,value,shaderUniform,width,height,srcRGB,srcAlpha,dstRGB,dstAlpha,numTextures=0,nodeGl=node&&node.gl||gl;if(nodeGl){node?(width=options&&options.width||node.width||nodeGl.canvas.width,height=options&&options.height||node.height||nodeGl.canvas.height):(width=options&&options.width||nodeGl.canvas.width,height=options&&options.height||nodeGl.canvas.height),shader.use(),nodeGl.viewport(0,0,width,height),nodeGl.bindFramebuffer(nodeGl.FRAMEBUFFER,frameBuffer),nodeGl.enableVertexAttribArray(shader.location.position),nodeGl.enableVertexAttribArray(shader.location.texCoord),model.texCoord&&(nodeGl.bindBuffer(nodeGl.ARRAY_BUFFER,model.texCoord),nodeGl.vertexAttribPointer(shader.location.texCoord,model.texCoord.size,nodeGl.FLOAT,!1,0,0)),nodeGl.bindBuffer(nodeGl.ARRAY_BUFFER,model.vertex),nodeGl.vertexAttribPointer(shader.location.position,model.vertex.size,nodeGl.FLOAT,!1,0,0),nodeGl.bindBuffer(nodeGl.ELEMENT_ARRAY_BUFFER,model.index),options&&options.depth?gl.enable(gl.DEPTH_TEST):gl.disable(gl.DEPTH_TEST),options?void 0===options.blend||options.blend?(gl.enable(gl.BLEND),srcRGB=void 0===options.srcRGB?gl.ONE:options.srcRGB,dstRGB=options.dstRGB||gl.ZERO,srcAlpha=void 0===options.srcAlpha?srcRGB:options.srcAlpha,dstAlpha=void 0===options.dstAlpha?dstRGB:options.dstAlpha,gl.blendFuncSeparate(srcRGB,dstRGB,srcAlpha,dstAlpha),gl.blendEquation(options.blendEquation||gl.FUNC_ADD)):gl.disable(gl.BLEND):(gl.enable(gl.BLEND),gl.blendFunc(gl.ONE,gl.ZERO),gl.blendEquation(gl.FUNC_ADD));for(name in uniforms)uniforms.hasOwnProperty(name)&&(value=uniforms[name],shaderUniform=shader.uniforms[name],shaderUniform&&(value instanceof WebGLTexture?(nodeGl.activeTexture(nodeGl.TEXTURE0+numTextures),nodeGl.bindTexture(nodeGl.TEXTURE_2D,value),shaderUniform.set(numTextures),numTextures++):value instanceof SourceNode||value instanceof EffectNode||value instanceof TransformNode?value.texture&&(nodeGl.activeTexture(nodeGl.TEXTURE0+numTextures),nodeGl.bindTexture(nodeGl.TEXTURE_2D,value.texture),shaderUniform.set(numTextures),numTextures++):void 0!==value&&null!==value&&shaderUniform.set(value)));options&&void 0!==options.clear&&!options.clear||(nodeGl.clearColor(0,0,0,0),nodeGl.clear(nodeGl.COLOR_BUFFER_BIT|nodeGl.DEPTH_BUFFER_BIT)),nodeGl.drawElements(model.mode,model.length,nodeGl.UNSIGNED_SHORT,0),gl.enable(gl.DEPTH_TEST)}}function findInputNode(hook,source,options){var node,i;if(("string"!=typeof hook||!source&&0!==source)&&(options&&"object"==typeof options||(options=source),source=hook),"string"==typeof hook&&seriousSources[hook]||(hook=null),source instanceof SourceNode||source instanceof EffectNode||source instanceof TransformNode)node=source;else if(source instanceof Effect||source instanceof Source||source instanceof Transform){if(node=nodesById[source.id],!node)throw new Error("Cannot connect a foreign node")}else{for("string"==typeof source&&isNaN(source)&&(source=getElement(source,["canvas","img","video"])),i=0;i<sources.length;i++)if(node=sources[i],(!hook||hook===node.hook)&&node.compare&&node.compare(source,options))return node;node=new SourceNode(hook,source,options)}return node}function traceSources(node,original){var i,source,nodeSources;if(!(node instanceof EffectNode||node instanceof TransformNode))return!1;if(node===original)return!0;nodeSources=node.sources;for(i in nodeSources)if(nodeSources.hasOwnProperty(i)&&(source=nodeSources[i],source===original||traceSources(source,original)))return!0;return!1}if(window===this||!(this instanceof Seriously)||void 0!==this.id)return new Seriously(options);var glCanvas,gl,primaryTarget,rectangleModel,baseShader,baseVertexShader,baseFragmentShader,Node,SourceNode,EffectNode,TransformNode,TargetNode,Effect,Source,Transform,Target,rafId,id=++maxSeriouslyId,seriously=this,nodes=[],nodesById={},nodeId=0,sources=[],targets=[],transforms=[],effects=[],aliases={},preCallbacks=[],postCallbacks=[],defaultInputs={},commonShaders={},auto=!1,isDestroyed=!1;Node=function(){this.ready=!1,this.width=1,this.height=1,this.gl=gl,this.uniforms={resolution:[this.width,this.height],transform:null},this.dirty=!0,this.isDestroyed=!1,this.seriously=seriously,this.listeners={},this.id=nodeId,nodeId++},Node.prototype.setReady=function(){var i;if(!this.ready&&(this.ready=!0,this.emit("ready"),this.targets))for(i=0;i<this.targets.length;i++)this.targets[i].setReady()},Node.prototype.setUnready=function(){var i;if(this.ready&&(this.ready=!1,this.emit("unready"),this.targets))for(i=0;i<this.targets.length;i++)this.targets[i].setUnready()},Node.prototype.setDirty=function(){var i;if(!this.dirty&&(this.emit("dirty"),this.dirty=!0,this.targets))for(i=0;i<this.targets.length;i++)this.targets[i].setDirty()},Node.prototype.initFrameBuffer=function(useFloat){gl&&(this.frameBuffer=new FrameBuffer(gl,this.width,this.height,useFloat))},Node.prototype.readPixels=function(x,y,width,height,dest){var nodeGl=this.gl||gl;if(!gl)throw new Error("Cannot read pixels until a canvas is connected");if(this.frameBuffer||(this.initFrameBuffer(),this.setDirty()),this.render(),void 0===dest)dest=new Uint8Array(width*height*4);else if(!dest instanceof Uint8Array)throw new Error("Incompatible array type");return nodeGl.bindFramebuffer(gl.FRAMEBUFFER,this.frameBuffer.frameBuffer),nodeGl.readPixels(x,y,width,height,gl.RGBA,gl.UNSIGNED_BYTE,dest),dest},Node.prototype.resize=function(){var width,height;this.source?(width=this.source.width,height=this.source.height):this.sources&&this.sources.source?(width=this.sources.source.width,height=this.sources.source.height):this.inputs&&this.inputs.width?(width=this.inputs.width,height=this.inputs.height||width):this.inputs&&this.inputs.height?width=height=this.inputs.height:(width=1,height=1),width=Math.floor(width),height=Math.floor(height),this.width===width&&this.height===height||(this.width=width,this.height=height,this.emit("resize"),this.setDirty()),this.uniforms&&this.uniforms.resolution&&(this.uniforms.resolution[0]=width,this.uniforms.resolution[1]=height),this.frameBuffer&&this.frameBuffer.resize&&this.frameBuffer.resize(width,height)},Node.prototype.on=function(eventName,callback){var listeners,index=-1;eventName&&"function"==typeof callback&&(listeners=this.listeners[eventName],listeners?index=listeners.indexOf(callback):listeners=this.listeners[eventName]=[],0>index&&listeners.push(callback))},Node.prototype.off=function(eventName,callback){var listeners,index=-1;eventName&&"function"==typeof callback&&(listeners=this.listeners[eventName],listeners&&(index=listeners.indexOf(callback),index>=0&&listeners.splice(index,1)))},Node.prototype.emit=function(eventName){var i,listeners=this.listeners[eventName];if(listeners&&listeners.length)for(i=0;i<listeners.length;i++)setTimeoutZero(listeners[i])},Node.prototype.destroy=function(){var i,key;delete this.gl,delete this.seriously;for(key in this.listeners)this.listeners.hasOwnProperty(key)&&delete this.listeners[key];for(i in this.uniforms)this.uniforms.hasOwnProperty(i)&&delete this.uniforms[i];this.targets&&delete this.targets,this.frameBuffer&&this.frameBuffer.destroy&&(this.frameBuffer.destroy(),delete this.frameBuffer),i=nodes.indexOf(this),i>=0&&nodes.splice(i,1),delete nodesById[this.id],this.isDestroyed=!0},Effect=function(effectNode){function setInput(inputName,input){var lookup,value,effectInput;return effectInput=me.effect.inputs[inputName],lookup=me.inputElements[inputName],"string"==typeof input&&isNaN(input)&&("enum"===effectInput.type?effectInput.options.hasOwnProperty(input)||(input=getElement(input,["select"])):"number"===effectInput.type||"boolean"===effectInput.type?input=getElement(input,["input","select"]):"image"===effectInput.type&&(input=getElement(input,["canvas","img","video"]))),input instanceof HTMLInputElement||input instanceof HTMLSelectElement?(value=input.value,lookup&&lookup.element!==input&&(lookup.element.removeEventListener("change",lookup.listener,!0),lookup.element.removeEventListener("input",lookup.listener,!0),delete me.inputElements[inputName],lookup=null),lookup||(lookup={element:input,listener:function(name,element){return function(){var oldValue,newValue;oldValue="checkbox"===input.type?input.checked:element.value,newValue=me.setInput(name,oldValue),"color"===effectInput.type&&(newValue=colorArrayToHex(newValue).substr(0,7)),newValue!==oldValue&&(element.value=newValue)}}(inputName,input)},me.inputElements[inputName]=lookup,"range"===input.type?(input.addEventListener("input",lookup.listener,!0),input.addEventListener("change",lookup.listener,!0)):input.addEventListener("change",lookup.listener,!0)),lookup&&"checkbox"===input.type&&(value=input.checked)):(lookup&&(lookup.element.removeEventListener("change",lookup.listener,!0),lookup.element.removeEventListener("input",lookup.listener,!0),delete me.inputElements[inputName]),value=input),me.setInput(inputName,value),me.inputs[inputName]}function makeImageSetter(inputName){return function(value){var val=setInput(inputName,value);return val&&val.pub}}function makeImageGetter(inputName){return function(){var val=me.inputs[inputName];return val&&val.pub}}function makeSetter(inputName){return function(value){return setInput(inputName,value)}}function makeGetter(inputName){return function(){return me.inputs[inputName]}}var name,me=effectNode;for(name in me.effect.inputs)if(me.effect.inputs.hasOwnProperty(name)){if(void 0!==this[name])throw new Error("Cannot overwrite Seriously."+name);"image"===me.effect.inputs[name].type?Object.defineProperty(this,name,{configurable:!0,enumerable:!0,get:makeImageGetter(name),set:makeImageSetter(name)}):Object.defineProperty(this,name,{configurable:!0,enumerable:!0,get:makeGetter(name),set:makeSetter(name)})}Object.defineProperties(this,{effect:{enumerable:!0,configurable:!0,get:function(){return me.hook}},title:{enumerable:!0,configurable:!0,get:function(){return me.effect.title||me.hook}},width:{enumerable:!0,configurable:!0,get:function(){return me.width}},height:{enumerable:!0,configurable:!0,get:function(){return me.height}},id:{enumerable:!0,configurable:!0,get:function(){return me.id}}}),this.render=function(){return me.render(),this},this.readPixels=function(x,y,width,height,dest){return me.readPixels(x,y,width,height,dest)},this.on=function(eventName,callback){me.on(eventName,callback)},this.off=function(eventName,callback){me.off(eventName,callback)},this.inputs=function(name){var result,input,inputs,key;if(inputs=me.effect.inputs,name)return(input=inputs[name])?(result={type:input.type,defaultValue:input.defaultValue,title:input.title||name},"number"===input.type?(result.min=input.min,result.max=input.max,result.step=input.step):"enum"===input.type?result.options=extend({},input.options):"vector"===input.type&&(result.dimensions=input.dimensions),input.description&&(result.description=input.description),result):null;result={};for(key in inputs)inputs.hasOwnProperty(key)&&(result[key]=this.inputs(key));return result},this.alias=function(inputName,aliasName){return me.alias(inputName,aliasName),this},this.matte=function(polygons){me.matte(polygons)},this.destroy=function(){var i,descriptor;me.destroy();for(i in this)this.hasOwnProperty(i)&&"isDestroyed"!==i&&"id"!==i&&(descriptor=Object.getOwnPropertyDescriptor(this,i),descriptor.get||descriptor.set||"function"!=typeof this[i]?delete this[i]:this[i]=nop)},this.isDestroyed=function(){return me.isDestroyed},this.isReady=function(){return me.ready}},EffectNode=function(hook,options){var name,input,defaultValue,defaults,defaultSources={};Node.call(this,options),this.gl=gl,this.effectRef=seriousEffects[hook],this.sources={},this.targets=[],this.inputElements={},this.dirty=!0,this.shaderDirty=!0,this.hook=hook,this.options=options,this.transform=null,this.effect=extend({},this.effectRef),this.effectRef.definition&&extend(this.effect,this.effectRef.definition.call(this,options)),validateInputSpecs(this.effect),this.uniforms.transform=identity,this.inputs={},defaults=defaultInputs[hook];for(name in this.effect.inputs)this.effect.inputs.hasOwnProperty(name)&&(input=this.effect.inputs[name],void 0!==input.defaultValue&&null!==input.defaultValue||("number"===input.type?input.defaultValue=Math.min(Math.max(0,input.min),input.max):"color"===input.type?input.defaultValue=[0,0,0,0]:"boolean"===input.type?input.defaultValue=!1:"string"===input.type?input.defaultValue="":"enum"===input.type&&(input.defaultValue=input.firstValue)),defaultValue=input.validate.call(this,input.defaultValue,input),defaults&&void 0!==defaults[name]&&(defaultValue=input.validate.call(this,defaults[name],input,input.defaultValue,defaultValue),defaults[name]=defaultValue,"image"===input.type&&(defaultSources[name]=defaultValue)),this.inputs[name]=defaultValue,input.uniform&&(this.uniforms[input.uniform]=input.defaultValue));gl&&(this.initialize(),this.effect.commonShader&&this.buildShader()),this.updateReady(),this.inPlace=this.effect.inPlace,this.pub=new Effect(this),nodes.push(this),nodesById[this.id]=this,effects.push(this),allEffectsByHook[hook].push(this);for(name in defaultSources)defaultSources.hasOwnProperty(name)&&this.setInput(name,defaultSources[name])},extend(EffectNode,Node),EffectNode.prototype.initialize=function(){if(!this.initialized){var that=this;this.baseShader=baseShader,this.shape?this.model=makeGlModel(this.shape,this.gl):this.model=rectangleModel,"function"==typeof this.effect.initialize?this.effect.initialize.call(this,function(){that.initFrameBuffer(!0)},gl):this.initFrameBuffer(!0),this.frameBuffer&&(this.texture=this.frameBuffer.texture),this.initialized=!0}},EffectNode.prototype.resize=function(){var i;for(Node.prototype.resize.call(this),this.effect.resize&&this.effect.resize.call(this),i=0;i<this.targets.length;i++)this.targets[i].resize()},EffectNode.prototype.updateReady=function(){var i,input,key,effect,method,ready=!0;effect=this.effect;for(key in effect.inputs)if(effect.inputs.hasOwnProperty(key)&&(input=this.effect.inputs[key],"image"===input.type&&(!this.sources[key]||!this.sources[key].ready)&&(!effect.requires||effect.requires.call(this,key,this.inputs)))){ready=!1;break}if(this.ready!==ready&&(this.ready=ready,this.emit(ready?"ready":"unready"),method=ready?"setReady":"setUnready",this.targets))for(i=0;i<this.targets.length;i++)this.targets[i][method]()},EffectNode.prototype.setReady=EffectNode.prototype.updateReady,EffectNode.prototype.setUnready=EffectNode.prototype.updateReady,EffectNode.prototype.addTarget=function(target){var i;for(i=0;i<this.targets.length;i++)if(this.targets[i]===target)return;this.targets.push(target)},EffectNode.prototype.removeTarget=function(target){var i=this.targets&&this.targets.indexOf(target);i>=0&&this.targets.splice(i,1)},EffectNode.prototype.removeSource=function(source){var i,pub=source&&source.pub;for(i in this.inputs)!this.inputs.hasOwnProperty(i)||this.inputs[i]!==source&&this.inputs[i]!==pub||(this.inputs[i]=null);for(i in this.sources)!this.sources.hasOwnProperty(i)||this.sources[i]!==source&&this.sources[i]!==pub||(this.sources[i]=null)},EffectNode.prototype.buildShader=function(){var shader,effect=this.effect;this.shaderDirty&&(effect.commonShader&&commonShaders[this.hook]?(this.shader||commonShaders[this.hook].count++,this.shader=commonShaders[this.hook].shader):effect.shader?(this.shader&&!effect.commonShader&&this.shader.destroy(),shader=effect.shader.call(this,this.inputs,{vertex:baseVertexShader,fragment:baseFragmentShader},Seriously.util),shader instanceof ShaderProgram?this.shader=shader:shader&&shader.vertex&&shader.fragment?this.shader=new ShaderProgram(gl,shader.vertex,shader.fragment):this.shader=baseShader,effect.commonShader&&(commonShaders[this.hook]={count:1,shader:this.shader})):this.shader=baseShader,this.shaderDirty=!1)},EffectNode.prototype.render=function(){function drawFn(shader,model,uniforms,frameBuffer,node,options){draw(shader,model,uniforms,frameBuffer,node||that,options)}var key,frameBuffer,inPlace,effect=this.effect,that=this;if(gl){if(this.initialized||this.initialize(),this.shaderDirty&&this.buildShader(),this.dirty&&this.ready){for(key in this.sources)!this.sources.hasOwnProperty(key)||effect.requires&&!effect.requires.call(this,key,this.inputs)||(inPlace="function"==typeof this.inPlace?this.inPlace(key):this.inPlace,this.sources[key].render(!inPlace));this.frameBuffer&&(frameBuffer=this.frameBuffer.frameBuffer),"function"==typeof effect.draw?(effect.draw.call(this,this.shader,this.model,this.uniforms,frameBuffer,drawFn),this.emit("render")):frameBuffer&&(draw(this.shader,this.model,this.uniforms,frameBuffer,this),this.emit("render")),this.dirty=!1}return this.texture}},EffectNode.prototype.setInput=function(name,value){function disconnectSource(){var key,previousSource=me.sources[name];if(previousSource){for(key in me.sources)if(key!==name&&me.sources.hasOwnProperty(key)&&me.sources[key]===previousSource)return;previousSource.removeTarget(me)}}var input,uniform,sourceKeys,source,defaultValue,me=this;if(this.effect.inputs.hasOwnProperty(name)){if(input=this.effect.inputs[name],"image"===input.type){if(value){if(value=findInputNode(value),value!==this.sources[name]){if(disconnectSource(),traceSources(value,this))throw new Error("Attempt to make cyclical connection.");this.sources[name]=value,value.addTarget(this)}}else delete this.sources[name],value=!1;uniform=this.sources[name],sourceKeys=Object.keys(this.sources),this.inPlace===!0&&1===sourceKeys.length?(source=this.sources[sourceKeys[0]],this.uniforms.transform=source&&source.cumulativeMatrix||identity):this.uniforms.transform=identity}else defaultValue=defaultInputs[this.hook]&&void 0!==defaultInputs[this.hook][name]?defaultInputs[this.hook][name]:input.defaultValue,value=input.validate.call(this,value,input,defaultValue,this.inputs[name]),uniform=value;return this.inputs[name]===value&&"color"!==input.type&&"vector"!==input.type?value:(this.inputs[name]=value,input.uniform&&(this.uniforms[input.uniform]=uniform),"image"===input.type?(this.resize(),this.updateReady()):input.updateSources&&this.updateReady(),input.shaderDirty&&(this.shaderDirty=!0),this.setDirty(),input.update&&input.update.call(this,value),value)}},EffectNode.prototype.alias=function(inputName,aliasName){var that=this;if(reservedNames.indexOf(aliasName)>=0)throw new Error("'"+aliasName+"' is a reserved name and cannot be used as an alias.");return this.effect.inputs.hasOwnProperty(inputName)&&(aliasName||(aliasName=inputName),seriously.removeAlias(aliasName),aliases[aliasName]={node:this,input:inputName},Object.defineProperty(seriously,aliasName,{configurable:!0,enumerable:!0,get:function(){return that.inputs[inputName]},set:function(value){return that.setInput(inputName,value)}})),this},EffectNode.prototype.matte=function(poly){function makePolygonsArray(poly){return poly&&poly.length&&Array.isArray(poly)?Array.isArray(poly[0])?Array.isArray(poly[0])&&!isNaN(poly[0][0])?[poly]:poly:[poly]:[]}function linesIntersect(a1,a2,b1,b2){var ua_t,ub_t,u_b,ua,ub;return ua_t=(b2.x-b1.x)*(a1.y-b1.y)-(b2.y-b1.y)*(a1.x-b1.x),ub_t=(a2.x-a1.x)*(a1.y-b1.y)-(a2.y-a1.y)*(a1.x-b1.x),u_b=(b2.y-b1.y)*(a2.x-a1.x)-(b2.x-b1.x)*(a2.y-a1.y),u_b&&(ua=ua_t/u_b,ub=ub_t/u_b,ua>0&&1>=ua&&ub>0&&1>=ub)?{x:a1.x+ua*(a2.x-a1.x),y:a1.y+ua*(a2.y-a1.y)}:!1}function makeSimple(poly){var i,j,edge1,edge2,intersect,newPoly,head,point,newPolygons,point1,point2,intersections=[];if(!poly.simple){for(i=0;i<poly.edges.length;i++)for(edge1=poly.edges[i],j=i+1;j<poly.edges.length;j++)edge2=poly.edges[j],intersect=linesIntersect(edge1[0],edge1[1],edge2[0],edge2[1]),intersect&&(intersect.edge1=edge1,intersect.edge2=edge2,intersections.push(intersect));if(intersections.length){for(newPolygons=[],i=0;i<intersections.length;i++)intersect=intersections[i],edge1=intersect.edge1,edge2=intersect.edge2,point1={x:intersect.x,y:intersect.y,prev:edge1[0],next:edge2[1],id:vertices.length},poly.vertices.push(point1),vertices.push(point1),point2={x:intersect.x,y:intersect.y,prev:edge2[0],next:edge1[1],id:vertices.length},poly.vertices.push(point2),vertices.push(point1),point1.prev.next=point1,point1.next.prev=point1,point2.prev.next=point2,point2.next.prev=point2;do{newPoly={edges:[],vertices:[],simple:!0},newPolygons.push(newPoly),point=poly.vertices[0],head=point;do i=poly.vertices.indexOf(point),poly.vertices.splice(i,1),newPoly.edges.push([point,point.next]),newPoly.vertices.push(point),point=point.next;while(point!==head)}while(poly.vertices.length);for(i=polygons.indexOf(poly),polygons.splice(i,1),i=0;i<newPolygons.length;i++)polygons.push(newPolygons[i])}else poly.simple=!0}}function clockWise(poly){var p,q,pv,qv,n=poly.vertices.length,sum=0;for(p=n-1,q=0;n>q;p=q,q++)pv=poly.vertices[p],qv=poly.vertices[q],sum+=pv.x*qv.y-qv.x*pv.y;return sum>0}function triangulate(poly){function pointInTriangle(a,b,c,p){var ax,ay,bx,by,cx,cy,apx,apy,bpx,bpy,cpx,cpy,cXap,bXcp,aXbp;return ax=c.x-b.x,ay=c.y-b.y,bx=a.x-c.x,by=a.y-c.y,cx=b.x-a.x,cy=b.y-a.y,apx=p.x-a.x,apy=p.y-a.y,bpx=p.x-b.x,bpy=p.y-b.y,cpx=p.x-c.x,cpy=p.y-c.y,aXbp=ax*bpy-ay*bpx,cXap=cx*apy-cy*apx,bXcp=bx*cpy-by*cpx,aXbp>=0&&bXcp>=0&&cXap>=0}function snip(u,v,w,n,V){var p,a,b,c,point;if(a=points[V[u]],b=points[V[v]],c=points[V[w]],0>(b.x-a.x)*(c.y-a.y)-(b.y-a.y)*(c.x-a.x))return!1;for(p=0;n>p;p++)if(p!==u&&p!==v&&p!==w&&(point=points[V[p]],pointInTriangle(a,b,c,point)))return!1;return!0}var v,n,nv,count,m,u,w,a,b,c,s,t,points=poly.vertices,V=[],indices=[];if(n=points.length,poly.clockWise)for(v=0;n>v;v++)V[v]=v;else for(v=0;n>v;v++)V[v]=n-1-v;for(nv=n,count=2*nv,m=0,v=nv-1;nv>2;){if(count--<=0)return indices;if(u=v,u>=nv&&(u=0),v=u+1,v>=nv&&(v=0),w=v+1,w>nv&&(w=0),snip(u,v,w,nv,V)){for(a=V[u],b=V[v],c=V[w],poly.clockWise?(indices.push(points[a]),indices.push(points[b]),indices.push(points[c])):(indices.push(points[c]),indices.push(points[b]),indices.push(points[a])),m++,s=v,t=v+1;nv>t;s++,t++)V[s]=V[t];nv--,count=2*nv}}polygon.indices=indices}var polys,polygon,i,j,v,vert,prev,polygons=[],vertices=[],shape={};for(polys=makePolygonsArray(poly),i=0;i<polys.length;i++){for(poly=polys[i],prev=null,polygon={vertices:[],edges:[]},j=0;j<poly.length;j++)v=poly[j],"object"!=typeof v||isNaN(v.x)||isNaN(v.y)?v.length>=2&&!isNaN(v[0])&&!isNaN(v[1])&&(vert={x:v[0],y:v[1],id:vertices.length}):vert={x:v.x,y:v.y,id:vertices.length},vert&&(prev?(prev.next=vert,vert.prev=prev,vert.next=polygon.vertices[0],polygon.vertices[0].prev=vert):(polygon.head=vert,vert.next=vert,vert.prev=vert),vertices.push(vert),polygon.vertices.push(vert),prev=vert);if(polygon.vertices.length>2)for(3===polygon.vertices.length&&(polygon.simple=!0),polygons.push(polygon),j=0;j<polygon.vertices.length;j++)vert=polygon.vertices[j],polygon.edges.push([vert,vert.next])}for(i=polygons.length-1;i>=0;i--)polygon=polygons[i],makeSimple(polygon);for(i=0;i<polygons.length;i++)polygon=polygons[i],polygon.clockWise=clockWise(polygon),triangulate(polygon);for(shape.vertices=[],shape.coords=[],i=0;i<vertices.length;i++)v=vertices[i],shape.vertices.push(2*v.x-1),shape.vertices.push(-2*v.y+1),shape.vertices.push(-1),shape.coords.push(v.x),shape.coords.push(-1*v.y+1);for(shape.vertices=new Float32Array(shape.vertices),shape.coords=new Float32Array(shape.coords),shape.indices=[],i=0;i<polygons.length;i++)for(polygon=polygons[i],j=0;j<polygon.indices.length;j++)v=polygon.indices[j],shape.indices.push(v.id);shape.indices=new Uint16Array(shape.indices),this.shape=shape,this.gl&&makeGlModel(shape,this.gl)},EffectNode.prototype.destroy=function(){var i,key,item,hook=this.hook;this.effect.destroy&&"function"==typeof this.effect.destroy&&this.effect.destroy.call(this),delete this.effect,commonShaders[hook]&&(commonShaders[hook].count--,commonShaders[hook].count||delete commonShaders[hook]),this.shader&&this.shader.destroy&&this.shader!==baseShader&&!commonShaders[hook]&&this.shader.destroy(),delete this.shader;for(key in this.inputElements)this.inputElements.hasOwnProperty(key)&&(item=this.inputElements[key],item.element.removeEventListener("change",item.listener,!0),item.element.removeEventListener("input",item.listener,!0));for(key in this.sources)this.sources.hasOwnProperty(key)&&(item=this.sources[key],item&&item.removeTarget&&item.removeTarget(this),delete this.sources[key]);for(;this.targets.length;)item=this.targets.pop(),item&&item.removeSource&&item.removeSource(this);for(key in this)this.hasOwnProperty(key)&&"id"!==key&&delete this[key];for(key in aliases)aliases.hasOwnProperty(key)&&(item=aliases[key],item.node===this&&seriously.removeAlias(key));i=effects.indexOf(this),i>=0&&effects.splice(i,1),i=allEffectsByHook[hook].indexOf(this),i>=0&&allEffectsByHook[hook].splice(i,1),Node.prototype.destroy.call(this)},Source=function(sourceNode){var me=sourceNode;Object.defineProperties(this,{original:{enumerable:!0,configurable:!0,get:function(){return me.source}},id:{enumerable:!0,configurable:!0,get:function(){return me.id}},width:{enumerable:!0,configurable:!0,get:function(){return me.width}},height:{enumerable:!0,configurable:!0,get:function(){return me.height}}}),this.render=function(){me.render()},this.update=function(){me.setDirty()},this.readPixels=function(x,y,width,height,dest){return me.readPixels(x,y,width,height,dest)},this.on=function(eventName,callback){me.on(eventName,callback)},this.off=function(eventName,callback){me.off(eventName,callback)},this.destroy=function(){var i,descriptor;me.destroy();for(i in this)this.hasOwnProperty(i)&&"isDestroyed"!==i&&"id"!==i&&(descriptor=Object.getOwnPropertyDescriptor(this,i),descriptor.get||descriptor.set||"function"!=typeof this[i]?delete this[i]:this[i]=nop)},this.isDestroyed=function(){return me.isDestroyed},this.isReady=function(){return me.ready}},SourceNode=function(hook,source,options){function sourcePlugin(hook,source,options,force){var p=seriousSources[hook];if(p.definition){if(p=p.definition.call(that,source,options,force),!p)return null;p=extend(extend({},seriousSources[hook]),p)}return p}function compareSource(source){return that.source===source}var key,plugin,opts=options||{},flip=void 0===opts.flip?!0:opts.flip,width=opts.width,height=opts.height,deferTexture=!1,that=this,matchedType=!1;if(Node.call(this),(hook&&"string"!=typeof hook||!source&&0!==source)&&(options&&"object"==typeof options||(options=source),source=hook),"string"==typeof source&&isNaN(source)&&(source=getElement(source,["canvas","img","video"])),"string"==typeof hook&&seriousSources[hook]&&(plugin=sourcePlugin(hook,source,options,!0),plugin&&(this.hook=hook,matchedType=!0,deferTexture=plugin.deferTexture,this.plugin=plugin,this.compare=plugin.compare,this.checkDirty=plugin.checkDirty,plugin.source&&(source=plugin.source))),!plugin&&source instanceof HTMLElement)"CANVAS"===source.tagName?(this.width=source.width,this.height=source.height,this.render=this.renderImageCanvas,matchedType=!0,this.hook="canvas",this.compare=compareSource):"IMG"===source.tagName&&(this.width=source.naturalWidth||1,this.height=source.naturalHeight||1,source.complete&&source.naturalWidth||(deferTexture=!0),source.addEventListener("load",function(){that.isDestroyed||(that.width===source.naturalWidth&&that.height===source.naturalHeight||(that.width=source.naturalWidth,that.height=source.naturalHeight,that.resize()),that.setDirty(),that.setReady())},!0),this.render=this.renderImageCanvas,matchedType=!0,this.hook="image",this.compare=compareSource);else if(!plugin&&source instanceof WebGLTexture){if(gl&&!gl.isTexture(source))throw new Error("Not a valid WebGL texture.");isNaN(width)?isNaN(height)||(width=height):isNaN(height)&&(height=width),this.width=width,this.height=height,void 0===opts.flip&&(flip=!1),matchedType=!0,this.texture=source,this.initialized=!0,this.hook="texture",this.compare=compareSource,this.render=function(){}}if(!matchedType&&!plugin)for(key in seriousSources)if(seriousSources.hasOwnProperty(key)&&seriousSources[key]&&(plugin=sourcePlugin(key,source,options,!1))){this.hook=key,matchedType=!0,deferTexture=plugin.deferTexture,this.plugin=plugin,this.compare=plugin.compare,this.checkDirty=plugin.checkDirty,plugin.source&&(source=plugin.source);break}if(!matchedType)throw new Error("Unknown source type");this.source=source,void 0===this.flip&&(this.flip=flip),this.targets=[],deferTexture||that.setReady(),this.pub=new Source(this),nodes.push(this),nodesById[this.id]=this,sources.push(this),allSourcesByHook[this.hook].push(this),sources.length&&!rafId&&renderDaemon()},extend(SourceNode,Node),SourceNode.prototype.initialize=function(){var texture;gl&&!this.texture&&this.ready&&(texture=gl.createTexture(),gl.bindTexture(gl.TEXTURE_2D,texture),gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),
gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.bindTexture(gl.TEXTURE_2D,null),this.texture=texture,this.initialized=!0,this.allowRefresh=!0,this.setDirty())},SourceNode.prototype.initFrameBuffer=function(useFloat){gl&&(this.frameBuffer=new FrameBuffer(gl,this.width,this.height,{texture:this.texture,useFloat:useFloat}))},SourceNode.prototype.addTarget=function(target){var i;for(i=0;i<this.targets.length;i++)if(this.targets[i]===target)return;this.targets.push(target)},SourceNode.prototype.removeTarget=function(target){var i=this.targets&&this.targets.indexOf(target);i>=0&&this.targets.splice(i,1)},SourceNode.prototype.resize=function(){var i,target;if(this.uniforms.resolution[0]=this.width,this.uniforms.resolution[1]=this.height,this.framebuffer&&this.framebuffer.resize(this.width,this.height),this.emit("resize"),this.setDirty(),this.targets)for(i=0;i<this.targets.length;i++)target=this.targets[i],target.resize(),target.setTransformDirty&&target.setTransformDirty()},SourceNode.prototype.setReady=function(){var i;if(!this.ready&&(this.ready=!0,this.resize(),this.initialize(),this.emit("ready"),this.targets))for(i=0;i<this.targets.length;i++)this.targets[i].setReady()},SourceNode.prototype.render=function(){var media=this.source;gl&&(media||0===media)&&this.ready&&(this.initialized||this.initialize(),this.allowRefresh&&this.plugin&&this.plugin.render&&(this.dirty||this.checkDirty&&this.checkDirty())&&this.plugin.render.call(this,gl,draw,rectangleModel,baseShader)&&(this.dirty=!1,this.emit("render")))},SourceNode.prototype.renderImageCanvas=function(){var media=this.source;if(gl&&media&&this.ready&&(this.initialized||this.initialize(),this.allowRefresh&&this.dirty)){gl.bindTexture(gl.TEXTURE_2D,this.texture),gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,this.flip),gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);try{return gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,media),this.dirty=!1,this.emit("render"),!0}catch(securityError){securityError.code===window.DOMException.SECURITY_ERR&&(this.allowRefresh=!1,Seriously.logger.error("Unable to access cross-domain image"))}return!1}},SourceNode.prototype.destroy=function(){var i,key,item;for(this.plugin&&this.plugin.destroy&&this.plugin.destroy.call(this),gl&&this.texture&&gl.deleteTexture(this.texture);this.targets.length;)item=this.targets.pop(),item&&item.removeSource&&item.removeSource(this);i=sources.indexOf(this),i>=0&&sources.splice(i,1),i=allSourcesByHook[this.hook].indexOf(this),i>=0&&allSourcesByHook[this.hook].splice(i,1);for(key in this)this.hasOwnProperty(key)&&"id"!==key&&delete this[key];Node.prototype.destroy.call(this)},Target=function(targetNode){var me=targetNode;Object.defineProperties(this,{source:{enumerable:!0,configurable:!0,get:function(){return me.source?me.source.pub:void 0},set:function(value){me.setSource(value)}},original:{enumerable:!0,configurable:!0,get:function(){return me.target}},width:{enumerable:!0,configurable:!0,get:function(){return me.width},set:function(value){!isNaN(value)&&value>0&&me.width!==value&&(me.width=value,me.resize(),me.setTransformDirty())}},height:{enumerable:!0,configurable:!0,get:function(){return me.height},set:function(value){!isNaN(value)&&value>0&&me.height!==value&&(me.height=value,me.resize(),me.setTransformDirty())}},id:{enumerable:!0,configurable:!0,get:function(){return me.id}}}),this.render=function(){me.render()},this.readPixels=function(x,y,width,height,dest){return me.readPixels(x,y,width,height,dest)},this.on=function(eventName,callback){me.on(eventName,callback)},this.off=function(eventName,callback){me.off(eventName,callback)},this.go=function(options){me.go(options)},this.stop=function(){me.stop()},this.getTexture=function(){return me.frameBuffer.texture},this.destroy=function(){var i,descriptor;me.destroy();for(i in this)this.hasOwnProperty(i)&&"isDestroyed"!==i&&"id"!==i&&(descriptor=Object.getOwnPropertyDescriptor(this,i),descriptor.get||descriptor.set||"function"!=typeof this[i]?delete this[i]:this[i]=nop)},this.inputs=function(name){return{source:{type:"image"}}},this.isDestroyed=function(){return me.isDestroyed},this.isReady=function(){return me.ready}},TargetNode=function(hook,target,options){function targetPlugin(hook,target,options,force){var plugin=seriousTargets[hook];if(plugin.definition){if(plugin=plugin.definition.call(that,target,options,force),!plugin)return null;plugin=extend(extend({},seriousTargets[hook]),plugin),that.hook=key,matchedType=!0,that.plugin=plugin,that.compare=plugin.compare,plugin.target&&(target=plugin.target),plugin.gl&&!that.gl&&(that.gl=plugin.gl,gl||attachContext(plugin.gl)),that.gl===gl&&(that.model=rectangleModel,that.shader=baseShader)}return plugin}var opts,flip,width,height,context,debugContext,frameBuffer,targetList,key,that=this,matchedType=!1,triedWebGl=!1;if(Node.call(this),(hook&&"string"!=typeof hook||!target&&0!==target)&&(options&&"object"==typeof options||(options=target),target=hook),opts=options||{},flip=void 0===opts.flip?!0:opts.flip,width=parseInt(opts.width,10),height=parseInt(opts.height,10),debugContext=opts.debugContext,"string"==typeof hook&&seriousTargets[hook]&&targetPlugin(hook,target,opts,!0),this.renderToTexture=opts.renderToTexture,target instanceof WebGLFramebuffer)if(frameBuffer=target,opts instanceof HTMLCanvasElement)target=opts;else if(opts instanceof WebGLRenderingContext)target=opts.canvas;else if(opts.canvas instanceof HTMLCanvasElement)target=opts.canvas;else{if(!(opts.context instanceof WebGLRenderingContext))throw new Error("Must provide a canvas with WebGLFramebuffer target");target=opts.context.canvas}if(target instanceof HTMLElement&&"CANVAS"===target.tagName){if(width=target.width,height=target.height,(!gl||gl.canvas!==target&&opts.allowSecondaryWebGL)&&(triedWebGl=!0,context=getWebGlContext(target,{alpha:!0,premultipliedAlpha:!1,preserveDrawingBuffer:!0,stencil:!0,debugContext:debugContext})),context)gl&&gl!==context?(this.gl=context,this.frameBuffer={frameBuffer:frameBuffer||null},this.shader=new ShaderProgram(this.gl,baseVertexShader,baseFragmentShader),this.model=buildRectangleModel.call(this,this.gl),this.pixels=null,this.texture=this.gl.createTexture(),this.gl.bindTexture(gl.TEXTURE_2D,this.texture),this.gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),this.gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),this.gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),this.gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),this.render=this.renderSecondaryWebGL):(primaryTarget||(primaryTarget=this),gl||attachContext(context),this.render=this.renderWebGL,opts.renderToTexture?gl&&(this.frameBuffer=new FrameBuffer(gl,width,height,!1)):this.frameBuffer={frameBuffer:frameBuffer||null});else{if(!opts.allowSecondaryWebGL&&gl&&gl.canvas!==target)throw new Error("Only one WebGL target canvas allowed. Set allowSecondaryWebGL option to create secondary context.");this.render=nop,Seriously.logger.log("Unable to create WebGL context.")}matchedType=!0}if(!matchedType)for(key in seriousTargets)if(seriousTargets.hasOwnProperty(key)&&seriousTargets[key]&&targetPlugin(key,target,opts,!1))break;if(!matchedType)throw new Error("Unknown target type");allTargets&&(targetList=allTargets.get(target),targetList?Seriously.logger.warn("Target already in use by another instance",target,Object.keys(targetList).map(function(key){return targetList[key]})):(targetList={},allTargets.set(target,targetList)),targetList[seriously.id]=seriously),this.target=target,this.transform=null,this.transformDirty=!0,this.flip=flip,width&&(this.width=width),height&&(this.height=height),this.uniforms.resolution[0]=this.width,this.uniforms.resolution[1]=this.height,void 0!==opts.auto?this.auto=opts.auto:this.auto=auto,this.frames=0,this.pub=new Target(this),nodes.push(this),nodesById[this.id]=this,targets.push(this)},extend(TargetNode,Node),TargetNode.prototype.setSource=function(source){var newSource;newSource=findInputNode(source),newSource!==this.source&&(this.source&&this.source.removeTarget(this),this.source=newSource,newSource.addTarget(this),newSource&&(this.resize(),newSource.ready?this.setReady():this.setUnready()),this.setDirty())},TargetNode.prototype.setDirty=function(){this.dirty=!0,this.auto&&!rafId&&(rafId=requestAnimationFrame(renderDaemon))},TargetNode.prototype.resize=function(){this.target instanceof HTMLCanvasElement?this.width===this.target.width&&this.height===this.target.height||(this.target.width=this.width,this.target.height=this.height,this.uniforms.resolution[0]=this.width,this.uniforms.resolution[1]=this.height,this.emit("resize"),this.setTransformDirty()):this.plugin&&this.plugin.resize&&this.plugin.resize.call(this),!this.source||this.source.width===this.width&&this.source.height===this.height||this.transform||(this.transform=new Float32Array(16))},TargetNode.prototype.setTransformDirty=function(){this.transformDirty=!0,this.setDirty()},TargetNode.prototype.go=function(){this.auto=!0,this.setDirty()},TargetNode.prototype.stop=function(){this.auto=!1},TargetNode.prototype.render=function(){gl&&this.plugin&&this.plugin.render&&this.plugin.render.call(this,draw,baseShader,rectangleModel)},TargetNode.prototype.renderWebGL=function(){var matrix,x,y;if(this.resize(),gl&&this.dirty&&this.ready){if(!this.source)return;this.source.render(),this.uniforms.source=this.source.texture,this.source.width===this.width&&this.source.height===this.height?this.uniforms.transform=this.source.cumulativeMatrix||identity:this.transformDirty&&(matrix=this.transform,mat4.copy(matrix,this.source.cumulativeMatrix||identity),x=this.source.width/this.width,y=this.source.height/this.height,matrix[0]*=x,matrix[1]*=x,matrix[2]*=x,matrix[3]*=x,matrix[4]*=y,matrix[5]*=y,matrix[6]*=y,matrix[7]*=y,this.uniforms.transform=matrix,this.transformDirty=!1),draw(baseShader,rectangleModel,this.uniforms,this.frameBuffer.frameBuffer,this),this.emit("render"),this.dirty=!1}},TargetNode.prototype.renderSecondaryWebGL=function(){var sourceWidth,sourceHeight,matrix,x,y;this.dirty&&this.ready&&this.source&&(this.emit("render"),this.source.render(!0),sourceWidth=this.source.width,sourceHeight=this.source.height,this.pixels&&this.pixels.length===sourceWidth*sourceHeight*4||(this.pixels=new Uint8Array(sourceWidth*sourceHeight*4)),this.source.readPixels(0,0,sourceWidth,sourceHeight,this.pixels),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,sourceWidth,sourceHeight,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.pixels),sourceWidth===this.width&&sourceHeight===this.height?this.uniforms.transform=identity:this.transformDirty&&(matrix=this.transform,mat4.copy(matrix,identity),x=this.source.width/this.width,y=this.source.height/this.height,matrix[0]*=x,matrix[1]*=x,matrix[2]*=x,matrix[3]*=x,matrix[4]*=y,matrix[5]*=y,matrix[6]*=y,matrix[7]*=y,this.uniforms.transform=matrix,this.transformDirty=!1),this.uniforms.source=this.texture,draw(this.shader,this.model,this.uniforms,null,this),this.dirty=!1)},TargetNode.prototype.removeSource=function(source){this.source!==source&&this.source!==source.pub||(this.source=null)},TargetNode.prototype.destroy=function(){var i,targetList;this.source&&this.source.removeTarget&&this.source.removeTarget(this),allTargets&&(targetList=allTargets.get(this.target),delete targetList[seriously.id],Object.keys(targetList).length||allTargets["delete"](this.target)),this.plugin&&this.plugin.destroy&&this.plugin.destroy.call(this),delete this.source,delete this.target,delete this.pub,delete this.uniforms,delete this.pixels,delete this.auto,i=targets.indexOf(this),i>=0&&targets.splice(i,1),Node.prototype.destroy.call(this),this===primaryTarget&&(glCanvas.removeEventListener("webglcontextrestored",restoreContext,!1),destroyContext(),primaryTarget=null)},Transform=function(transformNode){function setInput(inputName,def,input){var lookup,value;lookup=me.inputElements[inputName],"string"==typeof input&&isNaN(input)&&("enum"===def.type?def.options.hasOwnProperty(input)||(input=getElement(input,["select"])):"number"===def.type||"boolean"===def.type?input=getElement(input,["input","select"]):"image"===def.type&&(input=getElement(input,["canvas","img","video"]))),input instanceof HTMLInputElement||input instanceof HTMLSelectElement?(value=input.value,lookup&&lookup.element!==input&&(lookup.element.removeEventListener("change",lookup.listener,!0),lookup.element.removeEventListener("input",lookup.listener,!0),delete me.inputElements[inputName],lookup=null),lookup||(lookup={element:input,listener:function(element){return function(){var oldValue,newValue;oldValue="checkbox"===input.type?input.checked:element.value,newValue=me.setInput(inputName,oldValue),"color"===input.type&&(newValue=colorArrayToHex(newValue)),newValue!==oldValue&&(element.value=newValue)}}(input)},me.inputElements[inputName]=lookup,"range"===input.type?(input.addEventListener("input",lookup.listener,!0),input.addEventListener("change",lookup.listener,!0)):input.addEventListener("change",lookup.listener,!0)),lookup&&"checkbox"===input.type&&(value=input.checked)):(lookup&&(lookup.element.removeEventListener("change",lookup.listener,!0),lookup.element.removeEventListener("input",lookup.listener,!0),delete me.inputElements[inputName]),value=input),me.setInput(inputName,value)}function setProperty(name,def){Object.defineProperty(self,name,{configurable:!0,enumerable:!0,get:function(){return def.get.call(me)},set:function(val){setInput(name,def,val)}})}function makeMethod(method){return function(){method.apply(me,arguments)&&me.setTransformDirty()}}var key,me=transformNode,self=this;Object.defineProperties(this,{transform:{enumerable:!0,configurable:!0,get:function(){return me.hook}},title:{enumerable:!0,configurable:!0,get:function(){return me.plugin.title||me.hook}},width:{enumerable:!0,configurable:!0,get:function(){return me.width}},height:{enumerable:!0,configurable:!0,get:function(){return me.height}},id:{enumerable:!0,configurable:!0,get:function(){return me.id}},source:{enumerable:!0,configurable:!0,get:function(){return me.source&&me.source.pub},set:function(source){me.setSource(source)}}});for(key in me.methods)me.methods.hasOwnProperty(key)&&(this[key]=makeMethod(me.methods[key].bind(me)));for(key in me.inputs)me.inputs.hasOwnProperty(key)&&setProperty(key,me.inputs[key]);this.update=function(){me.setDirty()},this.inputs=function(name){var result,input,inputs,key;if(inputs=me.plugin.inputs,name)return input=inputs[name],!input||input.method?null:(result={type:input.type,defaultValue:input.defaultValue,title:input.title||name},"number"===input.type?(result.min=input.min,result.max=input.max,result.step=input.step):"enum"===input.type?result.options=extend({},input.options):"vector"===input.type&&(result.dimensions=input.dimensions),input.description&&(result.description=input.description),result);result={};for(key in inputs)inputs.hasOwnProperty(key)&&!inputs[key].method&&(result[key]=this.inputs(key));return result},this.alias=function(inputName,aliasName){return me.alias(inputName,aliasName),this},this.on=function(eventName,callback){me.on(eventName,callback)},this.off=function(eventName,callback){me.off(eventName,callback)},this.destroy=function(){var i,descriptor;me.destroy();for(i in this)this.hasOwnProperty(i)&&"isDestroyed"!==i&&"id"!==i&&(descriptor=Object.getOwnPropertyDescriptor(this,i),descriptor.get||descriptor.set||"function"!=typeof this[i]?delete this[i]:this[i]=nop)},this.isDestroyed=function(){return me.isDestroyed},this.isReady=function(){return me.ready}},TransformNode=function(hook,options){var key,input,initialValue,defaultValue,defaults;this.matrix=new Float32Array(16),this.cumulativeMatrix=new Float32Array(16),this.ready=!1,this.width=1,this.height=1,this.seriously=seriously,this.transformRef=seriousTransforms[hook],this.hook=hook,this.id=nodeId,nodeId++,this.options=options,this.sources=null,this.targets=[],this.inputElements={},this.inputs={},this.methods={},this.listeners={},this.texture=null,this.frameBuffer=null,this.uniforms=null,this.dirty=!0,this.transformDirty=!0,this.renderDirty=!1,this.isDestroyed=!1,this.transformed=!1,this.plugin=extend({},this.transformRef),this.transformRef.definition&&extend(this.plugin,this.transformRef.definition.call(this,options));for(key in this.plugin.inputs)this.plugin.inputs.hasOwnProperty(key)&&(input=this.plugin.inputs[key],input.method&&"function"==typeof input.method?this.methods[key]=input.method:"function"==typeof input.set&&"function"==typeof input.get&&(this.inputs[key]=input));validateInputSpecs(this.plugin),defaults=defaultInputs[hook];for(key in this.plugin.inputs)this.plugin.inputs.hasOwnProperty(key)&&(input=this.plugin.inputs[key],"function"==typeof input.set&&"function"==typeof input.get&&"function"!=typeof input.method&&(initialValue=input.get.call(this),defaultValue=void 0===input.defaultValue?initialValue:input.defaultValue,defaultValue=input.validate.call(this,defaultValue,input,initialValue),defaults&&void 0!==defaults[key]&&(defaultValue=input.validate.call(this,defaults[key],input,input.defaultValue,defaultValue),defaults[key]=defaultValue),defaultValue!==initialValue&&input.set.call(this,defaultValue)));nodes.push(this),nodesById[this.id]=this,this.pub=new Transform(this),transforms.push(this),allTransformsByHook[hook].push(this)},TransformNode.prototype.setDirty=function(){this.renderDirty=!0,Node.prototype.setDirty.call(this)},TransformNode.prototype.setTransformDirty=function(){var i,target;for(this.transformDirty=!0,this.dirty=!0,this.renderDirty=!0,i=0;i<this.targets.length;i++)target=this.targets[i],target.setTransformDirty?target.setTransformDirty():target.setDirty()},TransformNode.prototype.resize=function(){var i;for(Node.prototype.resize.call(this),this.plugin.resize&&this.plugin.resize.call(this),i=0;i<this.targets.length;i++)this.targets[i].resize();this.setTransformDirty()},TransformNode.prototype.setSource=function(source){var newSource;if(newSource=findInputNode(source),newSource!==this.source){if(traceSources(newSource,this))throw new Error("Attempt to make cyclical connection.");this.source&&this.source.removeTarget(this),this.source=newSource,newSource.addTarget(this),newSource&&newSource.ready?this.setReady():this.setUnready(),this.resize()}},TransformNode.prototype.addTarget=function(target){var i;for(i=0;i<this.targets.length;i++)if(this.targets[i]===target)return;this.targets.push(target)},TransformNode.prototype.removeTarget=function(target){var i=this.targets&&this.targets.indexOf(target);i>=0&&this.targets.splice(i,1),this.targets&&this.targets.length&&this.resize()},TransformNode.prototype.setInput=function(name,value){var input,defaultValue,previous;return this.plugin.inputs.hasOwnProperty(name)?(input=this.plugin.inputs[name],defaultValue=defaultInputs[this.hook]&&void 0!==defaultInputs[this.hook][name]?defaultInputs[this.hook][name]:input.defaultValue,previous=input.get.call(this),void 0===defaultValue&&(defaultValue=previous),value=input.validate.call(this,value,input,defaultValue,previous),input.set.call(this,value)&&this.setTransformDirty(),input.get.call(this)):void 0},TransformNode.prototype.alias=function(inputName,aliasName){var input,def,me=this;if(reservedNames.indexOf(aliasName)>=0)throw new Error("'"+aliasName+"' is a reserved name and cannot be used as an alias.");return this.plugin.inputs.hasOwnProperty(inputName)&&(aliasName||(aliasName=inputName),seriously.removeAlias(aliasName),input=this.inputs[inputName],input?(def=me.inputs[inputName],Object.defineProperty(seriously,aliasName,{configurable:!0,enumerable:!0,get:function(){return def.get.call(me)},set:function(val){def.set.call(me,val)&&me.setTransformDirty()}})):(input=this.methods[inputName],input&&(def=input,seriously[aliasName]=function(){def.apply(me,arguments)&&me.setTransformDirty()})),input&&(aliases[aliasName]={node:this,input:inputName})),this},TransformNode.prototype.render=function(renderTransform){return this.source?(this.source.render(),this.transformDirty&&(this.transformed?this.source.cumulativeMatrix?mat4.multiply(this.cumulativeMatrix,this.matrix,this.source.cumulativeMatrix):mat4.copy(this.cumulativeMatrix,this.matrix):mat4.copy(this.cumulativeMatrix,this.source.cumulativeMatrix||identity),this.transformDirty=!1),renderTransform&&gl?(this.renderDirty&&(this.frameBuffer||(this.uniforms={resolution:[this.width,this.height]},this.frameBuffer=new FrameBuffer(gl,this.width,this.height)),this.uniforms.source=this.source.texture,this.uniforms.transform=this.cumulativeMatrix||identity,draw(baseShader,rectangleModel,this.uniforms,this.frameBuffer.frameBuffer,this),this.renderDirty=!1),this.texture=this.frameBuffer.texture):this.source?this.texture=this.source.texture:this.texture=null,this.dirty=!1,this.texture):(this.transformDirty&&(mat4.copy(this.cumulativeMatrix,this.matrix),this.transformDirty=!1),this.texture=null,void(this.dirty=!1))},TransformNode.prototype.readPixels=function(x,y,width,height,dest){var nodeGl=this.gl||gl;if(!gl)throw new Error("Cannot read pixels until a canvas is connected");if(this.render(!0),void 0===dest)dest=new Uint8Array(width*height*4);else if(!dest instanceof Uint8Array)throw new Error("Incompatible array type");return nodeGl.bindFramebuffer(gl.FRAMEBUFFER,this.frameBuffer.frameBuffer),nodeGl.readPixels(x,y,width,height,gl.RGBA,gl.UNSIGNED_BYTE,dest),dest},TransformNode.prototype.destroy=function(){var i,key,item,hook=this.hook;this.plugin.destroy&&"function"==typeof this.plugin.destroy&&this.plugin.destroy.call(this),delete this.effect,this.frameBuffer&&(this.frameBuffer.destroy(),delete this.frameBuffer,delete this.texture);for(i in this.inputElements)this.inputElements.hasOwnProperty(i)&&(item=this.inputElements[i],item.element.removeEventListener("change",item.listener,!0),item.element.removeEventListener("input",item.listener,!0));for(this.source&&this.source.removeTarget(this);this.targets.length;)item=this.targets.pop(),item&&item.removeSource&&item.removeSource(this);for(key in this)this.hasOwnProperty(key)&&"id"!==key&&delete this[key];for(key in aliases)aliases.hasOwnProperty(key)&&(item=aliases[key],item.node===this&&seriously.removeAlias(key));i=transforms.indexOf(this),i>=0&&transforms.splice(i,1),i=allTransformsByHook[hook].indexOf(this),i>=0&&allTransformsByHook[hook].splice(i,1),Node.prototype.destroy.call(this)},TransformNode.prototype.setReady=Node.prototype.setReady,TransformNode.prototype.setUnready=Node.prototype.setUnready,TransformNode.prototype.on=Node.prototype.on,TransformNode.prototype.off=Node.prototype.off,TransformNode.prototype.emit=Node.prototype.emit,options=options instanceof HTMLCanvasElement?{canvas:options}:options||{},options.canvas,this.effect=function(hook,options){if(!seriousEffects[hook])throw new Error("Unknown effect: "+hook);var effectNode=new EffectNode(hook,options);return effectNode.pub},this.source=function(hook,source,options){var sourceNode=findInputNode(hook,source,options);return sourceNode.pub},this.transform=function(hook,opts){var transformNode;if("string"!=typeof hook&&(opts=hook,hook=!1),hook){if(!seriousTransforms[hook])throw new Error("Unknown transform: "+hook)}else if(hook=options&&options.defaultTransform||"2d",!seriousTransforms[hook])throw new Error("No transform specified");return transformNode=new TransformNode(hook,opts),transformNode.pub},this.target=function(hook,target,options){var targetNode,element,hook,i;for(hook&&"string"==typeof hook&&!seriousTargets[hook]&&(element=document.querySelector(hook)),("string"!=typeof hook||!target&&0!==target||element)&&(options&&"object"==typeof options||(options=target),target=element||hook,hook=null),"string"==typeof target&&isNaN(target)&&(target=document.querySelector(target)),i=0;i<targets.length;i++)if(targetNode=targets[i],(!hook||hook===targetNode.hook)&&(targetNode.target===target||targetNode.compare&&targetNode.compare(target,options)))return targetNode.pub;return targetNode=new TargetNode(hook,target,options),targetNode.pub},this.aliases=function(){return Object.keys(aliases)},this.removeAlias=function(name){aliases[name]&&(delete this[name],delete aliases[name])},this.defaults=function(hook,options){var key;if(hook)if("object"!=typeof hook)null===options?delete defaultInputs[hook]:"object"==typeof options&&(defaultInputs[hook]=extend({},options));else for(key in hook)hook.hasOwnProperty(key)&&this.defaults(key,hook[key]);else if(null===hook)for(key in defaultInputs)defaultInputs.hasOwnProperty(key)&&delete defaultInputs[key]},this.go=function(pre,post){var i;for("function"==typeof pre&&preCallbacks.indexOf(pre)<0&&preCallbacks.push(pre),"function"==typeof post&&postCallbacks.indexOf(post)<0&&postCallbacks.push(post),auto=!0,i=0;i<targets.length;i++)targets[i].go();rafId||!preCallbacks.length&&!postCallbacks.length||renderDaemon()},this.stop=function(){preCallbacks.length=0,postCallbacks.length=0,cancelAnimFrame(rafId),rafId=0},this.render=function(){var i;for(i=0;i<targets.length;i++)targets[i].render(options)},this.destroy=function(){for(var i,node,descriptor;nodes.length;)node=nodes.shift(),node.destroy();for(i in this)this.hasOwnProperty(i)&&"isDestroyed"!==i&&"id"!==i&&(descriptor=Object.getOwnPropertyDescriptor(this,i),descriptor.get||descriptor.set||"function"!=typeof this[i]?delete this[i]:this[i]=nop);baseFragmentShader=null,baseVertexShader=null,seriously=null,sources=[],targets=[],effects=[],nodes=[],preCallbacks.length=0,postCallbacks.length=0,cancelAnimFrame(rafId),rafId=0,isDestroyed=!0},this.isDestroyed=function(){return isDestroyed},this.incompatible=function(hook){var key,plugin,failure=!1;if(failure=Seriously.incompatible(hook))return failure;if(!hook){for(key in allEffectsByHook)if(allEffectsByHook.hasOwnProperty(key)&&allEffectsByHook[key].length&&(plugin=seriousEffects[key],plugin&&"function"==typeof plugin.compatible&&!plugin.compatible.call(this)))return"plugin-"+key;for(key in allSourcesByHook)if(allSourcesByHook.hasOwnProperty(key)&&allSourcesByHook[key].length&&(plugin=seriousSources[key],plugin&&"function"==typeof plugin.compatible&&!plugin.compatible.call(this)))return"source-"+key}return!1},this.isNode=function(candidate){var node;return!(!candidate||(node=nodesById[candidate.id],!node||node.isDestroyed))},this.isSource=function(candidate){return this.isNode(candidate)&&candidate instanceof Source},this.isEffect=function(candidate){return this.isNode(candidate)&&candidate instanceof Effect},this.isTransform=function(candidate){return this.isNode(candidate)&&candidate instanceof Transform},this.isTarget=function(candidate){return this.isNode(candidate)&&candidate instanceof Target},Object.defineProperties(this,{id:{enumerable:!0,configurable:!0,get:function(){return id}}}),baseVertexShader=["precision mediump float;","attribute vec4 position;","attribute vec2 texCoord;","uniform vec2 resolution;","uniform mat4 transform;","varying vec2 vTexCoord;","void main(void) {","	vec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);","	screenPosition = transform * screenPosition;","	gl_Position.xy = screenPosition.xy * 2.0 / resolution;","	gl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);","	gl_Position.w = screenPosition.w;","	vTexCoord = texCoord;","}\n"].join("\n"),baseFragmentShader=["precision mediump float;","varying vec2 vTexCoord;","uniform sampler2D source;","void main(void) {","		gl_FragColor = texture2D(source, vTexCoord);","}"].join("\n"),this.defaults(options.defaults)}var testContext,colorElement,incompatibility,identity,noVideoTextureSupport,document=window.document,console=window.console,seriousEffects={},seriousTransforms={},seriousSources={},seriousTargets={},timeouts=[],allEffectsByHook={},allTransformsByHook={},allSourcesByHook={canvas:[],image:[],video:[]},allTargetsByHook={},allTargets=window.WeakMap&&new WeakMap,maxSeriouslyId=0,nop=function(){},colorNames={transparent:[0,0,0,0],black:[0,0,0,1],red:[1,0,0,1],green:[0,128/255,0,1],blue:[0,0,1,1],white:[1,1,1,1],silver:[192/255,192/255,192/255,1],gray:[128/255,128/255,128/255,1],maroon:[128/255,0,0,1],purple:[128/255,0,128/255,1],fuchsia:[1,0,1,1],lime:[0,1,0,1],olive:[128/255,128/255,0,1],yellow:[1,1,0,1],navy:[0,0,128/255,1],teal:[0,128/255,128/255,1],aqua:[0,1,1,1],orange:[1,165/255,0,1]},vectorFields=["x","y","z","w"],colorFields=["r","g","b","a"],mat4={frustum:function(left,right,bottom,top,near,far,dest){dest||(dest=mat4.create());var rl=right-left,tb=top-bottom,fn=far-near;return dest[0]=2*near/rl,dest[1]=0,dest[2]=0,dest[3]=0,dest[4]=0,dest[5]=2*near/tb,dest[6]=0,dest[7]=0,dest[8]=(right+left)/rl,dest[9]=(top+bottom)/tb,dest[10]=-(far+near)/fn,dest[11]=-1,dest[12]=0,dest[13]=0,dest[14]=-(far*near*2)/fn,dest[15]=0,dest},perspective:function(fovy,aspect,near,far,dest){var top=near*Math.tan(fovy*Math.PI/360),right=top*aspect;return mat4.frustum(-right,right,-top,top,near,far,dest)},multiply:function(dest,mat,mat2){var a00=mat[0],a01=mat[1],a02=mat[2],a03=mat[3],a10=mat[4],a11=mat[5],a12=mat[6],a13=mat[7],a20=mat[8],a21=mat[9],a22=mat[10],a23=mat[11],a30=mat[12],a31=mat[13],a32=mat[14],a33=mat[15],b0=mat2[0],b1=mat2[1],b2=mat2[2],b3=mat2[3];return dest[0]=b0*a00+b1*a10+b2*a20+b3*a30,dest[1]=b0*a01+b1*a11+b2*a21+b3*a31,dest[2]=b0*a02+b1*a12+b2*a22+b3*a32,dest[3]=b0*a03+b1*a13+b2*a23+b3*a33,b0=mat2[4],b1=mat2[5],b2=mat2[6],b3=mat2[7],dest[4]=b0*a00+b1*a10+b2*a20+b3*a30,dest[5]=b0*a01+b1*a11+b2*a21+b3*a31,dest[6]=b0*a02+b1*a12+b2*a22+b3*a32,dest[7]=b0*a03+b1*a13+b2*a23+b3*a33,b0=mat2[8],b1=mat2[9],b2=mat2[10],b3=mat2[11],dest[8]=b0*a00+b1*a10+b2*a20+b3*a30,dest[9]=b0*a01+b1*a11+b2*a21+b3*a31,dest[10]=b0*a02+b1*a12+b2*a22+b3*a32,dest[11]=b0*a03+b1*a13+b2*a23+b3*a33,b0=mat2[12],b1=mat2[13],b2=mat2[14],b3=mat2[15],dest[12]=b0*a00+b1*a10+b2*a20+b3*a30,dest[13]=b0*a01+b1*a11+b2*a21+b3*a31,dest[14]=b0*a02+b1*a12+b2*a22+b3*a32,dest[15]=b0*a03+b1*a13+b2*a23+b3*a33,dest},identity:function(dest){return dest[0]=1,dest[1]=0,dest[2]=0,dest[3]=0,dest[4]=0,dest[5]=1,dest[6]=0,dest[7]=0,dest[8]=0,dest[9]=0,dest[10]=1,dest[11]=0,dest[12]=0,dest[13]=0,dest[14]=0,dest[15]=1,dest},copy:function(out,a){return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[8]=a[8],out[9]=a[9],out[10]=a[10],out[11]=a[11],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15],out}},requestAnimationFrame=function(){var lastTime=0;return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){function timeoutCallback(){callback(currTime+timeToCall)}var currTime,timeToCall,id;return currTime=(new Date).getTime(),timeToCall=Math.max(0,16-(currTime-lastTime)),id=window.setTimeout(timeoutCallback,timeToCall),lastTime=currTime+timeToCall,id}}(),cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(id){window.cancelTimeout(id)}}(),reservedEffectProperties=["alias","destroy","effect","id","initialize","inputs","isDestroyed","isReady","matte","off","on","readPixels","render","title","update"],reservedTransformProperties=["alias","destroy","id","inputs","isDestroyed","isReady","off","on","source","title","update"],reservedNames=["aliases","defaults","destroy","effect","go","id","incompatible","isDestroyed","isEffect",,"isNode","isSource","isTarget","isTransform","removeAlias","render","source","stop","target","transform"];return window.addEventListener("message",function(event){if(event.source===window&&"seriously-timeout-message"===event.data&&(event.stopPropagation(),timeouts.length>0)){var fn=timeouts.shift();fn()}},!0),FrameBuffer.prototype.resize=function(width,height){var gl=this.gl;this.width===width&&this.height===height||(this.width=width,this.height=height,gl&&(gl.bindTexture(gl.TEXTURE_2D,this.texture),gl.bindFramebuffer(gl.FRAMEBUFFER,this.frameBuffer),
gl.bindRenderbuffer(gl.RENDERBUFFER,this.renderBuffer),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,width,height,0,gl.RGBA,gl.UNSIGNED_BYTE,null),gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_COMPONENT16,width,height),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,this.texture,0),gl.bindTexture(gl.TEXTURE_2D,null),gl.bindRenderbuffer(gl.RENDERBUFFER,null),gl.bindFramebuffer(gl.FRAMEBUFFER,null)))},FrameBuffer.prototype.destroy=function(){var gl=this.gl;gl&&(gl.deleteFramebuffer(this.frameBuffer),gl.deleteRenderbuffer(this.renderBuffer),this.ownTexture&&gl.deleteTexture(this.texture)),delete this.frameBuffer,delete this.renderBuffer,delete this.texture,delete this.gl},ShaderProgram.prototype.use=function(){this.gl.useProgram(this.program)},Seriously.incompatible=function(hook){var canvas,gl,plugin;if(void 0===incompatibility&&(canvas=document.createElement("canvas"),canvas&&canvas.getContext?window.WebGLRenderingContext?(gl=getTestContext(),gl||(incompatibility="context")):incompatibility="webgl":incompatibility="canvas"),incompatibility)return incompatibility;if(hook){if(plugin=seriousEffects[hook],plugin&&"function"==typeof plugin.compatible&&!plugin.compatible(gl))return"plugin-"+hook;if(plugin=seriousSources[hook],plugin&&"function"==typeof plugin.compatible&&!plugin.compatible(gl))return"source-"+hook}return!1},Seriously.plugin=function(hook,definition,meta){var effect;return seriousEffects[hook]?void Seriously.logger.warn("Effect ["+hook+"] already loaded"):(void 0===meta&&"object"==typeof definition&&(meta=definition),meta?(effect=extend({},meta),"function"==typeof definition&&(effect.definition=definition),effect.reserved=reservedEffectProperties,effect.inputs&&validateInputSpecs(effect),effect.title||(effect.title=hook),seriousEffects[hook]=effect,allEffectsByHook[hook]=[],effect):void 0)},Seriously.removePlugin=function(hook){var all,effect,plugin;if(!hook)return this;if(plugin=seriousEffects[hook],!plugin)return this;if(all=allEffectsByHook[hook]){for(;all.length;)effect=all.shift(),effect.destroy();delete allEffectsByHook[hook]}return delete seriousEffects[hook],this},Seriously.source=function(hook,definition,meta){var source;return seriousSources[hook]?void Seriously.logger.warn("Source ["+hook+"] already loaded"):(void 0===meta&&"object"==typeof definition&&(meta=definition),meta||definition?(source=extend({},meta),"function"==typeof definition&&(source.definition=definition),source.title||(source.title=hook),seriousSources[hook]=source,allSourcesByHook[hook]=[],source):void 0)},Seriously.removeSource=function(hook){var all,source,plugin;if(!hook)return this;if(plugin=seriousSources[hook],!plugin)return this;if(all=allSourcesByHook[hook]){for(;all.length;)source=all.shift(),source.destroy();delete allSourcesByHook[hook]}return delete seriousSources[hook],this},Seriously.transform=function(hook,definition,meta){var transform;return seriousTransforms[hook]?void Seriously.logger.warn("Transform ["+hook+"] already loaded"):(void 0===meta&&"object"==typeof definition&&(meta=definition),meta||definition?(transform=extend({},meta),"function"==typeof definition&&(transform.definition=definition),transform.reserved=reservedTransformProperties,transform.inputs&&validateInputSpecs(transform),transform.title||(transform.title=hook),seriousTransforms[hook]=transform,allTransformsByHook[hook]=[],transform):void 0)},Seriously.removeTransform=function(hook){var all,transform,plugin;if(!hook)return this;if(plugin=seriousTransforms[hook],!plugin)return this;if(all=allTransformsByHook[hook]){for(;all.length;)transform=all.shift(),transform.destroy();delete allTransformsByHook[hook]}return delete seriousTransforms[hook],this},Seriously.target=function(hook,definition,meta){var target;return seriousTargets[hook]?void Seriously.logger.warn("Target ["+hook+"] already loaded"):(void 0===meta&&"object"==typeof definition&&(meta=definition),meta||definition?(target=extend({},meta),"function"==typeof definition&&(target.definition=definition),target.title||(target.title=hook),seriousTargets[hook]=target,allTargetsByHook[hook]=[],target):void 0)},Seriously.removeTarget=function(hook){var all,target,plugin;if(!hook)return this;if(plugin=seriousTargets[hook],!plugin)return this;if(all=allTargetsByHook[hook]){for(;all.length;)target=all.shift(),target.destroy();delete allTargetsByHook[hook]}return delete seriousTargets[hook],this},Seriously.inputValidators={color:function(value,input,defaultValue,oldValue){var s,a,i,computed,bg;if(a=oldValue||[],"string"==typeof value){if(s=/^(rgb|hsl)a?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*(\d+(\.\d*)?)\s*)?\)/i.exec(value),s&&s.length){if(s.length<3)return a[0]=a[1]=a[2]=a[3]=0,a;for(a[3]=1,i=0;3>i;i++)a[i]=parseFloat(s[i+2])/255;return isNaN(s[6])||(a[3]=parseFloat(s[6])),"hsl"===s[1].toLowerCase()?hslToRgb(a[0],a[1],a[2],a[3],a):a}if(s=/^#(([0-9a-fA-F]{3,8}))/.exec(value),s&&s.length)return s=s[1],3===s.length?(a[0]=parseInt(s[0],16)/15,a[1]=parseInt(s[1],16)/15,a[2]=parseInt(s[2],16)/15,a[3]=1):4===s.length?(a[0]=parseInt(s[0],16)/15,a[1]=parseInt(s[1],16)/15,a[2]=parseInt(s[2],16)/15,a[3]=parseInt(s[3],16)/15):6===s.length?(a[0]=parseInt(s.substr(0,2),16)/255,a[1]=parseInt(s.substr(2,2),16)/255,a[2]=parseInt(s.substr(4,2),16)/255,a[3]=1):8===s.length?(a[0]=parseInt(s.substr(0,2),16)/255,a[1]=parseInt(s.substr(2,2),16)/255,a[2]=parseInt(s.substr(4,2),16)/255,a[3]=parseInt(s.substr(6,2),16)/255):a[0]=a[1]=a[2]=a[3]=0,a;if(s=colorNames[value.toLowerCase()]){for(i=0;4>i;i++)a[i]=s[i];return a}return colorElement||(colorElement=document.createElement("a")),colorElement.style.backgroundColor="",colorElement.style.backgroundColor=value,computed=window.getComputedStyle(colorElement),bg=computed.getPropertyValue("background-color")||computed.getPropertyValue("backgroundColor")||colorElement.style.backgroundColor,bg&&bg!==value?Seriously.inputValidators.color(bg,input,oldValue):(a[0]=a[1]=a[2]=a[3]=0,a)}if(isArrayLike(value)){if(a=value,a.length<3)return a[0]=a[1]=a[2]=a[3]=0,a;for(i=0;3>i;i++)if(isNaN(a[i]))return a[0]=a[1]=a[2]=a[3]=0,a;return a.length<4&&a.push(1),a}if("number"==typeof value)return a[0]=a[1]=a[2]=value,a[3]=1,a;if("object"==typeof value){for(i=0;4>i;i++)s=colorFields[i],null===value[s]||isNaN(value[s])?a[i]=3===i?1:0:a[i]=value[s];return a}return a[0]=a[1]=a[2]=a[3]=0,a},number:function(value,input,defaultValue){return isNaN(value)?defaultValue||0:(value=parseFloat(value),value<input.min?input.min:value>input.max?input.max:input.step?Math.round(value/input.step)*input.step:value)},"enum":function(value,input,defaultValue){var options=input.options||[];return"string"==typeof value?value=value.toLowerCase():"number"==typeof value?value=value.toString():value||(value=""),options.hasOwnProperty(value)?value:defaultValue||""},vector:function(value,input,defaultValue,oldValue){var a,i,s,n=input.dimensions||4;if(a=oldValue||[],isArrayLike(value)){for(i=0;n>i;i++)a[i]=value[i]||0;return a}if("object"==typeof value){for(i=0;n>i;i++)s=vectorFields[i],void 0===value[s]&&(s=colorFields[i]),a[i]=value[s]||0;return a}for(value=parseFloat(value)||0,i=0;n>i;i++)a[i]=value;return a},"boolean":function(value){return value?!value||!value.toLowerCase||"false"!==value.toLowerCase():!1},string:function(value){return"string"==typeof value?value:0===value||value?value.toString?value.toString():String(value):""}},Seriously.prototype.effects=Seriously.effects=function(){var name,effect,manifest,input,i,effects={};for(name in seriousEffects)if(seriousEffects.hasOwnProperty(name)){effect=seriousEffects[name],manifest={title:effect.title||name,description:effect.description||"",inputs:{}};for(i in effect.inputs)effect.inputs.hasOwnProperty(i)&&(input=effect.inputs[i],manifest.inputs[i]={type:input.type,defaultValue:input.defaultValue,step:input.step,min:input.min,max:input.max,minCount:input.minCount,maxCount:input.maxCount,dimensions:input.dimensions,title:input.title||i,description:input.description||"",options:input.options||[]});effects[name]=manifest}return effects},window.Float32Array&&(identity=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])),window.Seriously&&"object"==typeof window.Seriously&&!function(){var i;for(i in window.Seriously)window.Seriously.hasOwnProperty(i)&&"plugin"!==i&&"object"==typeof window.Seriously[i]&&Seriously.plugin(i,window.Seriously[i])}(),Seriously.logger={log:consoleMethod("log"),info:consoleMethod("info"),warn:consoleMethod("warn"),error:consoleMethod("error")},Seriously.util={mat4:mat4,checkSource:checkSource,hslToRgb:hslToRgb,colors:colorNames,setTimeoutZero:setTimeoutZero,ShaderProgram:ShaderProgram,FrameBuffer:FrameBuffer,requestAnimationFrame:requestAnimationFrame,shader:{makeNoise:"float makeNoise(float u, float v, float timer) {\n	float x = u * v * mod(timer * 1000.0, 100.0);\n	x = mod(x, 13.0) * mod(x, 127.0);\n	float dx = mod(x, 0.01);\n	return clamp(0.1 + dx * 100.0, 0.0, 1.0);\n}\n",random:"#ifndef RANDOM\n#define RANDOM\nfloat random(vec2 n) {\n	return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453);\n}\n#endif\n"}},Seriously.source("video",function(video,options,force){function initializeVideo(){video.removeEventListener("loadedmetadata",initializeVideo,!0),destroyed||(video.videoWidth?(me.width===video.videoWidth&&me.height===video.videoHeight||(me.width=video.videoWidth,me.height=video.videoHeight,me.resize()),deferTexture&&me.setReady()):(deferTexture=!0,setTimeout(initializeVideo,50)))}function seeking(){isSeeking=!0}function seeked(){isSeeking=!1,me.setDirty()}var video,canvas,ctx2d,me=this,destroyed=!1,deferTexture=!1,isSeeking=!1,lastRenderTime=0;return video instanceof window.HTMLVideoElement?(video.readyState?initializeVideo():(deferTexture=!0,video.addEventListener("loadedmetadata",initializeVideo,!0)),video.addEventListener("seeking",seeking,!1),video.addEventListener("seeked",seeked,!1),{deferTexture:deferTexture,source:video,render:function renderVideo(gl){var source,error;if(lastRenderTime=video.currentTime,!video.videoHeight||!video.videoWidth)return!1;noVideoTextureSupport?(ctx2d||(ctx2d=document.createElement("canvas").getContext("2d"),canvas=ctx2d.canvas,canvas.width=me.width,canvas.height=me.height),source=canvas,ctx2d.drawImage(video,0,0,me.width,me.height)):source=video,gl.bindTexture(gl.TEXTURE_2D,me.texture),gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,me.flip),gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);try{if(gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,source),void 0===noVideoTextureSupport){if(error=gl.getError(),error===gl.INVALID_VALUE)return noVideoTextureSupport=!0,renderVideo(gl);noVideoTextureSupport=!1}return!0}catch(securityError){securityError.code===window.DOMException.SECURITY_ERR?(me.allowRefresh=!1,Seriously.logger.error("Unable to access cross-domain image")):Seriously.logger.error("Error rendering video source",securityError)}return!1},checkDirty:function(){return!isSeeking&&video.currentTime!==lastRenderTime},compare:function(source){return me.source===source},destroy:function(){destroyed=!0,video.removeEventListener("seeking",seeking,!1),video.removeEventListener("seeked",seeked,!1),video.removeEventListener("loadedmetadata",initializeVideo,!0)}}):void 0},{title:"Video"}),Seriously.transform("2d",function(options){function recompute(){function translate(x,y){matrix[12]=matrix[0]*x+matrix[4]*y+matrix[12],matrix[13]=matrix[1]*x+matrix[5]*y+matrix[13],matrix[14]=matrix[2]*x+matrix[6]*y+matrix[14],matrix[15]=matrix[3]*x+matrix[7]*y+matrix[15]}var angle,s,c,m00,m01,m02,m03,m10,m11,m12,m13,matrix=me.matrix;return translateX||translateY||rotation||skewX||skewY||1!==scaleX||1!==scaleY?(mat4.identity(matrix),translate(translateX+centerX,translateY+centerY),skewX&&(matrix[4]=skewX/me.width),skewY&&(matrix[1]=skewY/me.height),rotation&&(m00=matrix[0],m01=matrix[1],m02=matrix[2],m03=matrix[3],m10=matrix[4],m11=matrix[5],m12=matrix[6],m13=matrix[7],angle=-(degrees?rotation*Math.PI/180:rotation),s=Math.sin(angle),c=Math.cos(angle),matrix[0]=m00*c+m10*s,matrix[1]=m01*c+m11*s,matrix[2]=m02*c+m12*s,matrix[3]=m03*c+m13*s,matrix[4]=m10*c-m00*s,matrix[5]=m11*c-m01*s,matrix[6]=m12*c-m02*s,matrix[7]=m13*c-m03*s),1!==scaleX&&(matrix[0]*=scaleX,matrix[1]*=scaleX,matrix[2]*=scaleX,matrix[3]*=scaleX),1!==scaleY&&(matrix[4]*=scaleY,matrix[5]*=scaleY,matrix[6]*=scaleY,matrix[7]*=scaleY),translate(-centerX,-centerY),void(me.transformed=!0)):void(me.transformed=!1)}var me=this,degrees=!(options&&options.radians),centerX=0,centerY=0,scaleX=1,scaleY=1,translateX=0,translateY=0,rotation=0,skewX=0,skewY=0;return{inputs:{reset:{method:function(){return centerX=0,centerY=0,scaleX=1,scaleY=1,translateX=0,translateY=0,rotation=0,skewX=0,skewY=0,me.transformed?(me.transformed=!1,!0):!1}},translate:{method:function(x,y){return isNaN(x)&&(x=translateX),isNaN(y)&&(y=translateY),x===translateX&&y===translateY?!1:(translateX=x,translateY=y,recompute(),!0)},type:["number","number"]},translateX:{get:function(){return translateX},set:function(x){return x===translateX?!1:(translateX=x,recompute(),!0)},type:"number"},translateY:{get:function(){return translateY},set:function(y){return y===translateY?!1:(translateY=y,recompute(),!0)},type:"number"},rotation:{get:function(){return rotation},set:function(angle){return angle===rotation?!1:(rotation=parseFloat(angle),recompute(),!0)},type:"number"},center:{method:function(x,y){return isNaN(x)&&(x=centerX),isNaN(y)&&(y=centerY),x===centerX&&y===centerY?!1:(centerX=x,centerY=y,recompute(),!0)},type:["number","number"]},centerX:{get:function(){return centerX},set:function(x){return x===centerX?!1:(centerX=x,recompute(),!0)},type:"number"},centerY:{get:function(){return centerY},set:function(y){return y===centerY?!1:(centerY=y,recompute(),!0)},type:"number"},skew:{method:function(x,y){return isNaN(x)&&(x=skewX),isNaN(y)&&(y=skewY),x===skewX&&y===skewY?!1:(skewX=x,skewY=y,recompute(),!0)},type:["number","number"]},skewX:{get:function(){return skewX},set:function(x){return x===skewX?!1:(skewX=x,recompute(),!0)},type:"number"},skewY:{get:function(){return skewY},set:function(y){return y===skewY?!1:(skewY=y,recompute(),!0)},type:"number"},scale:{method:function(x,y){var newX,newY;if(newX=isNaN(x)?scaleX:x,isNaN(y)){if(isNaN(x))return!1;newY=newX}else newY=y;return newX===scaleX&&newY===scaleY?!1:(scaleX=newX,scaleY=newY,recompute(),!0)},type:["number","number"]},scaleX:{get:function(){return scaleX},set:function(x){return x===scaleX?!1:(scaleX=x,recompute(),!0)},type:"number"},scaleY:{get:function(){return scaleY},set:function(y){return y===scaleY?!1:(scaleY=y,recompute(),!0)},type:"number"}}}},{title:"2D Transform",description:"Translate, Rotate, Scale, Skew"}),Seriously.transform("flip",function(){function recompute(){var matrix=me.matrix;horizontal?(matrix[0]=-1,matrix[5]=1):(matrix[0]=1,matrix[5]=-1)}var me=this,horizontal=!0;return mat4.identity(me.matrix),recompute(),me.transformDirty=!0,me.transformed=!0,{inputs:{direction:{get:function(){return horizontal?"horizontal":"vertical"},set:function(d){var horiz;return horiz="vertical"!==d,horiz===horizontal?!1:(horizontal=horiz,recompute(),!0)},type:"string"}}}},{title:"Flip",description:"Flip Horizontal/Vertical"}),Seriously.transform("reformat",function(){function recompute(){var scaleX,scaleY,aspectIn,aspectOut,matrix=me.matrix,width=forceWidth||me.width,height=forceHeight||me.height,source=me.source,sourceWidth=source&&source.width||1,sourceHeight=source&&source.height||1;return"distort"===mode||width===sourceWidth&&height===sourceHeight?void(me.transformed=!1):(aspectIn=sourceWidth/sourceHeight,aspectOut=width/height,"none"===mode?(scaleX=sourceWidth/width,scaleY=sourceHeight/height):"width"===mode||"contain"===mode&&aspectIn>=aspectOut?(scaleX=1,scaleY=aspectOut/aspectIn):"height"===mode||"contain"===mode&&aspectOut>aspectIn?(scaleX=aspectIn/aspectOut,scaleY=1):aspectOut>aspectIn?(scaleX=1,scaleY=aspectOut/aspectIn):(scaleX=aspectIn/aspectOut,scaleY=1),1===scaleX&&1===scaleY?void(me.transformed=!1):(mat4.identity(matrix),1!==scaleX&&(matrix[0]*=scaleX,matrix[1]*=scaleX,matrix[2]*=scaleX,matrix[3]*=scaleX),1!==scaleY&&(matrix[4]*=scaleY,matrix[5]*=scaleY,matrix[6]*=scaleY,matrix[7]*=scaleY),void(me.transformed=!0)))}function getWidth(){return forceWidth||me.source&&me.source.width||1}function getHeight(){return forceHeight||me.source&&me.source.height||1}var forceWidth,forceHeight,me=this,mode="contain";return this.resize=function(){var i,width=getWidth(),height=getHeight();if(this.width!==width||this.height!==height)for(this.width=width,this.height=height,this.uniforms&&this.uniforms.resolution&&(this.uniforms.resolution[0]=width,this.uniforms.resolution[1]=height),this.frameBuffer&&this.frameBuffer.resize&&this.frameBuffer.resize(width,height),i=0;i<this.targets.length;i++)this.targets[i].resize();this.setTransformDirty(),recompute()},{inputs:{width:{get:getWidth,set:function(x){return x=Math.floor(x),x===forceWidth?!1:(forceWidth=x,this.resize(),!1)},type:"number"},height:{get:getHeight,set:function(y){return y=Math.floor(y),y===forceHeight?!1:(forceHeight=y,this.resize(),!1)},type:"number"},mode:{get:function(){return mode},set:function(m){return m===mode?!1:(mode=m,recompute(),!0)},type:"enum",options:["cover","contain","distort","width","height","none"]}}}},{title:"Reformat",description:"Change output dimensions"}),Seriously.util.shader.noiseHelpers="#ifndef NOISE_HELPERS\n#define NOISE_HELPERS\nvec2 mod289(vec2 x) {\n	return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec3 mod289(vec3 x) {\n	return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 mod289(vec4 x) {\n	return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec3 permute(vec3 x) {\n	return mod289(((x*34.0)+1.0)*x);\n}\nvec4 permute(vec4 x) {\n	return mod289(((x*34.0)+1.0)*x);\n}\nvec4 taylorInvSqrt(vec4 r) {\n	return 1.79284291400159 - 0.85373472095314 * r;\n}\nfloat taylorInvSqrt(float r) {\n	return 1.79284291400159 - 0.85373472095314 * r;\n}\n#endif\n",Seriously.util.shader.snoise2d="#ifndef NOISE2D\n#define NOISE2D\nfloat snoise(vec2 v) {\n	const vec4 C = vec4(0.211324865405187, // (3.0-sqrt(3.0))/6.0\n		0.366025403784439, // 0.5*(sqrt(3.0)-1.0)\n		-0.577350269189626, // -1.0 + 2.0 * C.x\n		0.024390243902439); // 1.0 / 41.0\n	vec2 i = floor(v + dot(v, C.yy));\n	vec2 x0 = v - i + dot(i, C.xx);\n	vec2 i1;\n	//i1.x = step(x0.y, x0.x); // x0.x > x0.y ? 1.0 : 0.0\n	//i1.y = 1.0 - i1.x;\n	i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n	// x0 = x0 - 0.0 + 0.0 * C.xx ;\n	// x1 = x0 - i1 + 1.0 * C.xx ;\n	// x2 = x0 - 1.0 + 2.0 * C.xx ;\n	vec4 x12 = x0.xyxy + C.xxzz;\n	x12.xy -= i1;\n	i = mod289(i); // Avoid truncation effects in permutation\n	vec3 p = permute(permute(i.y + vec3(0.0, i1.y, 1.0)) + i.x + vec3(0.0, i1.x, 1.0));\n	vec3 m = max(0.5 - vec3(dot(x0, x0), dot(x12.xy, x12.xy), dot(x12.zw, x12.zw)), 0.0);\n	m = m*m ;\n	m = m*m ;\n	vec3 x = 2.0 * fract(p * C.www) - 1.0;\n	vec3 h = abs(x) - 0.5;\n	vec3 ox = floor(x + 0.5);\n	vec3 a0 = x - ox;\n	m *= 1.79284291400159 - 0.85373472095314 * (a0*a0 + h*h);\n	vec3 g;\n	g.x = a0.x * x0.x + h.x * x0.y;\n	g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n	return 130.0 * dot(m, g);\n}\n#endif\n",Seriously.util.shader.snoise3d="#ifndef NOISE3D\n#define NOISE3D\nfloat snoise(vec3 v) {\n	const vec2 C = vec2(1.0/6.0, 1.0/3.0) ;\n	const vec4 D = vec4(0.0, 0.5, 1.0, 2.0);\n	vec3 i = floor(v + dot(v, C.yyy));\n	vec3 x0 = v - i + dot(i, C.xxx) ;\n	vec3 g = step(x0.yzx, x0.xyz);\n	vec3 l = 1.0 - g;\n	vec3 i1 = min(g.xyz, l.zxy);\n	vec3 i2 = max(g.xyz, l.zxy);\n	// x0 = x0 - 0.0 + 0.0 * C.xxx;\n	// x1 = x0 - i1 + 1.0 * C.xxx;\n	// x2 = x0 - i2 + 2.0 * C.xxx;\n	// x3 = x0 - 1.0 + 3.0 * C.xxx;\n	vec3 x1 = x0 - i1 + C.xxx;\n	vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n	vec3 x3 = x0 - D.yyy; // -1.0+3.0*C.x = -0.5 = -D.y\n	i = mod289(i);\n	vec4 p = permute(permute(permute(\n						i.z + vec4(0.0, i1.z, i2.z, 1.0))\n						+ i.y + vec4(0.0, i1.y, i2.y, 1.0))\n						+ i.x + vec4(0.0, i1.x, i2.x, 1.0));\n	float n_ = 0.142857142857; // 1.0/7.0\n	vec3 ns = n_ * D.wyz - D.xzx;\n	vec4 j = p - 49.0 * floor(p * ns.z * ns.z); // mod(p, 7 * 7)\n	vec4 x_ = floor(j * ns.z);\n	vec4 y_ = floor(j - 7.0 * x_); // mod(j, N)\n	vec4 x = x_ * ns.x + ns.yyyy;\n	vec4 y = y_ * ns.x + ns.yyyy;\n	vec4 h = 1.0 - abs(x) - abs(y);\n	vec4 b0 = vec4(x.xy, y.xy);\n	vec4 b1 = vec4(x.zw, y.zw);\n	//vec4 s0 = vec4(lessThan(b0, 0.0)) * 2.0 - 1.0;\n	//vec4 s1 = vec4(lessThan(b1, 0.0)) * 2.0 - 1.0;\n	vec4 s0 = floor(b0) * 2.0 + 1.0;\n	vec4 s1 = floor(b1) * 2.0 + 1.0;\n	vec4 sh = -step(h, vec4(0.0));\n	vec4 a0 = b0.xzyw + s0.xzyw * sh.xxyy ;\n	vec4 a1 = b1.xzyw + s1.xzyw * sh.zzww ;\n	vec3 p0 = vec3(a0.xy, h.x);\n	vec3 p1 = vec3(a0.zw, h.y);\n	vec3 p2 = vec3(a1.xy, h.z);\n	vec3 p3 = vec3(a1.zw, h.w);\n	vec4 norm = taylorInvSqrt(vec4(dot(p0, p0), dot(p1, p1), dot(p2, p2), dot(p3, p3)));\n	p0 *= norm.x;\n	p1 *= norm.y;\n	p2 *= norm.z;\n	p3 *= norm.w;\n	vec4 m = max(0.6 - vec4(dot(x0, x0), dot(x1, x1), dot(x2, x2), dot(x3, x3)), 0.0);\n	m = m * m;\n	return 42.0 * dot(m*m, vec4(dot(p0, x0), dot(p1, x1), dot(p2, x2), dot(p3, x3)));\n}\n#endif\n",Seriously.util.shader.snoise4d="#ifndef NOISE4D\n#define NOISE4D\nvec4 grad4(float j, vec4 ip)\n	{\n	const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);\n	vec4 p, s;\n\n	p.xyz = floor(fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;\n	p.w = 1.5 - dot(abs(p.xyz), ones.xyz);\n	s = vec4(lessThan(p, vec4(0.0)));\n	p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www;\n\n	return p;\n	}\n\n#define F4 0.309016994374947451\n\nfloat snoise(vec4 v)\n	{\n	const vec4 C = vec4(0.138196601125011, // (5 - sqrt(5))/20 G4\n						0.276393202250021, // 2 * G4\n						0.414589803375032, // 3 * G4\n						-0.447213595499958); // -1 + 4 * G4\n\n	vec4 i = floor(v + dot(v, vec4(F4)));\n	vec4 x0 = v - i + dot(i, C.xxxx);\n\n\n	vec4 i0;\n	vec3 isX = step(x0.yzw, x0.xxx);\n	vec3 isYZ = step(x0.zww, x0.yyz);\n	i0.x = isX.x + isX.y + isX.z;\n	i0.yzw = 1.0 - isX;\n	i0.y += isYZ.x + isYZ.y;\n	i0.zw += 1.0 - isYZ.xy;\n	i0.z += isYZ.z;\n	i0.w += 1.0 - isYZ.z;\n\n	vec4 i3 = clamp(i0, 0.0, 1.0);\n	vec4 i2 = clamp(i0 - 1.0, 0.0, 1.0);\n	vec4 i1 = clamp(i0 - 2.0, 0.0, 1.0);\n\n	vec4 x1 = x0 - i1 + C.xxxx;\n	vec4 x2 = x0 - i2 + C.yyyy;\n	vec4 x3 = x0 - i3 + C.zzzz;\n	vec4 x4 = x0 + C.wwww;\n\n	i = mod289(i);\n	float j0 = permute(permute(permute(permute(i.w) + i.z) + i.y) + i.x);\n	vec4 j1 = permute(permute(permute(permute (\n					i.w + vec4(i1.w, i2.w, i3.w, 1.0))\n					+ i.z + vec4(i1.z, i2.z, i3.z, 1.0))\n					+ i.y + vec4(i1.y, i2.y, i3.y, 1.0))\n					+ i.x + vec4(i1.x, i2.x, i3.x, 1.0));\n\n	vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;\n\n	vec4 p0 = grad4(j0, ip);\n	vec4 p1 = grad4(j1.x, ip);\n	vec4 p2 = grad4(j1.y, ip);\n	vec4 p3 = grad4(j1.z, ip);\n	vec4 p4 = grad4(j1.w, ip);\n\n	vec4 norm = taylorInvSqrt(vec4(dot(p0, p0), dot(p1, p1), dot(p2, p2), dot(p3, p3)));\n	p0 *= norm.x;\n	p1 *= norm.y;\n	p2 *= norm.z;\n	p3 *= norm.w;\n	p4 *= taylorInvSqrt(dot(p4, p4));\n\n	vec3 m0 = max(0.6 - vec3(dot(x0, x0), dot(x1, x1), dot(x2, x2)), 0.0);\n	vec2 m1 = max(0.6 - vec2(dot(x3, x3), dot(x4, x4)), 0.0);\n	m0 = m0 * m0;\n	m1 = m1 * m1;\n	return 49.0 * (dot(m0*m0, vec3(dot(p0, x0), dot(p1, x1), dot(p2, x2)))\n							+ dot(m1*m1, vec2(dot(p3, x3), dot(p4, x4)))) ;\n}\n#endif\n",Seriously}),function(root,factory){"use strict";"function"==typeof define&&define.amd?define(["seriously"],factory):"object"==typeof exports?factory(require("seriously")):(root.Seriously||(root.Seriously={plugin:function(name,opt){this[name]=opt}}),factory(root.Seriously))}(this,function(Seriously){"use strict";function multiplyArray(factor,a){var i;for(i=0;i<a.length;i++)a[i]*=factor;return a}var i,j,matrices,freiChenMatrixConstants,sobelMatrixConstants,sqrt=Math.sqrt,flatMatrices=[];for(matrices=[multiplyArray(1/(2*sqrt(2)),[1,sqrt(2),1,0,0,0,-1,-sqrt(2),-1]),multiplyArray(1/(2*sqrt(2)),[1,0,-1,sqrt(2),0,-sqrt(2),1,0,-1]),multiplyArray(1/(2*sqrt(2)),[0,-1,sqrt(2),1,0,-1,-sqrt(2),1,0]),multiplyArray(1/(2*sqrt(2)),[sqrt(2),-1,0,-1,0,1,0,1,-sqrt(2)]),multiplyArray(.5,[0,1,0,-1,0,-1,0,1,0]),multiplyArray(.5,[-1,0,1,0,0,0,1,0,-1]),multiplyArray(1/6,[1,-2,1,-2,4,-2,1,-2,1]),multiplyArray(1/6,[-2,1,-2,1,4,1,-2,1,-2]),multiplyArray(1/3,[1,1,1,1,1,1,1,1,1])],i=0;i<matrices.length;i++)for(j=0;j<matrices[i].length;j++)flatMatrices.push(matrices[i][j]);freiChenMatrixConstants=new Float32Array(flatMatrices),sobelMatrixConstants=new Float32Array([1,2,1,0,0,0,-1,-2,-1,1,0,-1,2,0,-2,1,0,-1]),Seriously.plugin("edge",{initialize:function(initialize){initialize(),this.uniforms.pixelWidth=1/this.width,this.uniforms.pixelHeight=1/this.height,"sobel"===this.inputs.mode?this.uniforms["G[0]"]=sobelMatrixConstants:this.uniforms["G[0]"]=freiChenMatrixConstants},shader:function(inputs,shaderSource){var defines;return defines="sobel"===inputs.mode?"#define N_MATRICES 2\n#define SOBEL\n":"#define N_MATRICES 9\n",shaderSource.fragment=[defines,"precision mediump float;","varying vec2 vTexCoord;","uniform sampler2D source;","uniform float pixelWidth;","uniform float pixelHeight;","uniform mat3 G[9];","void main(void) {","	mat3 I;","	float dp3, cnv[9];","	vec3 tc;","	float fi = 0.0, fj = 0.0;","	for (int i = 0; i < 3; i++) {","		fj = 0.0;","		for (int j = 0; j < 3; j++) {","			I[i][j] = length( texture2D(source, vTexCoord + vec2((fi - 1.0) * pixelWidth, (fj - 1.0) * pixelHeight)).rgb );","			fj += 1.0;","		};","		fi += 1.0;","	};","	for (int i = 0; i < N_MATRICES; i++) {","		dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);","		cnv[i] = dp3 * dp3;","	};","#ifdef SOBEL","	tc = vec3(0.5 * sqrt(cnv[0]*cnv[0]+cnv[1]*cnv[1]));","#else","	float M = (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]);","	float S = (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]) + (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + cnv[8];","	tc = vec3(sqrt(M/S));","#endif","	gl_FragColor = vec4(tc, 1.0);","}"].join("\n"),shaderSource},resize:function(){this.uniforms.pixelWidth=1/this.width,this.uniforms.pixelHeight=1/this.height},inputs:{source:{type:"image",uniform:"source"},mode:{type:"enum",shaderDirty:!0,defaultValue:"sobel",options:[["sobel","Sobel"],["frei-chen","Frei-Chen"]],update:function(){"sobel"===this.inputs.mode?this.uniforms["G[0]"]=sobelMatrixConstants:this.uniforms["G[0]"]=freiChenMatrixConstants}}},description:"Edge Detect",title:"Edge Detect"})}),function(root,factory){"use strict";"function"==typeof define&&define.amd?define(["seriously"],factory):"object"==typeof exports?factory(require("seriously")):(root.Seriously||(root.Seriously={plugin:function(name,opt){this[name]=opt}}),factory(root.Seriously))}(this,function(Seriously){"use strict";function vectorBlendFormula(formula,base,blend){function replace(channel){var r={base:(base||"base")+"."+channel,blend:(blend||"blend")+"."+channel};return function(match){return r[match]||match}}return"vec3("+formula.replace(/blend|base/g,replace("r"))+", "+formula.replace(/blend|base/g,replace("g"))+", "+formula.replace(/blend|base/g,replace("b"))+")"}var blendModes={normal:"blend",lighten:"max(blend, base)",darken:"min(blend, base)",multiply:"(base * blend)",average:"(base + blend / TWO)",add:"min(base + blend, ONE)",subtract:"max(base - blend, ZERO)",divide:"base / blend",difference:"abs(base - blend)",negation:"(ONE - abs(ONE - base - blend))",exclusion:"(base + blend - TWO * base * blend)",screen:"(ONE - ((ONE - base) * (ONE - blend)))",lineardodge:"min(base + blend, ONE)",phoenix:"(min(base, blend) - max(base, blend) + ONE)",linearburn:"max(base + blend - ONE, ZERO)",hue:"BlendHue(base, blend)",saturation:"BlendSaturation(base, blend)",color:"BlendColor(base, blend)",luminosity:"BlendLuminosity(base, blend)",darkercolor:"BlendDarkerColor(base, blend)",lightercolor:"BlendLighterColor(base, blend)",overlay:vectorBlendFormula("base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend))"),softlight:vectorBlendFormula("blend < 0.5 ? (2.0 * base * blend + base * base * (1.0 - 2.0 * blend)) : (sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend))"),hardlight:vectorBlendFormula("base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend))","blend","base"),colordodge:vectorBlendFormula("blend == 1.0 ? blend : min(base / (1.0 - blend), 1.0)"),colorburn:vectorBlendFormula("blend == 0.0 ? blend : max((1.0 - ((1.0 - base) / blend)), 0.0)"),linearlight:vectorBlendFormula("BlendLinearLightf(base, blend)"),vividlight:vectorBlendFormula("BlendVividLightf(base, blend)"),pinlight:vectorBlendFormula("BlendPinLightf(base, blend)"),hardmix:vectorBlendFormula("BlendHardMixf(base, blend)"),reflect:vectorBlendFormula("BlendReflectf(base, blend)"),glow:vectorBlendFormula("BlendReflectf(blend, base)")},nativeBlendModes={normal:["FUNC_ADD","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","SRC_ALPHA","DST_ALPHA"]},identity=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);Seriously.plugin("blend",function(){function updateDrawFunction(){var nativeMode=inputs&&nativeBlendModes[inputs.mode];nativeMode&&gl&&(topOpts.blendEquation=gl[nativeMode[0]],topOpts.srcRGB=gl[nativeMode[1]],topOpts.dstRGB=gl[nativeMode[2]],topOpts.srcAlpha=gl[nativeMode[3]],topOpts.dstAlpha=gl[nativeMode[4]])}var topUniforms,bottomUniforms,inputs,gl,topOpts={clear:!1};return this.resize=function(){var width,height,node,fn,i,mode=this.inputs.sizeMode,bottom=this.inputs.bottom,top=this.inputs.top;for("bottom"===mode||"top"===mode?(node=this.inputs[mode],node?(width=node.width,height=node.height):(width=1,height=1)):bottom?top?(fn="union"===mode?Math.max:Math.min,width=fn(bottom.width,top.width),height=fn(bottom.height,top.height)):(width=bottom.width,height=bottom.height):top?(width=top.width,height=top.height):(width=1,height=1),this.width===width&&this.height===height||(this.width=width,this.height=height,this.uniforms.resolution[0]=width,this.uniforms.resolution[1]=height,this.frameBuffer&&this.frameBuffer.resize(width,height),this.emit("resize"),this.setDirty()),this.uniforms.resBottom[0]=bottom&&bottom.width||1,this.uniforms.resBottom[1]=bottom&&bottom.height||1,this.uniforms.resTop[0]=top&&top.width||1,this.uniforms.resTop[1]=top&&top.height||1,topUniforms&&(bottom&&(bottomUniforms.resolution[0]=bottom.width,bottomUniforms.resolution[1]=bottom.height),top&&(topUniforms.resolution[0]=top.width,topUniforms.resolution[1]=top.height)),i=0;i<this.targets.length;i++)this.targets[i].resize()},this.uniforms.resTop=[1,1],this.uniforms.resBottom=[1,1],{initialize:function(initialize){inputs=this.inputs,initialize(),gl=this.gl,updateDrawFunction()},shader:function(inputs,shaderSource){var node,mode=inputs.mode||"normal";return mode=mode.toLowerCase(),nativeBlendModes[mode]?(topUniforms||(node=this.inputs.top,topUniforms={resolution:[node&&node.width||1,node&&node.height||1],targetRes:this.uniforms.resolution,source:node,transform:node&&node.cumulativeMatrix||identity,opacity:this.inputs.opacity},node=this.inputs.bottom,bottomUniforms={resolution:[node&&node.width||1,node&&node.height||1],targetRes:this.uniforms.resolution,source:node,transform:node&&node.cumulativeMatrix||identity,opacity:1}),shaderSource.vertex=["precision mediump float;","attribute vec4 position;","attribute vec2 texCoord;","uniform vec2 resolution;","uniform vec2 targetRes;","uniform mat4 transform;","varying vec2 vTexCoord;","void main(void) {","	vec4 screenPosition = vec4(position.xy * resolution / 2.0, position.z, position.w);","	screenPosition = transform * screenPosition;","	gl_Position.xy = screenPosition.xy * 2.0 / resolution;","	gl_Position.z = screenPosition.z * 2.0 / (resolution.x / resolution.y);","	gl_Position.xy *= resolution / targetRes;","	gl_Position.w = screenPosition.w;","	vTexCoord = texCoord;","}\n"].join("\n"),shaderSource.fragment=["precision mediump float;","varying vec2 vTexCoord;","uniform sampler2D source;","uniform float opacity;","void main(void) {","	gl_FragColor = texture2D(source, vTexCoord);","	gl_FragColor.a *= opacity;","}"].join("\n"),shaderSource):(topUniforms=null,bottomUniforms=null,shaderSource.vertex=["precision mediump float;","attribute vec4 position;","attribute vec2 texCoord;","uniform vec2 resolution;","uniform vec2 resBottom;","uniform vec2 resTop;","varying vec2 texCoordBottom;","varying vec2 texCoordTop;","const vec2 HALF = vec2(0.5);","void main(void) {","	gl_Position = position;","	vec2 adjusted = (texCoord - HALF) * resolution;","	texCoordBottom = adjusted / resBottom + HALF;","	texCoordTop = adjusted / resTop + HALF;","}"].join("\n"),
shaderSource.fragment=["precision mediump float;","const vec3 ZERO = vec3(0.0);","const vec3 ONE = vec3(1.0);","const vec3 HALF = vec3(0.5);","const vec3 TWO = vec3(2.0);","#define BlendAddf(base, blend)			min(base + blend, 1.0)","#define BlendLinearDodgef(base, blend)	BlendAddf(base, blend)","#define BlendLinearBurnf(base, blend)	max(base + blend - 1.0, 0.0)","#define BlendLightenf(base, blend)		max(blend, base)","#define BlendDarkenf(base, blend)		min(blend, base)","#define BlendLinearLightf(base, blend)	(blend < 0.5 ? BlendLinearBurnf(base, (2.0 * blend)) : BlendLinearDodgef(base, (2.0 * (blend - 0.5))))","#define BlendScreenf(base, blend)		(1.0 - ((1.0 - base) * (1.0 - blend)))","#define BlendOverlayf(base, blend)		(base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend)))","#define BlendSoftLightf(base, blend)	((blend < 0.5) ? (2.0 * base * blend + base * base * (1.0 - 2.0 * blend)) : (sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend)))","#define BlendColorDodgef(base, blend)	((blend == 1.0) ? blend : min(base / (1.0 - blend), 1.0))","#define BlendColorBurnf(base, blend)	((blend == 0.0) ? blend : max((1.0 - ((1.0 - base) / blend)), 0.0))","#define BlendVividLightf(base, blend)	((blend < 0.5) ? BlendColorBurnf(base, (2.0 * blend)) : BlendColorDodgef(base, (2.0 * (blend - 0.5))))","#define BlendPinLightf(base, blend)	((blend < 0.5) ? BlendDarkenf(base, (2.0 * blend)) : BlendLightenf(base, (2.0 *(blend - 0.5))))","#define BlendHardMixf(base, blend)		((BlendVividLightf(base, blend) < 0.5) ? 0.0 : 1.0)","#define BlendReflectf(base, blend)		((blend == 1.0) ? blend : min(base * base / (1.0 - blend), 1.0))","vec3 RGBToHSL(vec3 color) {","	vec3 hsl;","	float fmin = min(min(color.r, color.g), color.b);","	float fmax = max(max(color.r, color.g), color.b);","	float delta = fmax - fmin;","	hsl.z = (fmax + fmin) / 2.0;","	if (delta == 0.0) {","		hsl.x = 0.0;","		hsl.y = 0.0;","	} else {","		if (hsl.z < 0.5)","			hsl.y = delta / (fmax + fmin);","		else","			hsl.y = delta / (2.0 - fmax - fmin);","		float deltaR = (((fmax - color.r) / 6.0) + (delta / 2.0)) / delta;","		float deltaG = (((fmax - color.g) / 6.0) + (delta / 2.0)) / delta;","		float deltaB = (((fmax - color.b) / 6.0) + (delta / 2.0)) / delta;","		if (color.r == fmax )","			hsl.x = deltaB - deltaG;","		else if (color.g == fmax)","			hsl.x = (1.0 / 3.0) + deltaR - deltaB;","		else if (color.b == fmax)","			hsl.x = (2.0 / 3.0) + deltaG - deltaR;","		if (hsl.x < 0.0)","			hsl.x += 1.0;","		else if (hsl.x > 1.0)","			hsl.x -= 1.0;","	}","	return hsl;","}","float HueToRGB(float f1, float f2, float hue) {","	if (hue < 0.0)","		hue += 1.0;","	else if (hue > 1.0)","		hue -= 1.0;","	float res;","	if ((6.0 * hue) < 1.0)","		res = f1 + (f2 - f1) * 6.0 * hue;","	else if ((2.0 * hue) < 1.0)","		res = f2;","	else if ((3.0 * hue) < 2.0)","		res = f1 + (f2 - f1) * ((2.0 / 3.0) - hue) * 6.0;","	else","		res = f1;","	return res;","}","vec3 HSLToRGB(vec3 hsl) {","	vec3 rgb;","	if (hsl.y == 0.0)","		rgb = vec3(hsl.z);","	else {","		float f2;","		if (hsl.z < 0.5)","			f2 = hsl.z * (1.0 + hsl.y);","		else","			f2 = (hsl.z + hsl.y) - (hsl.y * hsl.z);","		float f1 = 2.0 * hsl.z - f2;","		rgb.r = HueToRGB(f1, f2, hsl.x + (1.0/3.0));","		rgb.g = HueToRGB(f1, f2, hsl.x);","		rgb.b= HueToRGB(f1, f2, hsl.x - (1.0/3.0));","	}","	return rgb;","}","vec3 BlendHue(vec3 base, vec3 blend) {","	vec3 baseHSL = RGBToHSL(base);","	return HSLToRGB(vec3(RGBToHSL(blend).r, baseHSL.g, baseHSL.b));","}","vec3 BlendSaturation(vec3 base, vec3 blend) {","	vec3 baseHSL = RGBToHSL(base);","	return HSLToRGB(vec3(baseHSL.r, RGBToHSL(blend).g, baseHSL.b));","}","vec3 BlendColor(vec3 base, vec3 blend) {","	vec3 blendHSL = RGBToHSL(blend);","	return HSLToRGB(vec3(blendHSL.r, blendHSL.g, RGBToHSL(base).b));","}","vec3 BlendLuminosity(vec3 base, vec3 blend) {","	vec3 baseHSL = RGBToHSL(base);","	return HSLToRGB(vec3(baseHSL.r, baseHSL.g, RGBToHSL(blend).b));","}","vec3 BlendLighterColor(vec3 base, vec3 blend) {","	float baseTotal = base.r + base.g + base.b;","	float blendTotal = blend.r + blend.g + blend.b;","	return blendTotal > baseTotal ? blend : base;","}","vec3 BlendDarkerColor(vec3 base, vec3 blend) {","	float baseTotal = base.r + base.g + base.b;","	float blendTotal = blend.r + blend.g + blend.b;","	return blendTotal < baseTotal ? blend : base;","}","#define BlendFunction(base, blend) "+blendModes[mode],"varying vec2 texCoordBottom;","varying vec2 texCoordTop;","uniform sampler2D top;","uniform sampler2D bottom;","uniform float opacity;","vec3 BlendOpacity(vec4 base, vec4 blend, float opacity) {","	vec3 blendedColor = BlendFunction(base.rgb, blend.rgb);","	return mix(base.rgb, blendedColor, opacity * blend.a);","}","void main(void) {","	vec4 topPixel = texture2D(top, texCoordTop);","	vec4 bottomPixel = texture2D(bottom, texCoordBottom);","	if (topPixel.a == 0.0) {","		gl_FragColor = bottomPixel;","	} else {","		gl_FragColor = vec4(BlendOpacity(bottomPixel, topPixel, opacity), bottomPixel.a);","	}","}"].join("\n"),shaderSource)},draw:function(shader,model,uniforms,frameBuffer,draw){nativeBlendModes[this.inputs.mode]?(this.inputs.bottom?draw(shader,model,bottomUniforms,frameBuffer):(gl.viewport(0,0,this.width,this.height),gl.bindFramebuffer(gl.FRAMEBUFFER,frameBuffer),gl.clearColor(0,0,0,0),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT)),this.inputs.top&&this.inputs.opacity&&draw(shader,model,topUniforms,frameBuffer,null,topOpts)):draw(shader,model,uniforms,frameBuffer)},requires:function(sourceName){return!(!this.inputs.opacity&&"top"===sourceName)},inputs:{top:{type:"image",uniform:"top",update:function(){topUniforms&&(topUniforms.source=this.inputs.top,topUniforms.transform=this.inputs.top.cumulativeMatrix||identity),this.resize()}},bottom:{type:"image",uniform:"bottom",update:function(){bottomUniforms&&(bottomUniforms.source=this.inputs.bottom,bottomUniforms.transform=this.inputs.bottom.cumulativeMatrix||identity),this.resize()}},opacity:{type:"number",uniform:"opacity",defaultValue:1,min:0,max:1,updateSources:!0,update:function(opacity){topUniforms&&(topUniforms.opacity=opacity)}},sizeMode:{type:"enum",defaultValue:"bottom",options:["bottom","top","union","intersection"],update:function(){this.resize()}},mode:{type:"enum",shaderDirty:!0,defaultValue:"normal",options:[["normal","Normal"],["lighten","Lighten"],["darken","Darken"],["multiply","Multiply"],["average","Average"],["add","Add"],["subtract","Subtract"],["divide","Divide"],["difference","Difference"],["negation","Negation"],["exclusion","Exclusion"],["screen","Screen"],["overlay","Overlay"],["softlight","Soft Light"],["hardlight","Hard Light"],["colordodge","Color Dodge"],["colorburn","Color Burn"],["lineardodge","Linear Dodge"],["linearburn","Linear Burn"],["linearlight","Linear Light"],["vividlight","Vivid Light"],["pinlight","Pin Light"],["hardmix","Hard Mix"],["reflect","Reflect"],["glow","Glow"],["phoenix","Phoenix"],["hue","Hue"],["saturation","Saturation"],["color","color"],["luminosity","Luminosity"],["darkercolor","Darker Color"],["lightercolor","Lighter Color"]],update:function(){updateDrawFunction()}}}}},{inPlace:function(){return!!nativeBlendModes[this.inputs.mode]},description:"Blend two layers",title:"Blend"})}),function(root,factory){"use strict";"function"==typeof define&&define.amd?define(["seriously"],factory):"object"==typeof exports?factory(require("seriously")):(root.Seriously||(root.Seriously={plugin:function(name,opt){this[name]=opt}}),factory(root.Seriously))}(this,function(Seriously){"use strict";Seriously.plugin("linear-transfer",{commonShader:!0,shader:function(inputs,shaderSource){return shaderSource.fragment=["precision mediump float;","varying vec2 vTexCoord;","uniform sampler2D source;","uniform vec4 slope;","uniform vec4 intercept;","const vec3 half3 = vec3(0.5);","void main(void) {","	vec4 pixel = texture2D(source, vTexCoord);","	gl_FragColor = pixel * slope + intercept;","}"].join("\n"),shaderSource},inPlace:!0,inputs:{source:{type:"image",uniform:"source"},slope:{type:"vector",dimensions:4,uniform:"slope",defaultValue:[1,1,1,1]},intercept:{type:"vector",uniform:"intercept",dimensions:4,defaultValue:[0,0,0,0]}},title:"Linear Transfer",description:"For each color channel: [slope] * [value] + [intercept]"})}),function(root,factory){"use strict";"function"==typeof define&&define.amd?define(["seriously"],factory):"object"==typeof exports?factory(require("seriously")):(root.Seriously||(root.Seriously={plugin:function(name,opt){this[name]=opt}}),factory(root.Seriously))}(this,function(Seriously){"use strict";var identity=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),intRegex=/\d+/;Seriously.plugin("layers",function(options){function update(){me.resize()}var count,i,inputs,me=this,topOpts={clear:!1};for("number"==typeof options&&options>=2?count=options:(count=options&&options.count||4,count=Math.max(2,count)),inputs={sizeMode:{type:"enum",defaultValue:"0",options:["union","intersection"],update:function(){this.resize()}}},i=0;count>i;i++)inputs.sizeMode.options.push(i.toString()),inputs.sizeMode.options.push("source"+i),inputs["source"+i]={type:"image",update:update},inputs["opacity"+i]={type:"number",defaultValue:1,min:0,max:1,updateSources:!0};return this.uniforms.layerResolution=[1,1],this.resize=function(){var width,height,i,n,source,a,mode=this.inputs.sizeMode;if("union"===mode)for(width=0,height=0,i=0;count>i;i++)source=this.inputs["source"+i],source&&(width=Math.max(width,source.width),height=Math.max(height,source.height));else if("intersection"===mode)for(width=1/0,height=1/0,i=0;count>i;i++)source=this.inputs["source"+i],source&&(width=Math.min(width,source.width),height=Math.min(height,source.height));else width=1,height=1,n=count-1,a=intRegex.exec(this.inputs.sizeMode),a&&(n=Math.min(parseInt(a[0],10),n)),source=this.inputs["source"+n],source&&(width=source.width,height=source.height);if(this.width!==width||this.height!==height)for(this.width=width,this.height=height,this.uniforms.resolution[0]=width,this.uniforms.resolution[1]=height,this.frameBuffer&&this.frameBuffer.resize(width,height),this.emit("resize"),this.setDirty(),i=0;i<this.targets.length;i++)this.targets[i].resize()},{initialize:function(initialize){var gl=this.gl;initialize(),topOpts.blendEquation=gl.FUNC_ADD,topOpts.srcRGB=gl.SRC_ALPHA,topOpts.dstRGB=gl.ONE_MINUS_SRC_ALPHA,topOpts.srcAlpha=gl.SRC_ALPHA,topOpts.dstAlpha=gl.DST_ALPHA},commonShader:!0,shader:function(inputs,shaderSource){return shaderSource.vertex=["precision mediump float;","attribute vec4 position;","attribute vec2 texCoord;","uniform vec2 resolution;","uniform vec2 layerResolution;","uniform mat4 transform;","varying vec2 vTexCoord;","void main(void) {","	vec4 screenPosition = vec4(position.xy * layerResolution / 2.0, position.z, position.w);","	screenPosition = transform * screenPosition;","	gl_Position.xy = screenPosition.xy * 2.0 / layerResolution;","	gl_Position.z = screenPosition.z * 2.0 / (layerResolution.x / layerResolution.y);","	gl_Position.xy *= layerResolution / resolution;","	gl_Position.w = screenPosition.w;","	vTexCoord = texCoord;","}\n"].join("\n"),shaderSource.fragment=["precision mediump float;","varying vec2 vTexCoord;","uniform sampler2D source;","uniform float opacity;","void main(void) {","	if (any(lessThan(vTexCoord, vec2(0.0))) || any(greaterThanEqual(vTexCoord, vec2(1.0)))) {","		gl_FragColor = vec4(0.0);","	} else {","		gl_FragColor = texture2D(source, vTexCoord);","		gl_FragColor *= opacity;","	}","}"].join("\n"),shaderSource},requires:function(sourceName,inputs){var a,index=count;return a=intRegex.exec(this.inputs.sizeMode),a&&(index=parseInt(a[0],10)),index>=count?!1:!(!inputs[sourceName]||!inputs["opacity"+index])},draw:function(shader,model,uniforms,frameBuffer,draw){var i,opacity,source,gl=this.gl;for(gl.viewport(0,0,this.width,this.height),gl.bindFramebuffer(gl.FRAMEBUFFER,frameBuffer),gl.clearColor(0,0,0,0),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),i=0;count>i;i++)source=this.inputs["source"+i],opacity=this.inputs["opacity"+i],source&&opacity&&(uniforms.opacity=opacity,uniforms.layerResolution[0]=source.width,uniforms.layerResolution[1]=source.height,uniforms.source=source,uniforms.transform=source.cumulativeMatrix||identity,draw(shader,model,uniforms,frameBuffer,null,topOpts))},inputs:inputs}},{inPlace:!0,description:"Multiple layers",title:"Layers"})}),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;"undefined"!=typeof window?n=window:"undefined"!=typeof global?n=global:"undefined"!=typeof self&&(n=self),n.html2canvas=e()}}(function(){var e;return function n(e,f,o){function d(t,l){if(!f[t]){if(!e[t]){var s="function"==typeof require&&require;if(!l&&s)return s(t,!0);if(i)return i(t,!0);var u=new Error("Cannot find module '"+t+"'");throw u.code="MODULE_NOT_FOUND",u}var a=f[t]={exports:{}};e[t][0].call(a.exports,function(n){var f=e[t][1][n];return d(f?f:n)},a,a.exports,n,e,f,o)}return f[t].exports}for(var i="function"==typeof require&&require,t=0;t<o.length;t++)d(o[t]);return d}({1:[function(n,f){(function(n,o){(function(){"use strict";function d(e){return"function"==typeof e||"object"==typeof e&&null!==e}function i(e){return"function"==typeof e}function t(e){return"object"==typeof e&&null!==e}function l(){}function s(){return function(){n.nextTick(c)}}function u(){var e=0,n=new P(c),f=document.createTextNode("");return n.observe(f,{characterData:!0}),function(){f.data=e=++e%2}}function a(){var e=new MessageChannel;return e.port1.onmessage=c,function(){e.port2.postMessage(0)}}function p(){return function(){setTimeout(c,1)}}function c(){for(var e=0;M>e;e+=2){var n=R[e],f=R[e+1];n(f),R[e]=void 0,R[e+1]=void 0}M=0}function y(){}function m(){return new TypeError("You cannot resolve a promise with itself")}function r(){return new TypeError("A promises callback cannot return that same promise.")}function v(e){try{return e.then}catch(n){return V.error=n,V}}function w(e,n,f,o){try{e.call(n,f,o)}catch(d){return d}}function b(e,n,f){N(function(e){var o=!1,d=w(f,n,function(f){o||(o=!0,n!==f?x(e,f):k(e,f))},function(n){o||(o=!0,q(e,n))},"Settle: "+(e._label||" unknown promise"));!o&&d&&(o=!0,q(e,d))},e)}function g(e,n){n._state===T?k(e,n._result):e._state===U?q(e,n._result):z(n,void 0,function(n){x(e,n)},function(n){q(e,n)})}function h(e,n){if(n.constructor===e.constructor)g(e,n);else{var f=v(n);f===V?q(e,V.error):void 0===f?k(e,n):i(f)?b(e,n,f):k(e,n)}}function x(e,n){e===n?q(e,m()):d(n)?h(e,n):k(e,n)}function j(e){e._onerror&&e._onerror(e._result),A(e)}function k(e,n){e._state===S&&(e._result=n,e._state=T,0===e._subscribers.length||N(A,e))}function q(e,n){e._state===S&&(e._state=U,e._result=n,N(j,e))}function z(e,n,f,o){var d=e._subscribers,i=d.length;e._onerror=null,d[i]=n,d[i+T]=f,d[i+U]=o,0===i&&e._state&&N(A,e)}function A(e){var n=e._subscribers,f=e._state;if(0!==n.length){for(var o,d,i=e._result,t=0;t<n.length;t+=3)o=n[t],d=n[t+f],o?D(f,o,d,i):d(i);e._subscribers.length=0}}function B(){this.error=null}function C(e,n){try{return e(n)}catch(f){return W.error=f,W}}function D(e,n,f,o){var d,t,l,s,u=i(f);if(u){if(d=C(f,o),d===W?(s=!0,t=d.error,d=null):l=!0,n===d)return void q(n,r())}else d=o,l=!0;n._state!==S||(u&&l?x(n,d):s?q(n,t):e===T?k(n,d):e===U&&q(n,d))}function E(e,n){try{n(function(n){x(e,n)},function(n){q(e,n)})}catch(f){q(e,f)}}function F(e,n,f,o){this._instanceConstructor=e,this.promise=new e(y,o),this._abortOnReject=f,this._validateInput(n)?(this._input=n,this.length=n.length,this._remaining=n.length,this._init(),0===this.length?k(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&k(this.promise,this._result))):q(this.promise,this._validationError())}function G(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function H(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function I(e){this._id=en++,this._state=void 0,this._result=void 0,this._subscribers=[],y!==e&&(i(e)||G(),this instanceof I||H(),E(this,e))}var J;J=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var K,L=J,M=(Date.now||function(){return(new Date).getTime()},Object.create||function(e){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof e)throw new TypeError("Argument must be an object");return l.prototype=e,new l},0),N=function(e,n){R[M]=e,R[M+1]=n,M+=2,2===M&&K()},O="undefined"!=typeof window?window:{},P=O.MutationObserver||O.WebKitMutationObserver,Q="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,R=new Array(1e3);K="undefined"!=typeof n&&"[object process]"==={}.toString.call(n)?s():P?u():Q?a():p();var S=void 0,T=1,U=2,V=new B,W=new B;F.prototype._validateInput=function(e){return L(e)},F.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},F.prototype._init=function(){this._result=new Array(this.length)};var X=F;F.prototype._enumerate=function(){for(var e=this.length,n=this.promise,f=this._input,o=0;n._state===S&&e>o;o++)this._eachEntry(f[o],o)},F.prototype._eachEntry=function(e,n){var f=this._instanceConstructor;t(e)?e.constructor===f&&e._state!==S?(e._onerror=null,this._settledAt(e._state,n,e._result)):this._willSettleAt(f.resolve(e),n):(this._remaining--,this._result[n]=this._makeResult(T,n,e))},F.prototype._settledAt=function(e,n,f){var o=this.promise;o._state===S&&(this._remaining--,this._abortOnReject&&e===U?q(o,f):this._result[n]=this._makeResult(e,n,f)),0===this._remaining&&k(o,this._result)},F.prototype._makeResult=function(e,n,f){return f},F.prototype._willSettleAt=function(e,n){var f=this;z(e,void 0,function(e){f._settledAt(T,n,e)},function(e){f._settledAt(U,n,e)})};var Y=function(e,n){return new X(this,e,!0,n).promise},Z=function(e,n){function f(e){x(i,e)}function o(e){q(i,e)}var d=this,i=new d(y,n);if(!L(e))return q(i,new TypeError("You must pass an array to race.")),i;for(var t=e.length,l=0;i._state===S&&t>l;l++)z(d.resolve(e[l]),void 0,f,o);return i},$=function(e,n){var f=this;if(e&&"object"==typeof e&&e.constructor===f)return e;var o=new f(y,n);return x(o,e),o},_=function(e,n){var f=this,o=new f(y,n);return q(o,e),o},en=0,nn=I;I.all=Y,I.race=Z,I.resolve=$,I.reject=_,I.prototype={constructor:I,then:function(e,n){var f=this,o=f._state;if(o===T&&!e||o===U&&!n)return this;var d=new this.constructor(y),i=f._result;if(o){var t=arguments[o-1];N(function(){D(o,d,t,i)})}else z(f,d,e,n);return d},"catch":function(e){return this.then(null,e)}};var fn=function(){var e;e="undefined"!=typeof o?o:"undefined"!=typeof window&&window.document?window:self;var n="Promise"in e&&"resolve"in e.Promise&&"reject"in e.Promise&&"all"in e.Promise&&"race"in e.Promise&&function(){var n;return new e.Promise(function(e){n=e}),i(n)}();n||(e.Promise=nn)},on={Promise:nn,polyfill:fn};"function"==typeof e&&e.amd?e(function(){return on}):"undefined"!=typeof f&&f.exports?f.exports=on:"undefined"!=typeof this&&(this.ES6Promise=on)}).call(this)}).call(this,n("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:2}],2:[function(e,n){function f(){if(!t){t=!0;for(var e,n=i.length;n;){e=i,i=[];for(var f=-1;++f<n;)e[f]();n=i.length}t=!1}}function o(){}var d=n.exports={},i=[],t=!1;d.nextTick=function(e){i.push(e),t||setTimeout(f,0)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.on=o,d.addListener=o,d.once=o,d.off=o,d.removeListener=o,d.removeAllListeners=o,d.emit=o,d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],3:[function(n,f,o){(function(n){!function(d){function i(e){throw RangeError(I[e])}function t(e,n){for(var f=e.length;f--;)e[f]=n(e[f]);return e}function l(e,n){return t(e.split(H),n).join(".")}function s(e){for(var n,f,o=[],d=0,i=e.length;i>d;)n=e.charCodeAt(d++),n>=55296&&56319>=n&&i>d?(f=e.charCodeAt(d++),56320==(64512&f)?o.push(((1023&n)<<10)+(1023&f)+65536):(o.push(n),d--)):o.push(n);return o}function u(e){return t(e,function(e){var n="";return e>65535&&(e-=65536,n+=L(e>>>10&1023|55296),e=56320|1023&e),n+=L(e)}).join("")}function a(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:k}function p(e,n){return e+22+75*(26>e)-((0!=n)<<5)}function c(e,n,f){var o=0;for(e=f?K(e/B):e>>1,e+=K(e/n);e>J*z>>1;o+=k)e=K(e/J);return K(o+(J+1)*e/(e+A))}function y(e){var n,f,o,d,t,l,s,p,y,m,r=[],v=e.length,w=0,b=D,g=C;for(f=e.lastIndexOf(E),0>f&&(f=0),o=0;f>o;++o)e.charCodeAt(o)>=128&&i("not-basic"),r.push(e.charCodeAt(o));for(d=f>0?f+1:0;v>d;){for(t=w,l=1,s=k;d>=v&&i("invalid-input"),p=a(e.charCodeAt(d++)),(p>=k||p>K((j-w)/l))&&i("overflow"),w+=p*l,y=g>=s?q:s>=g+z?z:s-g,!(y>p);s+=k)m=k-y,l>K(j/m)&&i("overflow"),l*=m;n=r.length+1,g=c(w-t,n,0==t),K(w/n)>j-b&&i("overflow"),b+=K(w/n),w%=n,r.splice(w++,0,b)}return u(r)}function m(e){var n,f,o,d,t,l,u,a,y,m,r,v,w,b,g,h=[];for(e=s(e),v=e.length,n=D,f=0,t=C,l=0;v>l;++l)r=e[l],128>r&&h.push(L(r));for(o=d=h.length,d&&h.push(E);v>o;){for(u=j,l=0;v>l;++l)r=e[l],r>=n&&u>r&&(u=r);for(w=o+1,u-n>K((j-f)/w)&&i("overflow"),f+=(u-n)*w,n=u,l=0;v>l;++l)if(r=e[l],n>r&&++f>j&&i("overflow"),r==n){for(a=f,y=k;m=t>=y?q:y>=t+z?z:y-t,!(m>a);y+=k)g=a-m,b=k-m,h.push(L(p(m+g%b,0))),a=K(g/b);h.push(L(p(a,0))),t=c(f,w,o==d),f=0,++o}++f,++n}return h.join("")}function r(e){return l(e,function(e){return F.test(e)?y(e.slice(4).toLowerCase()):e})}function v(e){return l(e,function(e){return G.test(e)?"xn--"+m(e):e})}var w="object"==typeof o&&o,b="object"==typeof f&&f&&f.exports==w&&f,g="object"==typeof n&&n;(g.global===g||g.window===g)&&(d=g);var h,x,j=2147483647,k=36,q=1,z=26,A=38,B=700,C=72,D=128,E="-",F=/^xn--/,G=/[^ -~]/,H=/\x2E|\u3002|\uFF0E|\uFF61/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},J=k-q,K=Math.floor,L=String.fromCharCode;if(h={version:"1.2.4",ucs2:{decode:s,encode:u},decode:y,encode:m,toASCII:v,toUnicode:r},"function"==typeof e&&"object"==typeof e.amd&&e.amd)e("punycode",function(){return h});else if(w&&!w.nodeType)if(b)b.exports=h;else for(x in h)h.hasOwnProperty(x)&&(w[x]=h[x]);else d.punycode=h}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,n){function f(e,n,f){for(var o=e.getElementsByTagName(f),d=n.getElementsByTagName(f),i=o.length,t=0;i>t;t++)d[t].value=o[t].value}function o(e,n,f){!e.defaultView||n===e.defaultView.pageXOffset&&f===e.defaultView.pageYOffset||e.defaultView.scrollTo(n,f)}function d(e){[].slice.call(e.querySelectorAll("canvas"),0).forEach(function(e){e.setAttribute(c,"canvas-"+y++)})}function i(e,n){[].slice.call(e.querySelectorAll("["+c+"]"),0).forEach(function(e){try{var f=n.querySelector("["+c+'="'+e.getAttribute(c)+'"]');f&&(f.width=e.width,f.height=e.height,f.getContext("2d").putImageData(e.getContext("2d").getImageData(0,0,e.width,e.height),0,0))}catch(o){a("Unable to copy canvas content from",e,o)}e.removeAttribute(c)})}function t(e){return[].slice.call(e.childNodes,0).filter(u).forEach(function(n){"SCRIPT"===n.tagName?e.removeChild(n):t(n)}),e}function l(){return document.documentMode&&document.documentMode<=9}function s(e,n){for(var f=3===e.nodeType?document.createTextNode(e.nodeValue):e.cloneNode(!1),o=e.firstChild;o;)(n===!0||1!==o.nodeType||"SCRIPT"!==o.nodeName)&&f.appendChild(s(o,n)),o=o.nextSibling;return f}function u(e){return e.nodeType===Node.ELEMENT_NODE}var a=e("./log"),p=e("./promise"),c="data-html2canvas-canvas-clone",y=0;n.exports=function(e,n,u,a,c,y,m){d(e);var r=l()?s(e.documentElement,c.javascriptEnabled):e.documentElement.cloneNode(!0),v=n.createElement("iframe");return v.className="html2canvas-container",v.style.visibility="hidden",v.style.position="fixed",v.style.left="-10000px",v.style.top="0px",v.style.border="0",v.width=u,v.height=a,v.scrolling="no",n.body.appendChild(v),new p(function(n){var d=v.contentWindow.document;f(e.documentElement,r,"textarea"),f(e.documentElement,r,"select"),v.contentWindow.onload=v.onload=function(){var f=setInterval(function(){d.body.childNodes.length>0&&(i(e,d),clearInterval(f),"view"===c.type&&v.contentWindow.scrollTo(y,m),n(v))},50)},d.open(),d.write("<!DOCTYPE html><html></html>"),o(e,y,m),d.replaceChild(c.javascriptEnabled===!0?d.adoptNode(r):t(d.adoptNode(r)),d.documentElement),d.close()})}},{"./log":15,"./promise":18}],5:[function(e,n){function f(e){this.r=0,this.g=0,this.b=0,this.a=null,this.fromArray(e)||this.namedColor(e)||this.rgb(e)||this.rgba(e)||this.hex6(e)||this.hex3(e)}f.prototype.darken=function(e){var n=1-e;return new f([Math.round(this.r*n),Math.round(this.g*n),Math.round(this.b*n),this.a])},f.prototype.isTransparent=function(){return 0===this.a},f.prototype.isBlack=function(){return 0===this.r&&0===this.g&&0===this.b},f.prototype.fromArray=function(e){return Array.isArray(e)&&(this.r=Math.min(e[0],255),this.g=Math.min(e[1],255),this.b=Math.min(e[2],255),e.length>3&&(this.a=e[3])),Array.isArray(e)};var o=/^#([a-f0-9]{3})$/i;f.prototype.hex3=function(e){var n=null;return null!==(n=e.match(o))&&(this.r=parseInt(n[1][0]+n[1][0],16),this.g=parseInt(n[1][1]+n[1][1],16),this.b=parseInt(n[1][2]+n[1][2],16)),null!==n};var d=/^#([a-f0-9]{6})$/i;f.prototype.hex6=function(e){var n=null;return null!==(n=e.match(d))&&(this.r=parseInt(n[1].substring(0,2),16),this.g=parseInt(n[1].substring(2,4),16),this.b=parseInt(n[1].substring(4,6),16)),null!==n};var i=/^rgb\((\d{1,3}) *, *(\d{1,3}) *, *(\d{1,3})\)$/;f.prototype.rgb=function(e){var n=null;return null!==(n=e.match(i))&&(this.r=Number(n[1]),this.g=Number(n[2]),this.b=Number(n[3])),null!==n};var t=/^rgba\((\d{1,3}) *, *(\d{1,3}) *, *(\d{1,3}) *, *(\d+\.?\d*)\)$/;f.prototype.rgba=function(e){var n=null;return null!==(n=e.match(t))&&(this.r=Number(n[1]),this.g=Number(n[2]),this.b=Number(n[3]),this.a=Number(n[4])),null!==n},f.prototype.toString=function(){return null!==this.a&&1!==this.a?"rgba("+[this.r,this.g,this.b,this.a].join(",")+")":"rgb("+[this.r,this.g,this.b].join(",")+")"},f.prototype.namedColor=function(e){var n=l[e.toLowerCase()];if(n)this.r=n[0],this.g=n[1],this.b=n[2];else if("transparent"===e.toLowerCase())return this.r=this.g=this.b=this.a=0,!0;return!!n},f.prototype.isColor=!0;var l={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};n.exports=f},{}],6:[function(e,n){function f(e,n){var f=j++;if(n=n||{},n.logging&&(window.html2canvas.logging=!0,window.html2canvas.start=Date.now()),n.async="undefined"==typeof n.async?!0:n.async,n.allowTaint="undefined"==typeof n.allowTaint?!1:n.allowTaint,n.removeContainer="undefined"==typeof n.removeContainer?!0:n.removeContainer,n.javascriptEnabled="undefined"==typeof n.javascriptEnabled?!1:n.javascriptEnabled,n.imageTimeout="undefined"==typeof n.imageTimeout?1e4:n.imageTimeout,n.renderer="function"==typeof n.renderer?n.renderer:c,n.strict=!!n.strict,"string"==typeof e){if("string"!=typeof n.proxy)return a.reject("Proxy must be used when rendering url");var i=null!=n.width?n.width:window.innerWidth,t=null!=n.height?n.height:window.innerHeight;return g(u(e),n.proxy,document,i,t,n).then(function(e){return d(e.contentWindow.document.documentElement,e,n,i,t)})}var l=(void 0===e?[document.documentElement]:e.length?e:[e])[0];return l.setAttribute(x+f,f),o(l.ownerDocument,n,l.ownerDocument.defaultView.innerWidth,l.ownerDocument.defaultView.innerHeight,f).then(function(e){return"function"==typeof n.onrendered&&(v("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas"),n.onrendered(e)),e})}function o(e,n,f,o,i){return b(e,e,f,o,n,e.defaultView.pageXOffset,e.defaultView.pageYOffset).then(function(t){v("Document cloned");var l=x+i,s="["+l+"='"+i+"']";e.querySelector(s).removeAttribute(l);var u=t.contentWindow,p=u.document.querySelector(s),c=a.resolve("function"==typeof n.onclone?n.onclone(u.document):!0);return c.then(function(){return d(p,t,n,f,o)})})}function d(e,n,f,o,d){var u=n.contentWindow,a=new p(u.document),c=new y(f,a),r=h(e),w="view"===f.type?o:l(u.document),b="view"===f.type?d:s(u.document),g=new f.renderer(w,b,c,f,document),x=new m(e,g,a,c,f);return x.ready.then(function(){v("Finished rendering");var o;return o="view"===f.type?t(g.canvas,{width:g.canvas.width,height:g.canvas.height,
top:0,left:0,x:0,y:0}):e===u.document.body||e===u.document.documentElement||null!=f.canvas?g.canvas:t(g.canvas,{width:null!=f.width?f.width:r.width,height:null!=f.height?f.height:r.height,top:r.top,left:r.left,x:u.pageXOffset,y:u.pageYOffset}),i(n,f),o})}function i(e,n){n.removeContainer&&(e.parentNode.removeChild(e),v("Cleaned up container"))}function t(e,n){var f=document.createElement("canvas"),o=Math.min(e.width-1,Math.max(0,n.left)),d=Math.min(e.width,Math.max(1,n.left+n.width)),i=Math.min(e.height-1,Math.max(0,n.top)),t=Math.min(e.height,Math.max(1,n.top+n.height));return f.width=n.width,f.height=n.height,v("Cropping canvas at:","left:",n.left,"top:",n.top,"width:",d-o,"height:",t-i),v("Resulting crop with width",n.width,"and height",n.height," with x",o,"and y",i),f.getContext("2d").drawImage(e,o,i,d-o,t-i,n.x,n.y,d-o,t-i),f}function l(e){return Math.max(Math.max(e.body.scrollWidth,e.documentElement.scrollWidth),Math.max(e.body.offsetWidth,e.documentElement.offsetWidth),Math.max(e.body.clientWidth,e.documentElement.clientWidth))}function s(e){return Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))}function u(e){var n=document.createElement("a");return n.href=e,n.href=n.href,n}var a=e("./promise"),p=e("./support"),c=e("./renderers/canvas"),y=e("./imageloader"),m=e("./nodeparser"),r=e("./nodecontainer"),v=e("./log"),w=e("./utils"),b=e("./clone"),g=e("./proxy").loadUrlDocument,h=w.getBounds,x="data-html2canvas-node",j=0;f.Promise=a,f.CanvasRenderer=c,f.NodeContainer=r,f.log=v,f.utils=w,n.exports="undefined"==typeof document||"function"!=typeof Object.create||"function"!=typeof document.createElement("canvas").getContext?function(){return a.reject("No canvas support")}:f},{"./clone":4,"./imageloader":13,"./log":15,"./nodecontainer":16,"./nodeparser":17,"./promise":18,"./proxy":19,"./renderers/canvas":23,"./support":25,"./utils":29}],7:[function(e,n){function f(e){if(this.src=e,d("DummyImageContainer for",e),!this.promise||!this.image){d("Initiating DummyImageContainer"),f.prototype.image=new Image;var n=this.image;f.prototype.promise=new o(function(e,f){n.onload=e,n.onerror=f,n.src=i(),n.complete===!0&&e(n)})}}var o=e("./promise"),d=e("./log"),i=e("./utils").smallImage;n.exports=f},{"./log":15,"./promise":18,"./utils":29}],8:[function(e,n){function f(e,n){var f,d,i=document.createElement("div"),t=document.createElement("img"),l=document.createElement("span"),s="Hidden Text";i.style.visibility="hidden",i.style.fontFamily=e,i.style.fontSize=n,i.style.margin=0,i.style.padding=0,document.body.appendChild(i),t.src=o(),t.width=1,t.height=1,t.style.margin=0,t.style.padding=0,t.style.verticalAlign="baseline",l.style.fontFamily=e,l.style.fontSize=n,l.style.margin=0,l.style.padding=0,l.appendChild(document.createTextNode(s)),i.appendChild(l),i.appendChild(t),f=t.offsetTop-l.offsetTop+1,i.removeChild(l),i.appendChild(document.createTextNode(s)),i.style.lineHeight="normal",t.style.verticalAlign="super",d=t.offsetTop-i.offsetTop+1,document.body.removeChild(i),this.baseline=f,this.lineWidth=1,this.middle=d}var o=e("./utils").smallImage;n.exports=f},{"./utils":29}],9:[function(e,n){function f(){this.data={}}var o=e("./font");f.prototype.getMetrics=function(e,n){return void 0===this.data[e+"-"+n]&&(this.data[e+"-"+n]=new o(e,n)),this.data[e+"-"+n]},n.exports=f},{"./font":8}],10:[function(e,n){function f(n,f,o){this.image=null,this.src=n;var t=this,l=i(n);this.promise=(f?new d(function(e){"about:blank"===n.contentWindow.document.URL||null==n.contentWindow.document.documentElement?n.contentWindow.onload=n.onload=function(){e(n)}:e(n)}):this.proxyLoad(o.proxy,l,o)).then(function(n){var f=e("./core");return f(n.contentWindow.document.documentElement,{type:"view",width:n.width,height:n.height,proxy:o.proxy,javascriptEnabled:o.javascriptEnabled,removeContainer:o.removeContainer,allowTaint:o.allowTaint,imageTimeout:o.imageTimeout/2})}).then(function(e){return t.image=e})}var o=e("./utils"),d=e("./promise"),i=o.getBounds,t=e("./proxy").loadUrlDocument;f.prototype.proxyLoad=function(e,n,f){var o=this.src;return t(o.src,e,o.ownerDocument,n.width,n.height,f)},n.exports=f},{"./core":6,"./promise":18,"./proxy":19,"./utils":29}],11:[function(e,n){function f(e){this.src=e.value,this.colorStops=[],this.type=null,this.x0=.5,this.y0=.5,this.x1=.5,this.y1=.5,this.promise=o.resolve(!0)}var o=e("./promise");f.prototype.TYPES={LINEAR:1,RADIAL:2},n.exports=f},{"./promise":18}],12:[function(e,n){function f(e,n){this.src=e,this.image=new Image;var f=this;this.tainted=null,this.promise=new o(function(o,d){f.image.onload=o,f.image.onerror=d,n&&(f.image.crossOrigin="anonymous"),f.image.src=e,f.image.complete===!0&&o(f.image)})}var o=e("./promise");n.exports=f},{"./promise":18}],13:[function(e,n){function f(e,n){this.link=null,this.options=e,this.support=n,this.origin=this.getOrigin(window.location.href)}var o=e("./promise"),d=e("./log"),i=e("./imagecontainer"),t=e("./dummyimagecontainer"),l=e("./proxyimagecontainer"),s=e("./framecontainer"),u=e("./svgcontainer"),a=e("./svgnodecontainer"),p=e("./lineargradientcontainer"),c=e("./webkitgradientcontainer"),y=e("./utils").bind;f.prototype.findImages=function(e){var n=[];return e.reduce(function(e,n){switch(n.node.nodeName){case"IMG":return e.concat([{args:[n.node.src],method:"url"}]);case"svg":case"IFRAME":return e.concat([{args:[n.node],method:n.node.nodeName}])}return e},[]).forEach(this.addImage(n,this.loadImage),this),n},f.prototype.findBackgroundImage=function(e,n){return n.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(e,this.loadImage),this),e},f.prototype.addImage=function(e,n){return function(f){f.args.forEach(function(o){this.imageExists(e,o)||(e.splice(0,0,n.call(this,f)),d("Added image #"+e.length,"string"==typeof o?o.substring(0,100):o))},this)}},f.prototype.hasImageBackground=function(e){return"none"!==e.method},f.prototype.loadImage=function(e){if("url"===e.method){var n=e.args[0];return!this.isSVG(n)||this.support.svg||this.options.allowTaint?n.match(/data:image\/.*;base64,/i)?new i(n.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),!1):this.isSameOrigin(n)||this.options.allowTaint===!0||this.isSVG(n)?new i(n,!1):this.support.cors&&!this.options.allowTaint&&this.options.useCORS?new i(n,!0):this.options.proxy?new l(n,this.options.proxy):new t(n):new u(n)}return"linear-gradient"===e.method?new p(e):"gradient"===e.method?new c(e):"svg"===e.method?new a(e.args[0],this.support.svg):"IFRAME"===e.method?new s(e.args[0],this.isSameOrigin(e.args[0].src),this.options):new t(e)},f.prototype.isSVG=function(e){return"svg"===e.substring(e.length-3).toLowerCase()||u.prototype.isInline(e)},f.prototype.imageExists=function(e,n){return e.some(function(e){return e.src===n})},f.prototype.isSameOrigin=function(e){return this.getOrigin(e)===this.origin},f.prototype.getOrigin=function(e){var n=this.link||(this.link=document.createElement("a"));return n.href=e,n.href=n.href,n.protocol+n.hostname+n.port},f.prototype.getPromise=function(e){return this.timeout(e,this.options.imageTimeout)["catch"](function(){var n=new t(e.src);return n.promise.then(function(n){e.image=n})})},f.prototype.get=function(e){var n=null;return this.images.some(function(f){return(n=f).src===e})?n:null},f.prototype.fetch=function(e){return this.images=e.reduce(y(this.findBackgroundImage,this),this.findImages(e)),this.images.forEach(function(e,n){e.promise.then(function(){d("Succesfully loaded image #"+(n+1),e)},function(f){d("Failed loading image #"+(n+1),e,f)})}),this.ready=o.all(this.images.map(this.getPromise,this)),d("Finished searching images"),this},f.prototype.timeout=function(e,n){var f,i=o.race([e.promise,new o(function(o,i){f=setTimeout(function(){d("Timed out loading image",e),i(e)},n)})]).then(function(e){return clearTimeout(f),e});return i["catch"](function(){clearTimeout(f)}),i},n.exports=f},{"./dummyimagecontainer":7,"./framecontainer":10,"./imagecontainer":12,"./lineargradientcontainer":14,"./log":15,"./promise":18,"./proxyimagecontainer":20,"./svgcontainer":26,"./svgnodecontainer":27,"./utils":29,"./webkitgradientcontainer":30}],14:[function(e,n){function f(e){o.apply(this,arguments),this.type=this.TYPES.LINEAR;var n=null===e.args[0].match(this.stepRegExp);n?e.args[0].split(" ").reverse().forEach(function(e){switch(e){case"left":this.x0=0,this.x1=1;break;case"top":this.y0=0,this.y1=1;break;case"right":this.x0=1,this.x1=0;break;case"bottom":this.y0=1,this.y1=0;break;case"to":var n=this.y0,f=this.x0;this.y0=this.y1,this.x0=this.x1,this.x1=f,this.y1=n}},this):(this.y0=0,this.y1=1),this.colorStops=e.args.slice(n?1:0).map(function(e){var n=e.match(this.stepRegExp);return{color:new d(n[1]),stop:"%"===n[3]?n[2]/100:null}},this),null===this.colorStops[0].stop&&(this.colorStops[0].stop=0),null===this.colorStops[this.colorStops.length-1].stop&&(this.colorStops[this.colorStops.length-1].stop=1),this.colorStops.forEach(function(e,n){null===e.stop&&this.colorStops.slice(n).some(function(f,o){return null!==f.stop?(e.stop=(f.stop-this.colorStops[n-1].stop)/(o+1)+this.colorStops[n-1].stop,!0):!1},this)},this)}var o=e("./gradientcontainer"),d=e("./color");f.prototype=Object.create(o.prototype),f.prototype.stepRegExp=/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/,n.exports=f},{"./color":5,"./gradientcontainer":11}],15:[function(e,n){n.exports=function(){window.html2canvas.logging&&window.console&&window.console.log&&Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-window.html2canvas.start+"ms","html2canvas:"].concat([].slice.call(arguments,0)))}},{}],16:[function(e,n){function f(e,n){this.node=e,this.parent=n,this.stack=null,this.bounds=null,this.borders=null,this.clip=[],this.backgroundClip=[],this.offsetBounds=null,this.visible=null,this.computedStyles=null,this.colors={},this.styles={},this.backgroundImages=null,this.transformData=null,this.transformMatrix=null,this.isPseudoElement=!1,this.opacity=null}function o(e){var n=e.options[e.selectedIndex||0];return n?n.text||"":""}function d(e){return e&&"matrix"===e[1]?e[2].split(",").map(function(e){return parseFloat(e.trim())}):void 0}function i(e){return-1!==e.toString().indexOf("%")}function t(e){return e.replace("px","")}function l(e){return parseFloat(e)}var s=e("./color"),u=e("./utils"),a=u.getBounds,p=u.parseBackgrounds,c=u.offsetBounds;f.prototype.cloneTo=function(e){e.visible=this.visible,e.borders=this.borders,e.bounds=this.bounds,e.clip=this.clip,e.backgroundClip=this.backgroundClip,e.computedStyles=this.computedStyles,e.styles=this.styles,e.backgroundImages=this.backgroundImages,e.opacity=this.opacity},f.prototype.getOpacity=function(){return null===this.opacity?this.opacity=this.cssFloat("opacity"):this.opacity},f.prototype.assignStack=function(e){this.stack=e,e.children.push(this)},f.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:"none"!==this.css("display")&&"hidden"!==this.css("visibility")&&!this.node.hasAttribute("data-html2canvas-ignore")&&("INPUT"!==this.node.nodeName||"hidden"!==this.node.getAttribute("type"))},f.prototype.css=function(e){return this.computedStyles||(this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?":before":":after"):this.computedStyle(null)),this.styles[e]||(this.styles[e]=this.computedStyles[e])},f.prototype.prefixedCss=function(e){var n=["webkit","moz","ms","o"],f=this.css(e);return void 0===f&&n.some(function(n){return f=this.css(n+e.substr(0,1).toUpperCase()+e.substr(1)),void 0!==f},this),void 0===f?null:f},f.prototype.computedStyle=function(e){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,e)},f.prototype.cssInt=function(e){var n=parseInt(this.css(e),10);return isNaN(n)?0:n},f.prototype.color=function(e){return this.colors[e]||(this.colors[e]=new s(this.css(e)))},f.prototype.cssFloat=function(e){var n=parseFloat(this.css(e));return isNaN(n)?0:n},f.prototype.fontWeight=function(){var e=this.css("fontWeight");switch(parseInt(e,10)){case 401:e="bold";break;case 400:e="normal"}return e},f.prototype.parseClip=function(){var e=this.css("clip").match(this.CLIP);return e?{top:parseInt(e[1],10),right:parseInt(e[2],10),bottom:parseInt(e[3],10),left:parseInt(e[4],10)}:null},f.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=p(this.css("backgroundImage")))},f.prototype.cssList=function(e,n){var f=(this.css(e)||"").split(",");return f=f[n||0]||f[0]||"auto",f=f.trim().split(" "),1===f.length&&(f=[f[0],i(f[0])?"auto":f[0]]),f},f.prototype.parseBackgroundSize=function(e,n,f){var o,d,t=this.cssList("backgroundSize",f);if(i(t[0]))o=e.width*parseFloat(t[0])/100;else{if(/contain|cover/.test(t[0])){var l=e.width/e.height,s=n.width/n.height;return s>l^"contain"===t[0]?{width:e.height*s,height:e.height}:{width:e.width,height:e.width/s}}o=parseInt(t[0],10)}return d="auto"===t[0]&&"auto"===t[1]?n.height:"auto"===t[1]?o/n.width*n.height:i(t[1])?e.height*parseFloat(t[1])/100:parseInt(t[1],10),"auto"===t[0]&&(o=d/n.height*n.width),{width:o,height:d}},f.prototype.parseBackgroundPosition=function(e,n,f,o){var d,t,l=this.cssList("backgroundPosition",f);return d=i(l[0])?(e.width-(o||n).width)*(parseFloat(l[0])/100):parseInt(l[0],10),t="auto"===l[1]?d/n.width*n.height:i(l[1])?(e.height-(o||n).height)*parseFloat(l[1])/100:parseInt(l[1],10),"auto"===l[0]&&(d=t/n.height*n.width),{left:d,top:t}},f.prototype.parseBackgroundRepeat=function(e){return this.cssList("backgroundRepeat",e)[0]},f.prototype.parseTextShadows=function(){var e=this.css("textShadow"),n=[];if(e&&"none"!==e)for(var f=e.match(this.TEXT_SHADOW_PROPERTY),o=0;f&&o<f.length;o++){var d=f[o].match(this.TEXT_SHADOW_VALUES);n.push({color:new s(d[0]),offsetX:d[1]?parseFloat(d[1].replace("px","")):0,offsetY:d[2]?parseFloat(d[2].replace("px","")):0,blur:d[3]?d[3].replace("px",""):0})}return n},f.prototype.parseTransform=function(){if(!this.transformData)if(this.hasTransform()){var e=this.parseBounds(),n=this.prefixedCss("transformOrigin").split(" ").map(t).map(l);n[0]+=e.left,n[1]+=e.top,this.transformData={origin:n,matrix:this.parseTransformMatrix()}}else this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]};return this.transformData},f.prototype.parseTransformMatrix=function(){if(!this.transformMatrix){var e=this.prefixedCss("transform"),n=e?d(e.match(this.MATRIX_PROPERTY)):null;this.transformMatrix=n?n:[1,0,0,1,0,0]}return this.transformMatrix},f.prototype.parseBounds=function(){return this.bounds||(this.bounds=this.hasTransform()?c(this.node):a(this.node))},f.prototype.hasTransform=function(){return"1,0,0,1,0,0"!==this.parseTransformMatrix().join(",")||this.parent&&this.parent.hasTransform()},f.prototype.getValue=function(){var e=this.node.value||"";return"SELECT"===this.node.tagName?e=o(this.node):"password"===this.node.type&&(e=Array(e.length+1).join("•")),0===e.length?this.node.placeholder||"":e},f.prototype.MATRIX_PROPERTY=/(matrix)\((.+)\)/,f.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,f.prototype.TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g,f.prototype.CLIP=/^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/,n.exports=f},{"./color":5,"./utils":29}],17:[function(e,n){function f(e,n,f,o,d){N("Starting NodeParser"),this.renderer=n,this.options=d,this.range=null,this.support=f,this.renderQueue=[],this.stack=new V(!0,1,e.ownerDocument,null);var i=new P(e,null);if(d.background&&n.rectangle(0,0,n.width,n.height,new T(d.background)),e===e.ownerDocument.documentElement){var t=new P(i.color("backgroundColor").isTransparent()?e.ownerDocument.body:e.ownerDocument.documentElement,null);n.rectangle(0,0,n.width,n.height,t.color("backgroundColor"))}i.visibile=i.isElementVisible(),this.createPseudoHideStyles(e.ownerDocument),this.disableAnimations(e.ownerDocument),this.nodes=I([i].concat(this.getChildren(i)).filter(function(e){return e.visible=e.isElementVisible()}).map(this.getPseudoElements,this)),this.fontMetrics=new S,N("Fetched nodes, total:",this.nodes.length),N("Calculate overflow clips"),this.calculateOverflowClips(),N("Start fetching images"),this.images=o.fetch(this.nodes.filter(A)),this.ready=this.images.ready.then(X(function(){return N("Images loaded, starting parsing"),N("Creating stacking contexts"),this.createStackingContexts(),N("Sorting stacking contexts"),this.sortStackingContexts(this.stack),this.parse(this.stack),N("Render queue created with "+this.renderQueue.length+" items"),new U(X(function(e){d.async?"function"==typeof d.async?d.async.call(this,this.renderQueue,e):this.renderQueue.length>0?(this.renderIndex=0,this.asyncRenderer(this.renderQueue,e)):e():(this.renderQueue.forEach(this.paint,this),e())},this))},this))}function o(e){return e.parent&&e.parent.clip.length}function d(e){return e.replace(/(\-[a-z])/g,function(e){return e.toUpperCase().replace("-","")})}function i(){}function t(e,n,f,o){return e.map(function(d,i){if(d.width>0){var t=n.left,l=n.top,s=n.width,u=n.height-e[2].width;switch(i){case 0:u=e[0].width,d.args=a({c1:[t,l],c2:[t+s,l],c3:[t+s-e[1].width,l+u],c4:[t+e[3].width,l+u]},o[0],o[1],f.topLeftOuter,f.topLeftInner,f.topRightOuter,f.topRightInner);break;case 1:t=n.left+n.width-e[1].width,s=e[1].width,d.args=a({c1:[t+s,l],c2:[t+s,l+u+e[2].width],c3:[t,l+u],c4:[t,l+e[0].width]},o[1],o[2],f.topRightOuter,f.topRightInner,f.bottomRightOuter,f.bottomRightInner);break;case 2:l=l+n.height-e[2].width,u=e[2].width,d.args=a({c1:[t+s,l+u],c2:[t,l+u],c3:[t+e[3].width,l],c4:[t+s-e[3].width,l]},o[2],o[3],f.bottomRightOuter,f.bottomRightInner,f.bottomLeftOuter,f.bottomLeftInner);break;case 3:s=e[3].width,d.args=a({c1:[t,l+u+e[2].width],c2:[t,l],c3:[t+s,l+e[0].width],c4:[t+s,l+u]},o[3],o[0],f.bottomLeftOuter,f.bottomLeftInner,f.topLeftOuter,f.topLeftInner)}}return d})}function l(e,n,f,o){var d=4*((Math.sqrt(2)-1)/3),i=f*d,t=o*d,l=e+f,s=n+o;return{topLeft:u({x:e,y:s},{x:e,y:s-t},{x:l-i,y:n},{x:l,y:n}),topRight:u({x:e,y:n},{x:e+i,y:n},{x:l,y:s-t},{x:l,y:s}),bottomRight:u({x:l,y:n},{x:l,y:n+t},{x:e+i,y:s},{x:e,y:s}),bottomLeft:u({x:l,y:s},{x:l-i,y:s},{x:e,y:n+t},{x:e,y:n})}}function s(e,n,f){var o=e.left,d=e.top,i=e.width,t=e.height,s=n[0][0],u=n[0][1],a=n[1][0],p=n[1][1],c=n[2][0],y=n[2][1],m=n[3][0],r=n[3][1],v=i-a,w=t-y,b=i-c,g=t-r;return{topLeftOuter:l(o,d,s,u).topLeft.subdivide(.5),topLeftInner:l(o+f[3].width,d+f[0].width,Math.max(0,s-f[3].width),Math.max(0,u-f[0].width)).topLeft.subdivide(.5),topRightOuter:l(o+v,d,a,p).topRight.subdivide(.5),topRightInner:l(o+Math.min(v,i+f[3].width),d+f[0].width,v>i+f[3].width?0:a-f[3].width,p-f[0].width).topRight.subdivide(.5),bottomRightOuter:l(o+b,d+w,c,y).bottomRight.subdivide(.5),bottomRightInner:l(o+Math.min(b,i-f[3].width),d+Math.min(w,t+f[0].width),Math.max(0,c-f[1].width),y-f[2].width).bottomRight.subdivide(.5),bottomLeftOuter:l(o,d+g,m,r).bottomLeft.subdivide(.5),bottomLeftInner:l(o+f[3].width,d+g,Math.max(0,m-f[3].width),r-f[2].width).bottomLeft.subdivide(.5)}}function u(e,n,f,o){var d=function(e,n,f){return{x:e.x+(n.x-e.x)*f,y:e.y+(n.y-e.y)*f}};return{start:e,startControl:n,endControl:f,end:o,subdivide:function(i){var t=d(e,n,i),l=d(n,f,i),s=d(f,o,i),a=d(t,l,i),p=d(l,s,i),c=d(a,p,i);return[u(e,t,a,c),u(c,p,s,o)]},curveTo:function(e){e.push(["bezierCurve",n.x,n.y,f.x,f.y,o.x,o.y])},curveToReversed:function(o){o.push(["bezierCurve",f.x,f.y,n.x,n.y,e.x,e.y])}}}function a(e,n,f,o,d,i,t){var l=[];return n[0]>0||n[1]>0?(l.push(["line",o[1].start.x,o[1].start.y]),o[1].curveTo(l)):l.push(["line",e.c1[0],e.c1[1]]),f[0]>0||f[1]>0?(l.push(["line",i[0].start.x,i[0].start.y]),i[0].curveTo(l),l.push(["line",t[0].end.x,t[0].end.y]),t[0].curveToReversed(l)):(l.push(["line",e.c2[0],e.c2[1]]),l.push(["line",e.c3[0],e.c3[1]])),n[0]>0||n[1]>0?(l.push(["line",d[1].end.x,d[1].end.y]),d[1].curveToReversed(l)):l.push(["line",e.c4[0],e.c4[1]]),l}function p(e,n,f,o,d,i,t){n[0]>0||n[1]>0?(e.push(["line",o[0].start.x,o[0].start.y]),o[0].curveTo(e),o[1].curveTo(e)):e.push(["line",i,t]),(f[0]>0||f[1]>0)&&e.push(["line",d[0].start.x,d[0].start.y])}function c(e){return e.cssInt("zIndex")<0}function y(e){return e.cssInt("zIndex")>0}function m(e){return 0===e.cssInt("zIndex")}function r(e){return-1!==["inline","inline-block","inline-table"].indexOf(e.css("display"))}function v(e){return e instanceof V}function w(e){return e.node.data.trim().length>0}function b(e){return/^(normal|none|0px)$/.test(e.parent.css("letterSpacing"))}function g(e){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(n){var f=e.css("border"+n+"Radius"),o=f.split(" ");return o.length<=1&&(o[1]=o[0]),o.map(F)})}function h(e){return e.nodeType===Node.TEXT_NODE||e.nodeType===Node.ELEMENT_NODE}function x(e){var n=e.css("position"),f=-1!==["absolute","relative","fixed"].indexOf(n)?e.css("zIndex"):"auto";return"auto"!==f}function j(e){return"static"!==e.css("position")}function k(e){return"none"!==e.css("float")}function q(e){return-1!==["inline-block","inline-table"].indexOf(e.css("display"))}function z(e){var n=this;return function(){return!e.apply(n,arguments)}}function A(e){return e.node.nodeType===Node.ELEMENT_NODE}function B(e){return e.isPseudoElement===!0}function C(e){return e.node.nodeType===Node.TEXT_NODE}function D(e){return function(n,f){return n.cssInt("zIndex")+e.indexOf(n)/e.length-(f.cssInt("zIndex")+e.indexOf(f)/e.length)}}function E(e){return e.getOpacity()<1}function F(e){return parseInt(e,10)}function G(e){return e.width}function H(e){return e.node.nodeType!==Node.ELEMENT_NODE||-1===["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"].indexOf(e.node.nodeName)}function I(e){return[].concat.apply([],e)}function J(e){var n=e.substr(0,1);return n===e.substr(e.length-1)&&n.match(/'|"/)?e.substr(1,e.length-2):e}function K(e){for(var n,f=[],o=0,d=!1;e.length;)L(e[o])===d?(n=e.splice(0,o),n.length&&f.push(O.ucs2.encode(n)),d=!d,o=0):o++,o>=e.length&&(n=e.splice(0,o),n.length&&f.push(O.ucs2.encode(n)));return f}function L(e){return-1!==[32,13,10,9,45].indexOf(e)}function M(e){return/[^\u0000-\u00ff]/.test(e)}var N=e("./log"),O=e("punycode"),P=e("./nodecontainer"),Q=e("./textcontainer"),R=e("./pseudoelementcontainer"),S=e("./fontmetrics"),T=e("./color"),U=e("./promise"),V=e("./stackingcontext"),W=e("./utils"),X=W.bind,Y=W.getBounds,Z=W.parseBackgrounds,$=W.offsetBounds;f.prototype.calculateOverflowClips=function(){this.nodes.forEach(function(e){if(A(e)){B(e)&&e.appendToDOM(),e.borders=this.parseBorders(e);var n="hidden"===e.css("overflow")?[e.borders.clip]:[],f=e.parseClip();f&&-1!==["absolute","fixed"].indexOf(e.css("position"))&&n.push([["rect",e.bounds.left+f.left,e.bounds.top+f.top,f.right-f.left,f.bottom-f.top]]),e.clip=o(e)?e.parent.clip.concat(n):n,e.backgroundClip="hidden"!==e.css("overflow")?e.clip.concat([e.borders.clip]):e.clip,B(e)&&e.cleanDOM()}else C(e)&&(e.clip=o(e)?e.parent.clip:[]);B(e)||(e.bounds=null)},this)},f.prototype.asyncRenderer=function(e,n,f){f=f||Date.now(),this.paint(e[this.renderIndex++]),e.length===this.renderIndex?n():f+20>Date.now()?this.asyncRenderer(e,n,f):setTimeout(X(function(){this.asyncRenderer(e,n)},this),0)},f.prototype.createPseudoHideStyles=function(e){this.createStyles(e,"."+R.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: "" !important; display: none !important; }.'+R.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: "" !important; display: none !important; }')},f.prototype.disableAnimations=function(e){this.createStyles(e,"* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; -webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}")},f.prototype.createStyles=function(e,n){var f=e.createElement("style");f.innerHTML=n,e.body.appendChild(f)},f.prototype.getPseudoElements=function(e){var n=[[e]];if(e.node.nodeType===Node.ELEMENT_NODE){var f=this.getPseudoElement(e,":before"),o=this.getPseudoElement(e,":after");f&&n.push(f),o&&n.push(o)}return I(n)},f.prototype.getPseudoElement=function(e,n){var f=e.computedStyle(n);if(!f||!f.content||"none"===f.content||"-moz-alt-content"===f.content||"none"===f.display)return null;for(var o=J(f.content),i="url"===o.substr(0,3),t=document.createElement(i?"img":"html2canvaspseudoelement"),l=new R(t,e,n),s=f.length-1;s>=0;s--){var u=d(f.item(s));t.style[u]=f[u]}if(t.className=R.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+R.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER,i)return t.src=Z(o)[0].args[0],[l];var a=document.createTextNode(o);return t.appendChild(a),[l,new Q(a,l)]},f.prototype.getChildren=function(e){return I([].filter.call(e.node.childNodes,h).map(function(n){var f=[n.nodeType===Node.TEXT_NODE?new Q(n,e):new P(n,e)].filter(H);return n.nodeType===Node.ELEMENT_NODE&&f.length&&"TEXTAREA"!==n.tagName?f[0].isElementVisible()?f.concat(this.getChildren(f[0])):[]:f},this))},f.prototype.newStackingContext=function(e,n){var f=new V(n,e.getOpacity(),e.node,e.parent);e.cloneTo(f);var o=n?f.getParentStack(this):f.parent.stack;o.contexts.push(f),e.stack=f},f.prototype.createStackingContexts=function(){this.nodes.forEach(function(e){A(e)&&(this.isRootElement(e)||E(e)||x(e)||this.isBodyWithTransparentRoot(e)||e.hasTransform())?this.newStackingContext(e,!0):A(e)&&(j(e)&&m(e)||q(e)||k(e))?this.newStackingContext(e,!1):e.assignStack(e.parent.stack)},this)},f.prototype.isBodyWithTransparentRoot=function(e){return"BODY"===e.node.nodeName&&e.parent.color("backgroundColor").isTransparent()},f.prototype.isRootElement=function(e){return null===e.parent},f.prototype.sortStackingContexts=function(e){e.contexts.sort(D(e.contexts.slice(0))),e.contexts.forEach(this.sortStackingContexts,this)},f.prototype.parseTextBounds=function(e){return function(n,f,o){if("none"!==e.parent.css("textDecoration").substr(0,4)||0!==n.trim().length){if(this.support.rangeBounds&&!e.parent.hasTransform()){var d=o.slice(0,f).join("").length;return this.getRangeBounds(e.node,d,n.length)}if(e.node&&"string"==typeof e.node.data){var i=e.node.splitText(n.length),t=this.getWrapperBounds(e.node,e.parent.hasTransform());return e.node=i,t}}else(!this.support.rangeBounds||e.parent.hasTransform())&&(e.node=e.node.splitText(n.length));return{}}},f.prototype.getWrapperBounds=function(e,n){var f=e.ownerDocument.createElement("html2canvaswrapper"),o=e.parentNode,d=e.cloneNode(!0);f.appendChild(e.cloneNode(!0)),o.replaceChild(f,e);var i=n?$(f):Y(f);return o.replaceChild(d,f),i},f.prototype.getRangeBounds=function(e,n,f){var o=this.range||(this.range=e.ownerDocument.createRange());return o.setStart(e,n),o.setEnd(e,n+f),o.getBoundingClientRect()},f.prototype.parse=function(e){var n=e.contexts.filter(c),f=e.children.filter(A),o=f.filter(z(k)),d=o.filter(z(j)).filter(z(r)),t=f.filter(z(j)).filter(k),l=o.filter(z(j)).filter(r),s=e.contexts.concat(o.filter(j)).filter(m),u=e.children.filter(C).filter(w),a=e.contexts.filter(y);n.concat(d).concat(t).concat(l).concat(s).concat(u).concat(a).forEach(function(e){this.renderQueue.push(e),v(e)&&(this.parse(e),this.renderQueue.push(new i))},this)},f.prototype.paint=function(e){try{e instanceof i?this.renderer.ctx.restore():C(e)?(B(e.parent)&&e.parent.appendToDOM(),this.paintText(e),B(e.parent)&&e.parent.cleanDOM()):this.paintNode(e)}catch(n){if(N(n),this.options.strict)throw n}},f.prototype.paintNode=function(e){v(e)&&(this.renderer.setOpacity(e.opacity),this.renderer.ctx.save(),e.hasTransform()&&this.renderer.setTransform(e.parseTransform())),"INPUT"===e.node.nodeName&&"checkbox"===e.node.type?this.paintCheckbox(e):"INPUT"===e.node.nodeName&&"radio"===e.node.type?this.paintRadio(e):this.paintElement(e)},f.prototype.paintElement=function(e){var n=e.parseBounds();this.renderer.clip(e.backgroundClip,function(){this.renderer.renderBackground(e,n,e.borders.borders.map(G))},this),this.renderer.clip(e.clip,function(){this.renderer.renderBorders(e.borders.borders)},this),this.renderer.clip(e.backgroundClip,function(){switch(e.node.nodeName){case"svg":case"IFRAME":var f=this.images.get(e.node);f?this.renderer.renderImage(e,n,e.borders,f):N("Error loading <"+e.node.nodeName+">",e.node);break;case"IMG":var o=this.images.get(e.node.src);o?this.renderer.renderImage(e,n,e.borders,o):N("Error loading <img>",e.node.src);break;case"CANVAS":this.renderer.renderImage(e,n,e.borders,{image:e.node});break;case"SELECT":case"INPUT":case"TEXTAREA":this.paintFormValue(e)}},this)},f.prototype.paintCheckbox=function(e){var n=e.parseBounds(),f=Math.min(n.width,n.height),o={width:f-1,height:f-1,top:n.top,left:n.left},d=[3,3],i=[d,d,d,d],l=[1,1,1,1].map(function(e){return{color:new T("#A5A5A5"),width:e}}),u=s(o,i,l);this.renderer.clip(e.backgroundClip,function(){this.renderer.rectangle(o.left+1,o.top+1,o.width-2,o.height-2,new T("#DEDEDE")),this.renderer.renderBorders(t(l,o,u,i)),e.node.checked&&(this.renderer.font(new T("#424242"),"normal","normal","bold",f-3+"px","arial"),this.renderer.text("✔",o.left+f/6,o.top+f-1))},this)},f.prototype.paintRadio=function(e){var n=e.parseBounds(),f=Math.min(n.width,n.height)-2;this.renderer.clip(e.backgroundClip,function(){this.renderer.circleStroke(n.left+1,n.top+1,f,new T("#DEDEDE"),1,new T("#A5A5A5")),e.node.checked&&this.renderer.circle(Math.ceil(n.left+f/4)+1,Math.ceil(n.top+f/4)+1,Math.floor(f/2),new T("#424242"))},this)},f.prototype.paintFormValue=function(e){var n=e.getValue();if(n.length>0){var f=e.node.ownerDocument,o=f.createElement("html2canvaswrapper"),d=["lineHeight","textAlign","fontFamily","fontWeight","fontSize","color","paddingLeft","paddingTop","paddingRight","paddingBottom","width","height","borderLeftStyle","borderTopStyle","borderLeftWidth","borderTopWidth","boxSizing","whiteSpace","wordWrap"];d.forEach(function(n){try{o.style[n]=e.css(n)}catch(f){N("html2canvas: Parse: Exception caught in renderFormValue: "+f.message)}});var i=e.parseBounds();o.style.position="fixed",o.style.left=i.left+"px",o.style.top=i.top+"px",o.textContent=n,f.body.appendChild(o),this.paintText(new Q(o.firstChild,e)),f.body.removeChild(o)}},f.prototype.paintText=function(e){e.applyTextTransform();var n=O.ucs2.decode(e.node.data),f=this.options.letterRendering&&!b(e)||M(e.node.data)?n.map(function(e){return O.ucs2.encode([e])}):K(n),o=e.parent.fontWeight(),d=e.parent.css("fontSize"),i=e.parent.css("fontFamily"),t=e.parent.parseTextShadows();this.renderer.font(e.parent.color("color"),e.parent.css("fontStyle"),e.parent.css("fontVariant"),o,d,i),t.length?this.renderer.fontShadow(t[0].color,t[0].offsetX,t[0].offsetY,t[0].blur):this.renderer.clearShadow(),this.renderer.clip(e.parent.clip,function(){f.map(this.parseTextBounds(e),this).forEach(function(n,o){n&&(this.renderer.text(f[o],n.left,n.bottom),this.renderTextDecoration(e.parent,n,this.fontMetrics.getMetrics(i,d)))},this)},this)},f.prototype.renderTextDecoration=function(e,n,f){switch(e.css("textDecoration").split(" ")[0]){case"underline":this.renderer.rectangle(n.left,Math.round(n.top+f.baseline+f.lineWidth),n.width,1,e.color("color"));break;case"overline":this.renderer.rectangle(n.left,Math.round(n.top),n.width,1,e.color("color"));break;case"line-through":this.renderer.rectangle(n.left,Math.ceil(n.top+f.middle+f.lineWidth),n.width,1,e.color("color"))}};var _={inset:[["darken",.6],["darken",.1],["darken",.1],["darken",.6]]};f.prototype.parseBorders=function(e){var n=e.parseBounds(),f=g(e),o=["Top","Right","Bottom","Left"].map(function(n,f){var o=e.css("border"+n+"Style"),d=e.color("border"+n+"Color");"inset"===o&&d.isBlack()&&(d=new T([255,255,255,d.a]));var i=_[o]?_[o][f]:null;return{width:e.cssInt("border"+n+"Width"),color:i?d[i[0]](i[1]):d,args:null}}),d=s(n,f,o);return{clip:this.parseBackgroundClip(e,d,o,f,n),borders:t(o,n,d,f)}},f.prototype.parseBackgroundClip=function(e,n,f,o,d){var i=e.css("backgroundClip"),t=[];switch(i){case"content-box":case"padding-box":
p(t,o[0],o[1],n.topLeftInner,n.topRightInner,d.left+f[3].width,d.top+f[0].width),p(t,o[1],o[2],n.topRightInner,n.bottomRightInner,d.left+d.width-f[1].width,d.top+f[0].width),p(t,o[2],o[3],n.bottomRightInner,n.bottomLeftInner,d.left+d.width-f[1].width,d.top+d.height-f[2].width),p(t,o[3],o[0],n.bottomLeftInner,n.topLeftInner,d.left+f[3].width,d.top+d.height-f[2].width);break;default:p(t,o[0],o[1],n.topLeftOuter,n.topRightOuter,d.left,d.top),p(t,o[1],o[2],n.topRightOuter,n.bottomRightOuter,d.left+d.width,d.top),p(t,o[2],o[3],n.bottomRightOuter,n.bottomLeftOuter,d.left+d.width,d.top+d.height),p(t,o[3],o[0],n.bottomLeftOuter,n.topLeftOuter,d.left,d.top+d.height)}return t},n.exports=f},{"./color":5,"./fontmetrics":9,"./log":15,"./nodecontainer":16,"./promise":18,"./pseudoelementcontainer":21,"./stackingcontext":24,"./textcontainer":28,"./utils":29,punycode:3}],18:[function(e,n){n.exports=e("es6-promise").Promise},{"es6-promise":1}],19:[function(e,n,f){function o(e,n,f){var o="withCredentials"in new XMLHttpRequest;if(!n)return a.reject("No proxy configured");var d=t(o),s=l(n,e,d);return o?p(s):i(f,s,d).then(function(e){return r(e.content)})}function d(e,n,f){var o="crossOrigin"in new Image,d=t(o),s=l(n,e,d);return o?a.resolve(s):i(f,s,d).then(function(e){return"data:"+e.type+";base64,"+e.content})}function i(e,n,f){return new a(function(o,d){var i=e.createElement("script"),t=function(){delete window.html2canvas.proxy[f],e.body.removeChild(i)};window.html2canvas.proxy[f]=function(e){t(),o(e)},i.src=n,i.onerror=function(e){t(),d(e)},e.body.appendChild(i)})}function t(e){return e?"":"html2canvas_"+Date.now()+"_"+ ++v+"_"+Math.round(1e5*Math.random())}function l(e,n,f){return e+"?url="+encodeURIComponent(n)+(f.length?"&callback=html2canvas.proxy."+f:"")}function s(e){return function(n){var f,o=new DOMParser;try{f=o.parseFromString(n,"text/html")}catch(d){y("DOMParser not supported, falling back to createHTMLDocument"),f=document.implementation.createHTMLDocument("");try{f.open(),f.write(n),f.close()}catch(i){y("createHTMLDocument write not supported, falling back to document.body.innerHTML"),f.body.innerHTML=n}}var t=f.querySelector("base");if(!t||!t.href.host){var l=f.createElement("base");l.href=e,f.head.insertBefore(l,f.head.firstChild)}return f}}function u(e,n,f,d,i,t){return new o(e,n,window.document).then(s(e)).then(function(e){return m(e,f,d,i,t,0,0)})}var a=e("./promise"),p=e("./xhr"),c=e("./utils"),y=e("./log"),m=e("./clone"),r=c.decode64,v=0;f.Proxy=o,f.ProxyURL=d,f.loadUrlDocument=u},{"./clone":4,"./log":15,"./promise":18,"./utils":29,"./xhr":31}],20:[function(e,n){function f(e,n){var f=document.createElement("a");f.href=e,e=f.href,this.src=e,this.image=new Image;var i=this;this.promise=new d(function(f,d){i.image.crossOrigin="Anonymous",i.image.onload=f,i.image.onerror=d,new o(e,n,document).then(function(e){i.image.src=e})["catch"](d)})}var o=e("./proxy").ProxyURL,d=e("./promise");n.exports=f},{"./promise":18,"./proxy":19}],21:[function(e,n){function f(e,n,f){o.call(this,e,n),this.isPseudoElement=!0,this.before=":before"===f}var o=e("./nodecontainer");f.prototype.cloneTo=function(e){f.prototype.cloneTo.call(this,e),e.isPseudoElement=!0,e.before=this.before},f.prototype=Object.create(o.prototype),f.prototype.appendToDOM=function(){this.before?this.parent.node.insertBefore(this.node,this.parent.node.firstChild):this.parent.node.appendChild(this.node),this.parent.node.className+=" "+this.getHideClass()},f.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node),this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),"")},f.prototype.getHideClass=function(){return this["PSEUDO_HIDE_ELEMENT_CLASS_"+(this.before?"BEFORE":"AFTER")]},f.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",f.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",n.exports=f},{"./nodecontainer":16}],22:[function(e,n){function f(e,n,f,o,d){this.width=e,this.height=n,this.images=f,this.options=o,this.document=d}var o=e("./log");f.prototype.renderImage=function(e,n,f,o){var d=e.cssInt("paddingLeft"),i=e.cssInt("paddingTop"),t=e.cssInt("paddingRight"),l=e.cssInt("paddingBottom"),s=f.borders,u=n.width-(s[1].width+s[3].width+d+t),a=n.height-(s[0].width+s[2].width+i+l);this.drawImage(o,0,0,o.image.width||u,o.image.height||a,n.left+d+s[3].width,n.top+i+s[0].width,u,a)},f.prototype.renderBackground=function(e,n,f){n.height>0&&n.width>0&&(this.renderBackgroundColor(e,n),this.renderBackgroundImage(e,n,f))},f.prototype.renderBackgroundColor=function(e,n){var f=e.color("backgroundColor");f.isTransparent()||this.rectangle(n.left,n.top,n.width,n.height,f)},f.prototype.renderBorders=function(e){e.forEach(this.renderBorder,this)},f.prototype.renderBorder=function(e){e.color.isTransparent()||null===e.args||this.drawShape(e.args,e.color)},f.prototype.renderBackgroundImage=function(e,n,f){var d=e.parseBackgroundImages();d.reverse().forEach(function(d,i,t){switch(d.method){case"url":var l=this.images.get(d.args[0]);l?this.renderBackgroundRepeating(e,n,l,t.length-(i+1),f):o("Error loading background-image",d.args[0]);break;case"linear-gradient":case"gradient":var s=this.images.get(d.value);s?this.renderBackgroundGradient(s,n,f):o("Error loading background-image",d.args[0]);break;case"none":break;default:o("Unknown background-image type",d.args[0])}},this)},f.prototype.renderBackgroundRepeating=function(e,n,f,o,d){var i=e.parseBackgroundSize(n,f.image,o),t=e.parseBackgroundPosition(n,f.image,o,i),l=e.parseBackgroundRepeat(o);switch(l){case"repeat-x":case"repeat no-repeat":this.backgroundRepeatShape(f,t,i,n,n.left+d[3],n.top+t.top+d[0],99999,i.height,d);break;case"repeat-y":case"no-repeat repeat":this.backgroundRepeatShape(f,t,i,n,n.left+t.left+d[3],n.top+d[0],i.width,99999,d);break;case"no-repeat":this.backgroundRepeatShape(f,t,i,n,n.left+t.left+d[3],n.top+t.top+d[0],i.width,i.height,d);break;default:this.renderBackgroundRepeat(f,t,i,{top:n.top,left:n.left},d[3],d[0])}},n.exports=f},{"./log":15}],23:[function(e,n){function f(e,n){d.apply(this,arguments),this.canvas=this.options.canvas||this.document.createElement("canvas"),this.options.canvas||(this.canvas.width=e,this.canvas.height=n),this.ctx=this.canvas.getContext("2d"),this.taintCtx=this.document.createElement("canvas").getContext("2d"),this.ctx.textBaseline="bottom",this.variables={},t("Initialized CanvasRenderer with size",e,"x",n)}function o(e){return e.length>0}var d=e("../renderer"),i=e("../lineargradientcontainer"),t=e("../log");f.prototype=Object.create(d.prototype),f.prototype.setFillStyle=function(e){return this.ctx.fillStyle="object"==typeof e&&e.isColor?e.toString():e,this.ctx},f.prototype.rectangle=function(e,n,f,o,d){this.setFillStyle(d).fillRect(e,n,f,o)},f.prototype.circle=function(e,n,f,o){this.setFillStyle(o),this.ctx.beginPath(),this.ctx.arc(e+f/2,n+f/2,f/2,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},f.prototype.circleStroke=function(e,n,f,o,d,i){this.circle(e,n,f,o),this.ctx.strokeStyle=i.toString(),this.ctx.stroke()},f.prototype.drawShape=function(e,n){this.shape(e),this.setFillStyle(n).fill()},f.prototype.taints=function(e){if(null===e.tainted){this.taintCtx.drawImage(e.image,0,0);try{this.taintCtx.getImageData(0,0,1,1),e.tainted=!1}catch(n){this.taintCtx=document.createElement("canvas").getContext("2d"),e.tainted=!0}}return e.tainted},f.prototype.drawImage=function(e,n,f,o,d,i,t,l,s){(!this.taints(e)||this.options.allowTaint)&&this.ctx.drawImage(e.image,n,f,o,d,i,t,l,s)},f.prototype.clip=function(e,n,f){this.ctx.save(),e.filter(o).forEach(function(e){this.shape(e).clip()},this),n.call(f),this.ctx.restore()},f.prototype.shape=function(e){return this.ctx.beginPath(),e.forEach(function(e,n){"rect"===e[0]?this.ctx.rect.apply(this.ctx,e.slice(1)):this.ctx[0===n?"moveTo":e[0]+"To"].apply(this.ctx,e.slice(1))},this),this.ctx.closePath(),this.ctx},f.prototype.font=function(e,n,f,o,d,i){this.setFillStyle(e).font=[n,f,o,d,i].join(" ").split(",")[0]},f.prototype.fontShadow=function(e,n,f,o){this.setVariable("shadowColor",e.toString()).setVariable("shadowOffsetY",n).setVariable("shadowOffsetX",f).setVariable("shadowBlur",o)},f.prototype.clearShadow=function(){this.setVariable("shadowColor","rgba(0,0,0,0)")},f.prototype.setOpacity=function(e){this.ctx.globalAlpha=e},f.prototype.setTransform=function(e){this.ctx.translate(e.origin[0],e.origin[1]),this.ctx.transform.apply(this.ctx,e.matrix),this.ctx.translate(-e.origin[0],-e.origin[1])},f.prototype.setVariable=function(e,n){return this.variables[e]!==n&&(this.variables[e]=this.ctx[e]=n),this},f.prototype.text=function(e,n,f){this.ctx.fillText(e,n,f)},f.prototype.backgroundRepeatShape=function(e,n,f,o,d,i,t,l,s){var u=[["line",Math.round(d),Math.round(i)],["line",Math.round(d+t),Math.round(i)],["line",Math.round(d+t),Math.round(l+i)],["line",Math.round(d),Math.round(l+i)]];this.clip([u],function(){this.renderBackgroundRepeat(e,n,f,o,s[3],s[0])},this)},f.prototype.renderBackgroundRepeat=function(e,n,f,o,d,i){var t=Math.round(o.left+n.left+d),l=Math.round(o.top+n.top+i);this.setFillStyle(this.ctx.createPattern(this.resizeImage(e,f),"repeat")),this.ctx.translate(t,l),this.ctx.fill(),this.ctx.translate(-t,-l)},f.prototype.renderBackgroundGradient=function(e,n){if(e instanceof i){var f=this.ctx.createLinearGradient(n.left+n.width*e.x0,n.top+n.height*e.y0,n.left+n.width*e.x1,n.top+n.height*e.y1);e.colorStops.forEach(function(e){f.addColorStop(e.stop,e.color.toString())}),this.rectangle(n.left,n.top,n.width,n.height,f)}},f.prototype.resizeImage=function(e,n){var f=e.image;if(f.width===n.width&&f.height===n.height)return f;var o,d=document.createElement("canvas");return d.width=n.width,d.height=n.height,o=d.getContext("2d"),o.drawImage(f,0,0,f.width,f.height,0,0,n.width,n.height),d},n.exports=f},{"../lineargradientcontainer":14,"../log":15,"../renderer":22}],24:[function(e,n){function f(e,n,f,d){o.call(this,f,d),this.ownStacking=e,this.contexts=[],this.children=[],this.opacity=(this.parent?this.parent.stack.opacity:1)*n}var o=e("./nodecontainer");f.prototype=Object.create(o.prototype),f.prototype.getParentStack=function(e){var n=this.parent?this.parent.stack:null;return n?n.ownStacking?n:n.getParentStack(e):e.stack},n.exports=f},{"./nodecontainer":16}],25:[function(e,n){function f(e){this.rangeBounds=this.testRangeBounds(e),this.cors=this.testCORS(),this.svg=this.testSVG()}f.prototype.testRangeBounds=function(e){var n,f,o,d,i=!1;return e.createRange&&(n=e.createRange(),n.getBoundingClientRect&&(f=e.createElement("boundtest"),f.style.height="123px",f.style.display="block",e.body.appendChild(f),n.selectNode(f),o=n.getBoundingClientRect(),d=o.height,123===d&&(i=!0),e.body.removeChild(f))),i},f.prototype.testCORS=function(){return"undefined"!=typeof(new Image).crossOrigin},f.prototype.testSVG=function(){var e=new Image,n=document.createElement("canvas"),f=n.getContext("2d");e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{f.drawImage(e,0,0),n.toDataURL()}catch(o){return!1}return!0},n.exports=f},{}],26:[function(e,n){function f(e){this.src=e,this.image=null;var n=this;this.promise=this.hasFabric().then(function(){return n.isInline(e)?o.resolve(n.inlineFormatting(e)):d(e)}).then(function(e){return new o(function(f){window.html2canvas.svg.fabric.loadSVGFromString(e,n.createCanvas.call(n,f))})})}var o=e("./promise"),d=e("./xhr"),i=e("./utils").decode64;f.prototype.hasFabric=function(){return window.html2canvas.svg&&window.html2canvas.svg.fabric?o.resolve():o.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg"))},f.prototype.inlineFormatting=function(e){return/^data:image\/svg\+xml;base64,/.test(e)?this.decode64(this.removeContentType(e)):this.removeContentType(e)},f.prototype.removeContentType=function(e){return e.replace(/^data:image\/svg\+xml(;base64)?,/,"")},f.prototype.isInline=function(e){return/^data:image\/svg\+xml/i.test(e)},f.prototype.createCanvas=function(e){var n=this;return function(f,o){var d=new window.html2canvas.svg.fabric.StaticCanvas("c");n.image=d.lowerCanvasEl,d.setWidth(o.width).setHeight(o.height).add(window.html2canvas.svg.fabric.util.groupSVGElements(f,o)).renderAll(),e(d.lowerCanvasEl)}},f.prototype.decode64=function(e){return"function"==typeof window.atob?window.atob(e):i(e)},n.exports=f},{"./promise":18,"./utils":29,"./xhr":31}],27:[function(e,n){function f(e,n){this.src=e,this.image=null;var f=this;this.promise=n?new d(function(n,o){f.image=new Image,f.image.onload=n,f.image.onerror=o,f.image.src="data:image/svg+xml,"+(new XMLSerializer).serializeToString(e),f.image.complete===!0&&n(f.image)}):this.hasFabric().then(function(){return new d(function(n){window.html2canvas.svg.fabric.parseSVGDocument(e,f.createCanvas.call(f,n))})})}var o=e("./svgcontainer"),d=e("./promise");f.prototype=Object.create(o.prototype),n.exports=f},{"./promise":18,"./svgcontainer":26}],28:[function(e,n){function f(e,n){d.call(this,e,n)}function o(e,n,f){return e.length>0?n+f.toUpperCase():void 0}var d=e("./nodecontainer");f.prototype=Object.create(d.prototype),f.prototype.applyTextTransform=function(){this.node.data=this.transform(this.parent.css("textTransform"))},f.prototype.transform=function(e){var n=this.node.data;switch(e){case"lowercase":return n.toLowerCase();case"capitalize":return n.replace(/(^|\s|:|-|\(|\))([a-z])/g,o);case"uppercase":return n.toUpperCase();default:return n}},n.exports=f},{"./nodecontainer":16}],29:[function(e,n,f){f.smallImage=function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},f.bind=function(e,n){return function(){return e.apply(n,arguments)}},f.decode64=function(e){var n,f,o,d,i,t,l,s,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=e.length,p="";for(n=0;a>n;n+=4)f=u.indexOf(e[n]),o=u.indexOf(e[n+1]),d=u.indexOf(e[n+2]),i=u.indexOf(e[n+3]),t=f<<2|o>>4,l=(15&o)<<4|d>>2,s=(3&d)<<6|i,p+=64===d?String.fromCharCode(t):64===i||-1===i?String.fromCharCode(t,l):String.fromCharCode(t,l,s);return p},f.getBounds=function(e){if(e.getBoundingClientRect){var n=e.getBoundingClientRect(),f=null==e.offsetWidth?n.width:e.offsetWidth;return{top:n.top,bottom:n.bottom||n.top+n.height,right:n.left+f,left:n.left,width:f,height:null==e.offsetHeight?n.height:e.offsetHeight}}return{}},f.offsetBounds=function(e){var n=e.offsetParent?f.offsetBounds(e.offsetParent):{top:0,left:0};return{top:e.offsetTop+n.top,bottom:e.offsetTop+e.offsetHeight+n.top,right:e.offsetLeft+n.left+e.offsetWidth,left:e.offsetLeft+n.left,width:e.offsetWidth,height:e.offsetHeight}},f.parseBackgrounds=function(e){var n,f,o,d,i,t,l,s=" \r\n	",u=[],a=0,p=0,c=function(){n&&('"'===f.substr(0,1)&&(f=f.substr(1,f.length-2)),f&&l.push(f),"-"===n.substr(0,1)&&(d=n.indexOf("-",1)+1)>0&&(o=n.substr(0,d),n=n.substr(d)),u.push({prefix:o,method:n.toLowerCase(),value:i,args:l,image:null})),l=[],n=o=f=i=""};return l=[],n=o=f=i="",e.split("").forEach(function(e){if(!(0===a&&s.indexOf(e)>-1)){switch(e){case'"':t?t===e&&(t=null):t=e;break;case"(":if(t)break;if(0===a)return a=1,void(i+=e);p++;break;case")":if(t)break;if(1===a){if(0===p)return a=0,i+=e,void c();p--}break;case",":if(t)break;if(0===a)return void c();if(1===a&&0===p&&!n.match(/^url$/i))return l.push(f),f="",void(i+=e)}i+=e,0===a?n+=e:f+=e}}),c(),u}},{}],30:[function(e,n){function f(e){o.apply(this,arguments),this.type="linear"===e.args[0]?this.TYPES.LINEAR:this.TYPES.RADIAL}var o=e("./gradientcontainer");f.prototype=Object.create(o.prototype),n.exports=f},{"./gradientcontainer":11}],31:[function(e,n){function f(e){return new o(function(n,f){var o=new XMLHttpRequest;o.open("GET",e),o.onload=function(){200===o.status?n(o.responseText):f(new Error(o.statusText))},o.onerror=function(){f(new Error("Network Error"))},o.send()})}var o=e("./promise");n.exports=f},{"./promise":18}]},{},[6])(6)}),!function(a){"use strict";function b(a){return(a||"").toLowerCase()}var c="2.1.6";a.fn.cycle=function(c){var d;return 0!==this.length||a.isReady?this.each(function(){var d,e,f,g,h=a(this),i=a.fn.cycle.log;if(!h.data("cycle.opts")){(h.data("cycle-log")===!1||c&&c.log===!1||e&&e.log===!1)&&(i=a.noop),i("--c2 init--"),d=h.data();for(var j in d)d.hasOwnProperty(j)&&/^cycle[A-Z]+/.test(j)&&(g=d[j],f=j.match(/^cycle(.*)/)[1].replace(/^[A-Z]/,b),i(f+":",g,"("+typeof g+")"),d[f]=g);e=a.extend({},a.fn.cycle.defaults,d,c||{}),e.timeoutId=0,e.paused=e.paused||!1,e.container=h,e._maxZ=e.maxZ,e.API=a.extend({_container:h},a.fn.cycle.API),e.API.log=i,e.API.trigger=function(a,b){return e.container.trigger(a,b),e.API},h.data("cycle.opts",e),h.data("cycle.API",e.API),e.API.trigger("cycle-bootstrap",[e,e.API]),e.API.addInitialSlides(),e.API.preInitSlideshow(),e.slides.length&&e.API.initSlideshow()}}):(d={s:this.selector,c:this.context},a.fn.cycle.log("requeuing slideshow (dom not ready)"),a(function(){a(d.s,d.c).cycle(c)}),this)},a.fn.cycle.API={opts:function(){return this._container.data("cycle.opts")},addInitialSlides:function(){var b=this.opts(),c=b.slides;b.slideCount=0,b.slides=a(),c=c.jquery?c:b.container.find(c),b.random&&c.sort(function(){return Math.random()-.5}),b.API.add(c)},preInitSlideshow:function(){var b=this.opts();b.API.trigger("cycle-pre-initialize",[b]);var c=a.fn.cycle.transitions[b.fx];c&&a.isFunction(c.preInit)&&c.preInit(b),b._preInitialized=!0},postInitSlideshow:function(){var b=this.opts();b.API.trigger("cycle-post-initialize",[b]);var c=a.fn.cycle.transitions[b.fx];c&&a.isFunction(c.postInit)&&c.postInit(b)},initSlideshow:function(){var b,c=this.opts(),d=c.container;c.API.calcFirstSlide(),"static"==c.container.css("position")&&c.container.css("position","relative"),a(c.slides[c.currSlide]).css({opacity:1,display:"block",visibility:"visible"}),c.API.stackSlides(c.slides[c.currSlide],c.slides[c.nextSlide],!c.reverse),c.pauseOnHover&&(c.pauseOnHover!==!0&&(d=a(c.pauseOnHover)),d.hover(function(){c.API.pause(!0)},function(){c.API.resume(!0)})),c.timeout&&(b=c.API.getSlideOpts(c.currSlide),c.API.queueTransition(b,b.timeout+c.delay)),c._initialized=!0,c.API.updateView(!0),c.API.trigger("cycle-initialized",[c]),c.API.postInitSlideshow()},pause:function(b){var c=this.opts(),d=c.API.getSlideOpts(),e=c.hoverPaused||c.paused;b?c.hoverPaused=!0:c.paused=!0,e||(c.container.addClass("cycle-paused"),c.API.trigger("cycle-paused",[c]).log("cycle-paused"),d.timeout&&(clearTimeout(c.timeoutId),c.timeoutId=0,c._remainingTimeout-=a.now()-c._lastQueue,(c._remainingTimeout<0||isNaN(c._remainingTimeout))&&(c._remainingTimeout=void 0)))},resume:function(a){var b=this.opts(),c=!b.hoverPaused&&!b.paused;a?b.hoverPaused=!1:b.paused=!1,c||(b.container.removeClass("cycle-paused"),0===b.slides.filter(":animated").length&&b.API.queueTransition(b.API.getSlideOpts(),b._remainingTimeout),b.API.trigger("cycle-resumed",[b,b._remainingTimeout]).log("cycle-resumed"))},add:function(b,c){var d,e=this.opts(),f=e.slideCount,g=!1;"string"==a.type(b)&&(b=a.trim(b)),a(b).each(function(){var b,d=a(this);c?e.container.prepend(d):e.container.append(d),e.slideCount++,b=e.API.buildSlideOpts(d),e.slides=c?a(d).add(e.slides):e.slides.add(d),e.API.initSlide(b,d,--e._maxZ),d.data("cycle.opts",b),e.API.trigger("cycle-slide-added",[e,b,d])}),e.API.updateView(!0),g=e._preInitialized&&2>f&&e.slideCount>=1,g&&(e._initialized?e.timeout&&(d=e.slides.length,e.nextSlide=e.reverse?d-1:1,e.timeoutId||e.API.queueTransition(e)):e.API.initSlideshow())},calcFirstSlide:function(){var a,b=this.opts();a=parseInt(b.startingSlide||0,10),(a>=b.slides.length||0>a)&&(a=0),b.currSlide=a,b.reverse?(b.nextSlide=a-1,b.nextSlide<0&&(b.nextSlide=b.slides.length-1)):(b.nextSlide=a+1,b.nextSlide==b.slides.length&&(b.nextSlide=0))},calcNextSlide:function(){var a,b=this.opts();b.reverse?(a=b.nextSlide-1<0,b.nextSlide=a?b.slideCount-1:b.nextSlide-1,b.currSlide=a?0:b.nextSlide+1):(a=b.nextSlide+1==b.slides.length,b.nextSlide=a?0:b.nextSlide+1,b.currSlide=a?b.slides.length-1:b.nextSlide-1)},calcTx:function(b,c){var d,e=b;return e._tempFx?d=a.fn.cycle.transitions[e._tempFx]:c&&e.manualFx&&(d=a.fn.cycle.transitions[e.manualFx]),d||(d=a.fn.cycle.transitions[e.fx]),e._tempFx=null,this.opts()._tempFx=null,d||(d=a.fn.cycle.transitions.fade,e.API.log('Transition "'+e.fx+'" not found.  Using fade.')),d},prepareTx:function(a,b){var c,d,e,f,g,h=this.opts();return h.slideCount<2?void(h.timeoutId=0):(!a||h.busy&&!h.manualTrump||(h.API.stopTransition(),h.busy=!1,clearTimeout(h.timeoutId),h.timeoutId=0),void(h.busy||(0!==h.timeoutId||a)&&(d=h.slides[h.currSlide],e=h.slides[h.nextSlide],f=h.API.getSlideOpts(h.nextSlide),g=h.API.calcTx(f,a),h._tx=g,a&&void 0!==f.manualSpeed&&(f.speed=f.manualSpeed),h.nextSlide!=h.currSlide&&(a||!h.paused&&!h.hoverPaused&&h.timeout)?(h.API.trigger("cycle-before",[f,d,e,b]),g.before&&g.before(f,d,e,b),c=function(){h.busy=!1,h.container.data("cycle.opts")&&(g.after&&g.after(f,d,e,b),h.API.trigger("cycle-after",[f,d,e,b]),h.API.queueTransition(f),h.API.updateView(!0))},h.busy=!0,g.transition?g.transition(f,d,e,b,c):h.API.doTransition(f,d,e,b,c),h.API.calcNextSlide(),h.API.updateView()):h.API.queueTransition(f))))},doTransition:function(b,c,d,e,f){var g=b,h=a(c),i=a(d),j=function(){i.animate(g.animIn||{opacity:1},g.speed,g.easeIn||g.easing,f)};i.css(g.cssBefore||{}),h.animate(g.animOut||{},g.speed,g.easeOut||g.easing,function(){h.css(g.cssAfter||{}),g.sync||j()}),g.sync&&j()},queueTransition:function(b,c){var d=this.opts(),e=void 0!==c?c:b.timeout;return 0===d.nextSlide&&0===--d.loop?(d.API.log("terminating; loop=0"),d.timeout=0,e?setTimeout(function(){d.API.trigger("cycle-finished",[d])},e):d.API.trigger("cycle-finished",[d]),void(d.nextSlide=d.currSlide)):void 0!==d.continueAuto&&(d.continueAuto===!1||a.isFunction(d.continueAuto)&&d.continueAuto()===!1)?(d.API.log("terminating automatic transitions"),d.timeout=0,void(d.timeoutId&&clearTimeout(d.timeoutId))):void(e&&(d._lastQueue=a.now(),void 0===c&&(d._remainingTimeout=b.timeout),d.paused||d.hoverPaused||(d.timeoutId=setTimeout(function(){d.API.prepareTx(!1,!d.reverse)},e))))},stopTransition:function(){var a=this.opts();a.slides.filter(":animated").length&&(a.slides.stop(!1,!0),a.API.trigger("cycle-transition-stopped",[a])),a._tx&&a._tx.stopTransition&&a._tx.stopTransition(a)},advanceSlide:function(a){var b=this.opts();return clearTimeout(b.timeoutId),b.timeoutId=0,b.nextSlide=b.currSlide+a,b.nextSlide<0?b.nextSlide=b.slides.length-1:b.nextSlide>=b.slides.length&&(b.nextSlide=0),b.API.prepareTx(!0,a>=0),!1},buildSlideOpts:function(c){var d,e,f=this.opts(),g=c.data()||{};for(var h in g)g.hasOwnProperty(h)&&/^cycle[A-Z]+/.test(h)&&(d=g[h],e=h.match(/^cycle(.*)/)[1].replace(/^[A-Z]/,b),f.API.log("["+(f.slideCount-1)+"]",e+":",d,"("+typeof d+")"),g[e]=d);g=a.extend({},a.fn.cycle.defaults,f,g),g.slideNum=f.slideCount;try{delete g.API,delete g.slideCount,delete g.currSlide,delete g.nextSlide,delete g.slides}catch(i){}return g},getSlideOpts:function(b){var c=this.opts();void 0===b&&(b=c.currSlide);var d=c.slides[b],e=a(d).data("cycle.opts");return a.extend({},c,e)},initSlide:function(b,c,d){var e=this.opts();c.css(b.slideCss||{}),d>0&&c.css("zIndex",d),isNaN(b.speed)&&(b.speed=a.fx.speeds[b.speed]||a.fx.speeds._default),b.sync||(b.speed=b.speed/2),c.addClass(e.slideClass)},updateView:function(a,b){var c=this.opts();if(c._initialized){var d=c.API.getSlideOpts(),e=c.slides[c.currSlide];!a&&b!==!0&&(c.API.trigger("cycle-update-view-before",[c,d,e]),c.updateView<0)||(c.slideActiveClass&&c.slides.removeClass(c.slideActiveClass).eq(c.currSlide).addClass(c.slideActiveClass),a&&c.hideNonActive&&c.slides.filter(":not(."+c.slideActiveClass+")").css("visibility","hidden"),0===c.updateView&&setTimeout(function(){c.API.trigger("cycle-update-view",[c,d,e,a])},d.speed/(c.sync?2:1)),0!==c.updateView&&c.API.trigger("cycle-update-view",[c,d,e,a]),a&&c.API.trigger("cycle-update-view-after",[c,d,e]))}},getComponent:function(b){var c=this.opts(),d=c[b];return"string"==typeof d?/^\s*[\>|\+|~]/.test(d)?c.container.find(d):a(d):d.jquery?d:a(d)},stackSlides:function(b,c,d){var e=this.opts();b||(b=e.slides[e.currSlide],c=e.slides[e.nextSlide],d=!e.reverse),a(b).css("zIndex",e.maxZ);var f,g=e.maxZ-2,h=e.slideCount;if(d){for(f=e.currSlide+1;h>f;f++)a(e.slides[f]).css("zIndex",g--);for(f=0;f<e.currSlide;f++)a(e.slides[f]).css("zIndex",g--)}else{for(f=e.currSlide-1;f>=0;f--)a(e.slides[f]).css("zIndex",g--);for(f=h-1;f>e.currSlide;f--)a(e.slides[f]).css("zIndex",g--)}a(c).css("zIndex",e.maxZ-1)},getSlideIndex:function(a){return this.opts().slides.index(a)}},a.fn.cycle.log=function(){window.console&&console.log&&console.log("[cycle2] "+Array.prototype.join.call(arguments," "))},a.fn.cycle.version=function(){return"Cycle2: "+c},a.fn.cycle.transitions={custom:{},none:{before:function(a,b,c,d){a.API.stackSlides(c,b,d),a.cssBefore={opacity:1,visibility:"visible",display:"block"}}},fade:{before:function(b,c,d,e){var f=b.API.getSlideOpts(b.nextSlide).slideCss||{};b.API.stackSlides(c,d,e),b.cssBefore=a.extend(f,{opacity:0,visibility:"visible",display:"block"}),b.animIn={opacity:1},b.animOut={opacity:0}}},fadeout:{before:function(b,c,d,e){var f=b.API.getSlideOpts(b.nextSlide).slideCss||{};b.API.stackSlides(c,d,e),b.cssBefore=a.extend(f,{opacity:1,visibility:"visible",display:"block"}),b.animOut={opacity:0}}},scrollHorz:{before:function(a,b,c,d){a.API.stackSlides(b,c,d);var e=a.container.css("overflow","hidden").width();a.cssBefore={left:d?e:-e,top:0,opacity:1,visibility:"visible",display:"block"},a.cssAfter={zIndex:a._maxZ-2,left:0},a.animIn={left:0},a.animOut={left:d?-e:e}}}},a.fn.cycle.defaults={allowWrap:!0,autoSelector:".cycle-slideshow[data-cycle-auto-init!=false]",delay:0,easing:null,fx:"fade",hideNonActive:!0,loop:0,manualFx:void 0,manualSpeed:void 0,manualTrump:!0,maxZ:100,pauseOnHover:!1,reverse:!1,slideActiveClass:"cycle-slide-active",slideClass:"cycle-slide",slideCss:{position:"absolute",top:0,left:0},slides:"> img",speed:500,startingSlide:0,sync:!0,timeout:4e3,updateView:0},a(document).ready(function(){a(a.fn.cycle.defaults.autoSelector).cycle()})}(jQuery),function(a){"use strict";function b(b,d){var e,f,g,h=d.autoHeight;if("container"==h)f=a(d.slides[d.currSlide]).outerHeight(),d.container.height(f);else if(d._autoHeightRatio)d.container.height(d.container.width()/d._autoHeightRatio);else if("calc"===h||"number"==a.type(h)&&h>=0){if(g="calc"===h?c(b,d):h>=d.slides.length?0:h,g==d._sentinelIndex)return;d._sentinelIndex=g,d._sentinel&&d._sentinel.remove(),e=a(d.slides[g].cloneNode(!0)),e.removeAttr("id name rel").find("[id],[name],[rel]").removeAttr("id name rel"),e.css({position:"static",visibility:"hidden",display:"block"}).prependTo(d.container).addClass("cycle-sentinel cycle-slide").removeClass("cycle-slide-active"),e.find("*").css("visibility","hidden"),d._sentinel=e}}function c(b,c){var d=0,e=-1;return c.slides.each(function(b){var c=a(this).height();c>e&&(e=c,d=b)}),d}function d(b,c,d,e){var f=a(e).outerHeight();c.container.animate({height:f},c.autoHeightSpeed,c.autoHeightEasing)}function e(c,f){f._autoHeightOnResize&&(a(window).off("resize orientationchange",f._autoHeightOnResize),f._autoHeightOnResize=null),f.container.off("cycle-slide-added cycle-slide-removed",b),f.container.off("cycle-destroyed",e),f.container.off("cycle-before",d),f._sentinel&&(f._sentinel.remove(),f._sentinel=null)}a.extend(a.fn.cycle.defaults,{autoHeight:0,autoHeightSpeed:250,autoHeightEasing:null}),a(document).on("cycle-initialized",function(c,f){function g(){b(c,f)}var h,i=f.autoHeight,j=a.type(i),k=null;("string"===j||"number"===j)&&(f.container.on("cycle-slide-added cycle-slide-removed",b),f.container.on("cycle-destroyed",e),"container"==i?f.container.on("cycle-before",d):"string"===j&&/\d+\:\d+/.test(i)&&(h=i.match(/(\d+)\:(\d+)/),h=h[1]/h[2],f._autoHeightRatio=h),"number"!==j&&(f._autoHeightOnResize=function(){clearTimeout(k),k=setTimeout(g,50)},a(window).on("resize orientationchange",f._autoHeightOnResize)),setTimeout(g,30))})}(jQuery),function(a){"use strict";a.extend(a.fn.cycle.defaults,{caption:"> .cycle-caption",captionTemplate:"{{slideNum}} / {{slideCount}}",overlay:"> .cycle-overlay",overlayTemplate:"<div>{{title}}</div><div>{{desc}}</div>",captionModule:"caption"}),a(document).on("cycle-update-view",function(b,c,d,e){"caption"===c.captionModule&&a.each(["caption","overlay"],function(){var a=this,b=d[a+"Template"],f=c.API.getComponent(a);f.length&&b?(f.html(c.API.tmpl(b,d,c,e)),f.show()):f.hide()})}),a(document).on("cycle-destroyed",function(b,c){var d;a.each(["caption","overlay"],function(){var a=this,b=c[a+"Template"];c[a]&&b&&(d=c.API.getComponent("caption"),d.empty())})})}(jQuery),function(a){"use strict";var b=a.fn.cycle;a.fn.cycle=function(c){var d,e,f,g=a.makeArray(arguments);return"number"==a.type(c)?this.cycle("goto",c):"string"==a.type(c)?this.each(function(){var h;return d=c,f=a(this).data("cycle.opts"),void 0===f?void b.log('slideshow must be initialized before sending commands; "'+d+'" ignored'):(d="goto"==d?"jump":d,e=f.API[d],a.isFunction(e)?(h=a.makeArray(g),h.shift(),e.apply(f.API,h)):void b.log("unknown command: ",d))}):b.apply(this,arguments)},a.extend(a.fn.cycle,b),a.extend(b.API,{next:function(){var a=this.opts();if(!a.busy||a.manualTrump){var b=a.reverse?-1:1;a.allowWrap===!1&&a.currSlide+b>=a.slideCount||(a.API.advanceSlide(b),a.API.trigger("cycle-next",[a]).log("cycle-next"))}},prev:function(){var a=this.opts();if(!a.busy||a.manualTrump){var b=a.reverse?1:-1;a.allowWrap===!1&&a.currSlide+b<0||(a.API.advanceSlide(b),a.API.trigger("cycle-prev",[a]).log("cycle-prev"))}},destroy:function(){this.stop();var b=this.opts(),c=a.isFunction(a._data)?a._data:a.noop;clearTimeout(b.timeoutId),b.timeoutId=0,b.API.stop(),b.API.trigger("cycle-destroyed",[b]).log("cycle-destroyed"),b.container.removeData(),c(b.container[0],"parsedAttrs",!1),b.retainStylesOnDestroy||(b.container.removeAttr("style"),b.slides.removeAttr("style"),b.slides.removeClass(b.slideActiveClass)),b.slides.each(function(){var d=a(this);d.removeData(),d.removeClass(b.slideClass),c(this,"parsedAttrs",!1)})},jump:function(a,b){var c,d=this.opts();if(!d.busy||d.manualTrump){var e=parseInt(a,10);if(isNaN(e)||0>e||e>=d.slides.length)return void d.API.log("goto: invalid slide index: "+e);if(e==d.currSlide)return void d.API.log("goto: skipping, already on slide",e);d.nextSlide=e,clearTimeout(d.timeoutId),d.timeoutId=0,d.API.log("goto: ",e," (zero-index)"),c=d.currSlide<d.nextSlide,d._tempFx=b,d.API.prepareTx(!0,c)}},stop:function(){var b=this.opts(),c=b.container;clearTimeout(b.timeoutId),b.timeoutId=0,b.API.stopTransition(),b.pauseOnHover&&(b.pauseOnHover!==!0&&(c=a(b.pauseOnHover)),c.off("mouseenter mouseleave")),b.API.trigger("cycle-stopped",[b]).log("cycle-stopped")},reinit:function(){var a=this.opts();a.API.destroy(),a.container.cycle()},remove:function(b){for(var c,d,e=this.opts(),f=[],g=1,h=0;h<e.slides.length;h++)c=e.slides[h],h==b?d=c:(f.push(c),a(c).data("cycle.opts").slideNum=g,g++);d&&(e.slides=a(f),e.slideCount--,a(d).remove(),b==e.currSlide?e.API.advanceSlide(1):b<e.currSlide?e.currSlide--:e.currSlide++,e.API.trigger("cycle-slide-removed",[e,b,d]).log("cycle-slide-removed"),e.API.updateView())}}),a(document).on("click.cycle","[data-cycle-cmd]",function(b){b.preventDefault();var c=a(this),d=c.data("cycle-cmd"),e=c.data("cycle-context")||".cycle-slideshow";a(e).cycle(d,c.data("cycle-arg"))})}(jQuery),function(a){"use strict";function b(b,c){var d;return b._hashFence?void(b._hashFence=!1):(d=window.location.hash.substring(1),void b.slides.each(function(e){if(a(this).data("cycle-hash")==d){if(c===!0)b.startingSlide=e;else{var f=b.currSlide<e;b.nextSlide=e,b.API.prepareTx(!0,f)}return!1}}))}a(document).on("cycle-pre-initialize",function(c,d){b(d,!0),d._onHashChange=function(){b(d,!1)},a(window).on("hashchange",d._onHashChange)}),a(document).on("cycle-update-view",function(a,b,c){c.hash&&"#"+c.hash!=window.location.hash&&(b._hashFence=!0,window.location.hash=c.hash)}),a(document).on("cycle-destroyed",function(b,c){
c._onHashChange&&a(window).off("hashchange",c._onHashChange)})}(jQuery),function(a){"use strict";a.extend(a.fn.cycle.defaults,{loader:!1}),a(document).on("cycle-bootstrap",function(b,c){function d(b,d){function f(b){var f;"wait"==c.loader?(h.push(b),0===j&&(h.sort(g),e.apply(c.API,[h,d]),c.container.removeClass("cycle-loading"))):(f=a(c.slides[c.currSlide]),e.apply(c.API,[b,d]),f.show(),c.container.removeClass("cycle-loading"))}function g(a,b){return a.data("index")-b.data("index")}var h=[];if("string"==a.type(b))b=a.trim(b);else if("array"===a.type(b))for(var i=0;i<b.length;i++)b[i]=a(b[i])[0];b=a(b);var j=b.length;j&&(b.css("visibility","hidden").appendTo("body").each(function(b){function g(){0===--i&&(--j,f(k))}var i=0,k=a(this),l=k.is("img")?k:k.find("img");return k.data("index",b),l=l.filter(":not(.cycle-loader-ignore)").filter(':not([src=""])'),l.length?(i=l.length,void l.each(function(){this.complete?g():a(this).load(function(){g()}).on("error",function(){0===--i&&(c.API.log("slide skipped; img not loaded:",this.src),0===--j&&"wait"==c.loader&&e.apply(c.API,[h,d]))})})):(--j,void h.push(k))}),j&&c.container.addClass("cycle-loading"))}var e;c.loader&&(e=c.API.add,c.API.add=d)})}(jQuery),function(a){"use strict";function b(b,c,d){var e,f=b.API.getComponent("pager");f.each(function(){var f=a(this);if(c.pagerTemplate){var g=b.API.tmpl(c.pagerTemplate,c,b,d[0]);e=a(g).appendTo(f)}else e=f.children().eq(b.slideCount-1);e.on(b.pagerEvent,function(a){b.pagerEventBubble||a.preventDefault(),b.API.page(f,a.currentTarget)})})}function c(a,b){var c=this.opts();if(!c.busy||c.manualTrump){var d=a.children().index(b),e=d,f=c.currSlide<e;c.currSlide!=e&&(c.nextSlide=e,c._tempFx=c.pagerFx,c.API.prepareTx(!0,f),c.API.trigger("cycle-pager-activated",[c,a,b]))}}a.extend(a.fn.cycle.defaults,{pager:"> .cycle-pager",pagerActiveClass:"cycle-pager-active",pagerEvent:"click.cycle",pagerEventBubble:void 0,pagerTemplate:"<span>&bull;</span>"}),a(document).on("cycle-bootstrap",function(a,c,d){d.buildPagerLink=b}),a(document).on("cycle-slide-added",function(a,b,d,e){b.pager&&(b.API.buildPagerLink(b,d,e),b.API.page=c)}),a(document).on("cycle-slide-removed",function(b,c,d){if(c.pager){var e=c.API.getComponent("pager");e.each(function(){var b=a(this);a(b.children()[d]).remove()})}}),a(document).on("cycle-update-view",function(b,c){var d;c.pager&&(d=c.API.getComponent("pager"),d.each(function(){a(this).children().removeClass(c.pagerActiveClass).eq(c.currSlide).addClass(c.pagerActiveClass)}))}),a(document).on("cycle-destroyed",function(a,b){var c=b.API.getComponent("pager");c&&(c.children().off(b.pagerEvent),b.pagerTemplate&&c.empty())})}(jQuery),function(a){"use strict";a.extend(a.fn.cycle.defaults,{next:"> .cycle-next",nextEvent:"click.cycle",disabledClass:"disabled",prev:"> .cycle-prev",prevEvent:"click.cycle",swipe:!1}),a(document).on("cycle-initialized",function(a,b){if(b.API.getComponent("next").on(b.nextEvent,function(a){a.preventDefault(),b.API.next()}),b.API.getComponent("prev").on(b.prevEvent,function(a){a.preventDefault(),b.API.prev()}),b.swipe){var c=b.swipeVert?"swipeUp.cycle":"swipeLeft.cycle swipeleft.cycle",d=b.swipeVert?"swipeDown.cycle":"swipeRight.cycle swiperight.cycle";b.container.on(c,function(){b._tempFx=b.swipeFx,b.API.next()}),b.container.on(d,function(){b._tempFx=b.swipeFx,b.API.prev()})}}),a(document).on("cycle-update-view",function(a,b){if(!b.allowWrap){var c=b.disabledClass,d=b.API.getComponent("next"),e=b.API.getComponent("prev"),f=b._prevBoundry||0,g=void 0!==b._nextBoundry?b._nextBoundry:b.slideCount-1;b.currSlide==g?d.addClass(c).prop("disabled",!0):d.removeClass(c).prop("disabled",!1),b.currSlide===f?e.addClass(c).prop("disabled",!0):e.removeClass(c).prop("disabled",!1)}}),a(document).on("cycle-destroyed",function(a,b){b.API.getComponent("prev").off(b.nextEvent),b.API.getComponent("next").off(b.prevEvent),b.container.off("swipeleft.cycle swiperight.cycle swipeLeft.cycle swipeRight.cycle swipeUp.cycle swipeDown.cycle")})}(jQuery),function(a){"use strict";a.extend(a.fn.cycle.defaults,{progressive:!1}),a(document).on("cycle-pre-initialize",function(b,c){if(c.progressive){var d,e,f=c.API,g=f.next,h=f.prev,i=f.prepareTx,j=a.type(c.progressive);if("array"==j)d=c.progressive;else if(a.isFunction(c.progressive))d=c.progressive(c);else if("string"==j){if(e=a(c.progressive),d=a.trim(e.html()),!d)return;if(/^(\[)/.test(d))try{d=a.parseJSON(d)}catch(k){return void f.log("error parsing progressive slides",k)}else d=d.split(new RegExp(e.data("cycle-split")||"\n")),d[d.length-1]||d.pop()}i&&(f.prepareTx=function(a,b){var e,f;return a||0===d.length?void i.apply(c.API,[a,b]):void(b&&c.currSlide==c.slideCount-1?(f=d[0],d=d.slice(1),c.container.one("cycle-slide-added",function(a,b){setTimeout(function(){b.API.advanceSlide(1)},50)}),c.API.add(f)):b||0!==c.currSlide?i.apply(c.API,[a,b]):(e=d.length-1,f=d[e],d=d.slice(0,e),c.container.one("cycle-slide-added",function(a,b){setTimeout(function(){b.currSlide=1,b.API.advanceSlide(-1)},50)}),c.API.add(f,!0)))}),g&&(f.next=function(){var a=this.opts();if(d.length&&a.currSlide==a.slideCount-1){var b=d[0];d=d.slice(1),a.container.one("cycle-slide-added",function(a,b){g.apply(b.API),b.container.removeClass("cycle-loading")}),a.container.addClass("cycle-loading"),a.API.add(b)}else g.apply(a.API)}),h&&(f.prev=function(){var a=this.opts();if(d.length&&0===a.currSlide){var b=d.length-1,c=d[b];d=d.slice(0,b),a.container.one("cycle-slide-added",function(a,b){b.currSlide=1,b.API.advanceSlide(-1),b.container.removeClass("cycle-loading")}),a.container.addClass("cycle-loading"),a.API.add(c,!0)}else h.apply(a.API)})}})}(jQuery),function(a){"use strict";a.extend(a.fn.cycle.defaults,{tmplRegex:"{{((.)?.*?)}}"}),a.extend(a.fn.cycle.API,{tmpl:function(b,c){var d=new RegExp(c.tmplRegex||a.fn.cycle.defaults.tmplRegex,"g"),e=a.makeArray(arguments);return e.shift(),b.replace(d,function(b,c){var d,f,g,h,i=c.split(".");for(d=0;d<e.length;d++)if(g=e[d]){if(i.length>1)for(h=g,f=0;f<i.length;f++)g=h,h=h[i[f]]||c;else h=g[c];if(a.isFunction(h))return h.apply(g,e);if(void 0!==h&&null!==h&&h!=c)return h}return c})}})}(jQuery),function($){"use strict";function cleartype(before,opts,el){if(before&&el.style.filter){opts._filter=el.style.filter;try{el.style.removeAttribute("filter")}catch(smother){}}else!before&&opts._filter&&(el.style.filter=opts._filter)}$.extend($.fn.cycle.transitions,{fade:{before:function(opts,curr,next,fwd){var css=opts.API.getSlideOpts(opts.nextSlide).slideCss||{};opts.API.stackSlides(curr,next,fwd),opts.cssBefore=$.extend(css,{opacity:0,visibility:"visible",display:"block"}),opts.animIn={opacity:1},opts.animOut={opacity:0},cleartype(!0,opts,next)},after:function(opts,curr,next){cleartype(!1,opts,next)}},fadeout:{before:function(opts,curr,next,fwd){var css=opts.API.getSlideOpts(opts.nextSlide).slideCss||{};opts.API.stackSlides(curr,next,fwd),opts.cssAfter=$.extend(css,{opacity:0,visibility:"hidden"}),opts.cssBefore=$.extend(css,{opacity:1,visibility:"visible",display:"block"}),opts.animOut={opacity:0},cleartype(!0,opts,next)},after:function(opts,curr,next){cleartype(!1,opts,next)}}})}(jQuery),function($){"use strict";"ontouchend"in document;$.event.special.swipe=$.event.special.swipe||{scrollSupressionThreshold:10,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:75,setup:function(){var $this=$(this);$this.bind("touchstart",function(event){function moveHandler(event){if(start){var data=event.originalEvent.touches?event.originalEvent.touches[0]:event;stop={time:(new Date).getTime(),coords:[data.pageX,data.pageY]},Math.abs(start.coords[0]-stop.coords[0])>$.event.special.swipe.scrollSupressionThreshold&&event.preventDefault()}}var stop,data=event.originalEvent.touches?event.originalEvent.touches[0]:event,start={time:(new Date).getTime(),coords:[data.pageX,data.pageY],origin:$(event.target)};$this.bind("touchmove",moveHandler).one("touchend",function(event){$this.unbind("touchmove",moveHandler),start&&stop&&stop.time-start.time<$.event.special.swipe.durationThreshold&&Math.abs(start.coords[0]-stop.coords[0])>$.event.special.swipe.horizontalDistanceThreshold&&Math.abs(start.coords[1]-stop.coords[1])<$.event.special.swipe.verticalDistanceThreshold&&start.origin.trigger("swipe").trigger(start.coords[0]>stop.coords[0]?"swipeleft":"swiperight"),start=stop=void 0})})}},$.event.special.swipeleft=$.event.special.swipeleft||{setup:function(){$(this).bind("swipe",$.noop)}},$.event.special.swiperight=$.event.special.swiperight||$.event.special.swipeleft}(jQuery),function(window){function createTimer(set,map,args){function callback(){cb&&(cb.apply(window,arguments),repeat||(delete map[id],cb=null))}var id,cb=args[0],repeat=set===orgSetInterval;return args[0]=callback,id=set.apply(window,args),map[id]={args:args,created:Date.now(),cb:cb,id:id},id}function resetTimer(set,clear,map,virtualId,correctInterval){function callback(){timer.cb&&(timer.cb.apply(window,arguments),repeat||(delete map[virtualId],timer.cb=null))}var timer=map[virtualId];if(timer){var repeat=set===orgSetInterval;if(clear(timer.id),!repeat){var interval=timer.args[1],reduction=Date.now()-timer.created;0>reduction&&(reduction=0),interval-=reduction,0>interval&&(interval=0),timer.args[1]=interval}timer.args[0]=callback,timer.created=Date.now(),timer.id=set.apply(window,timer.args)}}var timeouts={},intervals={},orgSetTimeout=window.setTimeout,orgSetInterval=window.setInterval,orgClearTimeout=window.clearTimeout,orgClearInterval=window.clearInterval;if(!window.addEventListener)return!1;window.setTimeout=function(){return createTimer(orgSetTimeout,timeouts,arguments)},window.setInterval=function(){return createTimer(orgSetInterval,intervals,arguments)},window.clearTimeout=function(id){var timer=timeouts[id];timer&&(delete timeouts[id],orgClearTimeout(timer.id))},window.clearInterval=function(id){var timer=intervals[id];timer&&(delete intervals[id],orgClearInterval(timer.id))};for(var win=window;win.location!=win.parent.location;)win=win.parent;win.addEventListener("scroll",function(){var virtualId;for(virtualId in timeouts)resetTimer(orgSetTimeout,orgClearTimeout,timeouts,virtualId);for(virtualId in intervals)resetTimer(orgSetInterval,orgClearInterval,intervals,virtualId)})}(window),!function(e){function t(e){var t=e.length,r=$.type(e);return"function"===r||$.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===r||0===t||"number"==typeof t&&t>0&&t-1 in e}if(!e.jQuery){var $=function(e,t){return new $.fn.init(e,t)};$.isWindow=function(e){return null!=e&&e==e.window},$.type=function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?a[o.call(e)]||"object":typeof e},$.isArray=Array.isArray||function(e){return"array"===$.type(e)},$.isPlainObject=function(e){var t;if(!e||"object"!==$.type(e)||e.nodeType||$.isWindow(e))return!1;try{if(e.constructor&&!n.call(e,"constructor")&&!n.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}for(t in e);return void 0===t||n.call(e,t)},$.each=function(e,r,a){var n,o=0,i=e.length,s=t(e);if(a){if(s)for(;i>o&&(n=r.apply(e[o],a),n!==!1);o++);else for(o in e)if(n=r.apply(e[o],a),n===!1)break}else if(s)for(;i>o&&(n=r.call(e[o],o,e[o]),n!==!1);o++);else for(o in e)if(n=r.call(e[o],o,e[o]),n===!1)break;return e},$.data=function(e,t,a){if(void 0===a){var n=e[$.expando],o=n&&r[n];if(void 0===t)return o;if(o&&t in o)return o[t]}else if(void 0!==t){var n=e[$.expando]||(e[$.expando]=++$.uuid);return r[n]=r[n]||{},r[n][t]=a,a}},$.removeData=function(e,t){var a=e[$.expando],n=a&&r[a];n&&$.each(t,function(e,t){delete n[t]})},$.extend=function(){var e,t,r,a,n,o,i=arguments[0]||{},s=1,l=arguments.length,u=!1;for("boolean"==typeof i&&(u=i,i=arguments[s]||{},s++),"object"!=typeof i&&"function"!==$.type(i)&&(i={}),s===l&&(i=this,s--);l>s;s++)if(null!=(n=arguments[s]))for(a in n)e=i[a],r=n[a],i!==r&&(u&&r&&($.isPlainObject(r)||(t=$.isArray(r)))?(t?(t=!1,o=e&&$.isArray(e)?e:[]):o=e&&$.isPlainObject(e)?e:{},i[a]=$.extend(u,o,r)):void 0!==r&&(i[a]=r));return i},$.queue=function(e,r,a){function n(e,r){var a=r||[];return null!=e&&(t(Object(e))?!function(e,t){for(var r=+t.length,a=0,n=e.length;r>a;)e[n++]=t[a++];if(r!==r)for(;void 0!==t[a];)e[n++]=t[a++];return e.length=n,e}(a,"string"==typeof e?[e]:e):[].push.call(a,e)),a}if(e){r=(r||"fx")+"queue";var o=$.data(e,r);return a?(!o||$.isArray(a)?o=$.data(e,r,n(a)):o.push(a),o):o||[]}},$.dequeue=function(e,t){$.each(e.nodeType?[e]:e,function(e,r){t=t||"fx";var a=$.queue(r,t),n=a.shift();"inprogress"===n&&(n=a.shift()),n&&("fx"===t&&a.unshift("inprogress"),n.call(r,function(){$.dequeue(r,t)}))})},$.fn=$.prototype={init:function(e){if(e.nodeType)return this[0]=e,this;throw new Error("Not a DOM node.")},offset:function(){var t=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:t.top+(e.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:t.left+(e.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function e(){for(var e=this.offsetParent||document;e&&"html"===!e.nodeType.toLowerCase&&"static"===e.style.position;)e=e.offsetParent;return e||document}var t=this[0],e=e.apply(t),r=this.offset(),a=/^(?:body|html)$/i.test(e.nodeName)?{top:0,left:0}:$(e).offset();return r.top-=parseFloat(t.style.marginTop)||0,r.left-=parseFloat(t.style.marginLeft)||0,e.style&&(a.top+=parseFloat(e.style.borderTopWidth)||0,a.left+=parseFloat(e.style.borderLeftWidth)||0),{top:r.top-a.top,left:r.left-a.left}}};var r={};$.expando="velocity"+(new Date).getTime(),$.uuid=0;for(var a={},n=a.hasOwnProperty,o=a.toString,i="Boolean Number String Function Array Date RegExp Object Error".split(" "),s=0;s<i.length;s++)a["[object "+i[s]+"]"]=i[s].toLowerCase();$.fn.init.prototype=$.fn,e.Velocity={Utilities:$}}}(window),function(e){"object"==typeof module&&"object"==typeof module.exports?module.exports=e():"function"==typeof define&&define.amd?define(e):e()}(function(){return function(e,t,r,a){function n(e){for(var t=-1,r=e?e.length:0,a=[];++t<r;){var n=e[t];n&&a.push(n)}return a}function o(e){return g.isWrapped(e)?e=[].slice.call(e):g.isNode(e)&&(e=[e]),e}function i(e){var t=$.data(e,"velocity");return null===t?a:t}function s(e){return function(t){return Math.round(t*e)*(1/e)}}function l(e,r,a,n){function o(e,t){return 1-3*t+3*e}function i(e,t){return 3*t-6*e}function s(e){return 3*e}function l(e,t,r){return((o(t,r)*e+i(t,r))*e+s(t))*e}function u(e,t,r){return 3*o(t,r)*e*e+2*i(t,r)*e+s(t)}function c(t,r){for(var n=0;m>n;++n){var o=u(r,e,a);if(0===o)return r;var i=l(r,e,a)-t;r-=i/o}return r}function p(){for(var t=0;b>t;++t)w[t]=l(t*x,e,a)}function f(t,r,n){var o,i,s=0;do i=r+(n-r)/2,o=l(i,e,a)-t,o>0?n=i:r=i;while(Math.abs(o)>h&&++s<v);return i}function d(t){for(var r=0,n=1,o=b-1;n!=o&&w[n]<=t;++n)r+=x;--n;var i=(t-w[n])/(w[n+1]-w[n]),s=r+i*x,l=u(s,e,a);return l>=y?c(t,s):0==l?s:f(t,r,r+x)}function g(){V=!0,(e!=r||a!=n)&&p()}var m=4,y=.001,h=1e-7,v=10,b=11,x=1/(b-1),S="Float32Array"in t;if(4!==arguments.length)return!1;for(var P=0;4>P;++P)if("number"!=typeof arguments[P]||isNaN(arguments[P])||!isFinite(arguments[P]))return!1;e=Math.min(e,1),a=Math.min(a,1),e=Math.max(e,0),a=Math.max(a,0);var w=S?new Float32Array(b):new Array(b),V=!1,C=function(t){return V||g(),e===r&&a===n?t:0===t?0:1===t?1:l(d(t),r,n)};C.getControlPoints=function(){return[{x:e,y:r},{x:a,y:n}]};var T="generateBezier("+[e,r,a,n]+")";return C.toString=function(){return T},C}function u(e,t){var r=e;return g.isString(e)?v.Easings[e]||(r=!1):r=g.isArray(e)&&1===e.length?s.apply(null,e):g.isArray(e)&&2===e.length?b.apply(null,e.concat([t])):g.isArray(e)&&4===e.length?l.apply(null,e):!1,r===!1&&(r=v.Easings[v.defaults.easing]?v.defaults.easing:h),r}function c(e){if(e){var t=(new Date).getTime(),r=v.State.calls.length;r>1e4&&(v.State.calls=n(v.State.calls));for(var o=0;r>o;o++)if(v.State.calls[o]){var s=v.State.calls[o],l=s[0],u=s[2],f=s[3],d=!!f,m=null;f||(f=v.State.calls[o][3]=t-16);for(var y=Math.min((t-f)/u.duration,1),h=0,b=l.length;b>h;h++){var S=l[h],w=S.element;if(i(w)){var V=!1;if(u.display!==a&&null!==u.display&&"none"!==u.display){if("flex"===u.display){var C=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];$.each(C,function(e,t){x.setPropertyValue(w,"display",t)})}x.setPropertyValue(w,"display",u.display)}u.visibility!==a&&"hidden"!==u.visibility&&x.setPropertyValue(w,"visibility",u.visibility);for(var T in S)if("element"!==T){var A,k=S[T],F=g.isString(k.easing)?v.Easings[k.easing]:k.easing;if(1===y)A=k.endValue;else{var E=k.endValue-k.startValue;if(A=k.startValue+E*F(y,u,E),!d&&A===k.currentValue)continue}if(k.currentValue=A,"tween"===T)m=A;else{if(x.Hooks.registered[T]){var j=x.Hooks.getRoot(T),H=i(w).rootPropertyValueCache[j];H&&(k.rootPropertyValue=H)}var N=x.setPropertyValue(w,T,k.currentValue+(0===parseFloat(A)?"":k.unitType),k.rootPropertyValue,k.scrollData);x.Hooks.registered[T]&&(i(w).rootPropertyValueCache[j]=x.Normalizations.registered[j]?x.Normalizations.registered[j]("extract",null,N[1]):N[1]),"transform"===N[0]&&(V=!0)}}u.mobileHA&&i(w).transformCache.translate3d===a&&(i(w).transformCache.translate3d="(0px, 0px, 0px)",V=!0),V&&x.flushTransformCache(w)}}u.display!==a&&"none"!==u.display&&(v.State.calls[o][2].display=!1),u.visibility!==a&&"hidden"!==u.visibility&&(v.State.calls[o][2].visibility=!1),u.progress&&u.progress.call(s[1],s[1],y,Math.max(0,f+u.duration-t),f,m),1===y&&p(o)}}v.State.isTicking&&P(c)}function p(e,t){if(!v.State.calls[e])return!1;for(var r=v.State.calls[e][0],n=v.State.calls[e][1],o=v.State.calls[e][2],s=v.State.calls[e][4],l=!1,u=0,c=r.length;c>u;u++){var p=r[u].element;if(t||o.loop||("none"===o.display&&x.setPropertyValue(p,"display",o.display),"hidden"===o.visibility&&x.setPropertyValue(p,"visibility",o.visibility)),o.loop!==!0&&($.queue(p)[1]===a||!/\.velocityQueueEntryFlag/i.test($.queue(p)[1]))&&i(p)){i(p).isAnimating=!1,i(p).rootPropertyValueCache={};var f=!1;$.each(x.Lists.transforms3D,function(e,t){var r=/^scale/.test(t)?1:0,n=i(p).transformCache[t];i(p).transformCache[t]!==a&&new RegExp("^\\("+r+"[^.]").test(n)&&(f=!0,delete i(p).transformCache[t])}),o.mobileHA&&(f=!0,delete i(p).transformCache.translate3d),f&&x.flushTransformCache(p),x.Values.removeClass(p,"velocity-animating")}if(!t&&o.complete&&!o.loop&&u===c-1)try{o.complete.call(n,n)}catch(d){setTimeout(function(){throw d},1)}s&&o.loop!==!0&&s(n),i(p)&&o.loop===!0&&!t&&($.each(i(p).tweensContainer,function(e,t){/^rotate/.test(e)&&360===parseFloat(t.endValue)&&(t.endValue=0,t.startValue=360),/^backgroundPosition/.test(e)&&100===parseFloat(t.endValue)&&"%"===t.unitType&&(t.endValue=0,t.startValue=100)}),v(p,"reverse",{loop:!0,delay:o.delay})),o.queue!==!1&&$.dequeue(p,o.queue)}v.State.calls[e]=!1;for(var g=0,m=v.State.calls.length;m>g;g++)if(v.State.calls[g]!==!1){l=!0;break}l===!1&&(v.State.isTicking=!1,delete v.State.calls,v.State.calls=[])}var $,f=function(){if(r.documentMode)return r.documentMode;for(var e=7;e>4;e--){var t=r.createElement("div");if(t.innerHTML="<!--[if IE "+e+"]><span></span><![endif]-->",t.getElementsByTagName("span").length)return t=null,e}return a}(),d=function(){var e=0;return t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||function(t){var a,r=(new Date).getTime();return a=Math.max(0,16-(r-e)),e=r+a,setTimeout(function(){t(r+a)},a)}}(),g={isString:function(e){return"string"==typeof e},isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)},isNode:function(e){return e&&e.nodeType},isNodeList:function(e){return"object"==typeof e&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(e))&&e.length!==a&&(0===e.length||"object"==typeof e[0]&&e[0].nodeType>0)},isWrapped:function(e){return e&&(e.jquery||t.Zepto&&t.Zepto.zepto.isZ(e))},isSVG:function(e){return t.SVGElement&&e instanceof t.SVGElement},isEmptyObject:function(e){for(var t in e)return!1;return!0}},m=!1;if(e.fn&&e.fn.jquery?($=e,m=!0):$=t.Velocity.Utilities,8>=f&&!m)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(7>=f)return void(jQuery.fn.velocity=jQuery.fn.animate);var y=400,h="swing",v={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:t.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:r.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:$,Redirects:{},Easings:{},Promise:t.Promise,defaults:{queue:"",duration:y,easing:h,begin:a,complete:a,progress:a,display:a,visibility:a,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(e){$.data(e,"velocity",{isSVG:g.isSVG(e),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:2,patch:2},debug:!1};t.pageYOffset!==a?(v.State.scrollAnchor=t,v.State.scrollPropertyLeft="pageXOffset",v.State.scrollPropertyTop="pageYOffset"):(v.State.scrollAnchor=r.documentElement||r.body.parentNode||r.body,v.State.scrollPropertyLeft="scrollLeft",v.State.scrollPropertyTop="scrollTop");var b=function(){function e(e){return-e.tension*e.x-e.friction*e.v}function t(t,r,a){var n={x:t.x+a.dx*r,v:t.v+a.dv*r,tension:t.tension,friction:t.friction};return{dx:n.v,dv:e(n)}}function r(r,a){var n={dx:r.v,dv:e(r)},o=t(r,.5*a,n),i=t(r,.5*a,o),s=t(r,a,i),l=1/6*(n.dx+2*(o.dx+i.dx)+s.dx),u=1/6*(n.dv+2*(o.dv+i.dv)+s.dv);return r.x=r.x+l*a,r.v=r.v+u*a,r}return function a(e,t,n){var c,p,f,o={x:-1,v:0,tension:null,friction:null},i=[0],s=0,l=1e-4,u=.016;for(e=parseFloat(e)||500,t=parseFloat(t)||20,n=n||null,o.tension=e,o.friction=t,c=null!==n,c?(s=a(e,t),p=s/n*u):p=u;f=r(f||o,p),i.push(1+f.x),s+=16,Math.abs(f.x)>l&&Math.abs(f.v)>l;);return c?function(e){return i[e*(i.length-1)|0]}:s}}();v.Easings={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},spring:function(e){return 1-Math.cos(4.5*e*Math.PI)*Math.exp(6*-e)}},$.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(e,t){v.Easings[t[0]]=l.apply(null,t[1])});var x=v.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var e=0;e<x.Lists.colors.length;e++){var t="color"===x.Lists.colors[e]?"0 0 0 1":"255 255 255 1";x.Hooks.templates[x.Lists.colors[e]]=["Red Green Blue Alpha",t]}var r,a,n;if(f)for(r in x.Hooks.templates){a=x.Hooks.templates[r],n=a[0].split(" ");var o=a[1].match(x.RegEx.valueSplit);"Color"===n[0]&&(n.push(n.shift()),o.push(o.shift()),x.Hooks.templates[r]=[n.join(" "),o.join(" ")])}for(r in x.Hooks.templates){a=x.Hooks.templates[r],n=a[0].split(" ");for(var e in n){var i=r+n[e],s=e;x.Hooks.registered[i]=[r,s]}}},getRoot:function(e){var t=x.Hooks.registered[e];return t?t[0]:e},cleanRootPropertyValue:function(e,t){return x.RegEx.valueUnwrap.test(t)&&(t=t.match(x.RegEx.valueUnwrap)[1]),x.Values.isCSSNullValue(t)&&(t=x.Hooks.templates[e][1]),t},extractValue:function(e,t){var r=x.Hooks.registered[e];if(r){var a=r[0],n=r[1];return t=x.Hooks.cleanRootPropertyValue(a,t),t.toString().match(x.RegEx.valueSplit)[n]}return t},injectValue:function(e,t,r){var a=x.Hooks.registered[e];if(a){var i,s,n=a[0],o=a[1];return r=x.Hooks.cleanRootPropertyValue(n,r),i=r.toString().match(x.RegEx.valueSplit),i[o]=t,s=i.join(" ")}return r}},Normalizations:{registered:{clip:function(e,t,r){switch(e){case"name":return"clip";case"extract":var a;return x.RegEx.wrappedValueAlreadyExtracted.test(r)?a=r:(a=r.toString().match(x.RegEx.valueUnwrap),a=a?a[1].replace(/,(\s+)?/g," "):r),a;case"inject":return"rect("+r+")"}},blur:function(e,t,r){switch(e){case"name":return v.State.isFirefox?"filter":"-webkit-filter";case"extract":var a=parseFloat(r);if(!a&&0!==a){var n=r.toString().match(/blur\(([0-9]+[A-z]+)\)/i);a=n?n[1]:0}return a;case"inject":return parseFloat(r)?"blur("+r+")":"none"}},opacity:function(e,t,r){if(8>=f)switch(e){case"name":return"filter";case"extract":var a=r.toString().match(/alpha\(opacity=(.*)\)/i);return r=a?a[1]/100:1;case"inject":return t.style.zoom=1,parseFloat(r)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(r),10)+")"}else switch(e){case"name":return"opacity";case"extract":return r;case"inject":return r}}},register:function(){9>=f||v.State.isGingerbread||(x.Lists.transformsBase=x.Lists.transformsBase.concat(x.Lists.transforms3D));for(var e=0;e<x.Lists.transformsBase.length;e++)!function(){var t=x.Lists.transformsBase[e];x.Normalizations.registered[t]=function(e,r,n){switch(e){case"name":return"transform";case"extract":return i(r)===a||i(r).transformCache[t]===a?/^scale/i.test(t)?1:0:i(r).transformCache[t].replace(/[()]/g,"");case"inject":var o=!1;switch(t.substr(0,t.length-1)){case"translate":o=!/(%|px|em|rem|vw|vh|\d)$/i.test(n);break;case"scal":case"scale":v.State.isAndroid&&i(r).transformCache[t]===a&&1>n&&(n=1),o=!/(\d)$/i.test(n);break;case"skew":o=!/(deg|\d)$/i.test(n);break;case"rotate":o=!/(deg|\d)$/i.test(n)}return o||(i(r).transformCache[t]="("+n+")"),i(r).transformCache[t]}}}();for(var e=0;e<x.Lists.colors.length;e++)!function(){var t=x.Lists.colors[e];x.Normalizations.registered[t]=function(e,r,n){switch(e){case"name":return t;case"extract":var o;if(x.RegEx.wrappedValueAlreadyExtracted.test(n))o=n;else{var i,s={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(n)?i=s[n]!==a?s[n]:s.black:x.RegEx.isHex.test(n)?i="rgb("+x.Values.hexToRgb(n).join(" ")+")":/^rgba?\(/i.test(n)||(i=s.black),o=(i||n).toString().match(x.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return 8>=f||3!==o.split(" ").length||(o+=" 1"),o;case"inject":return 8>=f?4===n.split(" ").length&&(n=n.split(/\s+/).slice(0,3).join(" ")):3===n.split(" ").length&&(n+=" 1"),(8>=f?"rgb":"rgba")+"("+n.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")"}}}()}},Names:{camelCase:function(e){return e.replace(/-(\w)/g,function(e,t){return t.toUpperCase()})},SVGAttribute:function(e){var t="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(f||v.State.isAndroid&&!v.State.isChrome)&&(t+="|transform"),new RegExp("^("+t+")$","i").test(e)},prefixCheck:function(e){if(v.State.prefixMatches[e])return[v.State.prefixMatches[e],!0];for(var t=["","Webkit","Moz","ms","O"],r=0,a=t.length;a>r;r++){var n;if(n=0===r?e:t[r]+e.replace(/^\w/,function(e){return e.toUpperCase()}),g.isString(v.State.prefixElement.style[n]))return v.State.prefixMatches[e]=n,[n,!0]}return[e,!1]}},Values:{hexToRgb:function(e){var a,t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;return e=e.replace(t,function(e,t,r,a){return t+t+r+r+a+a}),a=r.exec(e),a?[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]:[0,0,0]},isCSSNullValue:function(e){return 0==e||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(e)},getUnitType:function(e){return/^(rotate|skew)/i.test(e)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(e)?"":"px"},getDisplayType:function(e){var t=e&&e.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(t)?"inline":/^(li)$/i.test(t)?"list-item":/^(tr)$/i.test(t)?"table-row":/^(table)$/i.test(t)?"table":/^(tbody)$/i.test(t)?"table-row-group":"block"},addClass:function(e,t){e.classList?e.classList.add(t):e.className+=(e.className.length?" ":"")+t},removeClass:function(e,t){e.classList?e.classList.remove(t):e.className=e.className.toString().replace(new RegExp("(^|\\s)"+t.split(" ").join("|")+"(\\s|$)","gi")," ")}},getPropertyValue:function(e,r,n,o){function s(e,r){function n(){u&&x.setPropertyValue(e,"display","none")}var l=0;if(8>=f)l=$.css(e,r);else{var u=!1;if(/^(width|height)$/.test(r)&&0===x.getPropertyValue(e,"display")&&(u=!0,x.setPropertyValue(e,"display",x.Values.getDisplayType(e))),!o){if("height"===r&&"border-box"!==x.getPropertyValue(e,"boxSizing").toString().toLowerCase()){var c=e.offsetHeight-(parseFloat(x.getPropertyValue(e,"borderTopWidth"))||0)-(parseFloat(x.getPropertyValue(e,"borderBottomWidth"))||0)-(parseFloat(x.getPropertyValue(e,"paddingTop"))||0)-(parseFloat(x.getPropertyValue(e,"paddingBottom"))||0);return n(),c}if("width"===r&&"border-box"!==x.getPropertyValue(e,"boxSizing").toString().toLowerCase()){var p=e.offsetWidth-(parseFloat(x.getPropertyValue(e,"borderLeftWidth"))||0)-(parseFloat(x.getPropertyValue(e,"borderRightWidth"))||0)-(parseFloat(x.getPropertyValue(e,"paddingLeft"))||0)-(parseFloat(x.getPropertyValue(e,"paddingRight"))||0);return n(),p}}var d;d=i(e)===a?t.getComputedStyle(e,null):i(e).computedStyle?i(e).computedStyle:i(e).computedStyle=t.getComputedStyle(e,null),"borderColor"===r&&(r="borderTopColor"),l=9===f&&"filter"===r?d.getPropertyValue(r):d[r],(""===l||null===l)&&(l=e.style[r]),n()}if("auto"===l&&/^(top|right|bottom|left)$/i.test(r)){var g=s(e,"position");("fixed"===g||"absolute"===g&&/top|left/i.test(r))&&(l=$(e).position()[r]+"px")}return l}var l;if(x.Hooks.registered[r]){var u=r,c=x.Hooks.getRoot(u);n===a&&(n=x.getPropertyValue(e,x.Names.prefixCheck(c)[0])),x.Normalizations.registered[c]&&(n=x.Normalizations.registered[c]("extract",e,n)),l=x.Hooks.extractValue(u,n)}else if(x.Normalizations.registered[r]){var p,d;p=x.Normalizations.registered[r]("name",e),"transform"!==p&&(d=s(e,x.Names.prefixCheck(p)[0]),x.Values.isCSSNullValue(d)&&x.Hooks.templates[r]&&(d=x.Hooks.templates[r][1])),l=x.Normalizations.registered[r]("extract",e,d)}if(!/^[\d-]/.test(l))if(i(e)&&i(e).isSVG&&x.Names.SVGAttribute(r))if(/^(height|width)$/i.test(r))try{l=e.getBBox()[r]}catch(g){l=0}else l=e.getAttribute(r);else l=s(e,x.Names.prefixCheck(r)[0]);return x.Values.isCSSNullValue(l)&&(l=0),v.debug>=2&&console.log("Get "+r+": "+l),l},setPropertyValue:function(e,r,a,n,o){var s=r;if("scroll"===r)o.container?o.container["scroll"+o.direction]=a:"Left"===o.direction?t.scrollTo(a,o.alternateValue):t.scrollTo(o.alternateValue,a);else if(x.Normalizations.registered[r]&&"transform"===x.Normalizations.registered[r]("name",e))x.Normalizations.registered[r]("inject",e,a),s="transform",a=i(e).transformCache[r];else{
if(x.Hooks.registered[r]){var l=r,u=x.Hooks.getRoot(r);n=n||x.getPropertyValue(e,u),a=x.Hooks.injectValue(l,a,n),r=u}if(x.Normalizations.registered[r]&&(a=x.Normalizations.registered[r]("inject",e,a),r=x.Normalizations.registered[r]("name",e)),s=x.Names.prefixCheck(r)[0],8>=f)try{e.style[s]=a}catch(c){v.debug&&console.log("Browser does not support ["+a+"] for ["+s+"]")}else i(e)&&i(e).isSVG&&x.Names.SVGAttribute(r)?e.setAttribute(r,a):e.style[s]=a;v.debug>=2&&console.log("Set "+r+" ("+s+"): "+a)}return[s,a]},flushTransformCache:function(e){function t(t){return parseFloat(x.getPropertyValue(e,t))}var r="";if((f||v.State.isAndroid&&!v.State.isChrome)&&i(e).isSVG){var a={translate:[t("translateX"),t("translateY")],skewX:[t("skewX")],skewY:[t("skewY")],scale:1!==t("scale")?[t("scale"),t("scale")]:[t("scaleX"),t("scaleY")],rotate:[t("rotateZ"),0,0]};$.each(i(e).transformCache,function(e){/^translate/i.test(e)?e="translate":/^scale/i.test(e)?e="scale":/^rotate/i.test(e)&&(e="rotate"),a[e]&&(r+=e+"("+a[e].join(" ")+") ",delete a[e])})}else{var n,o;$.each(i(e).transformCache,function(t){return n=i(e).transformCache[t],"transformPerspective"===t?(o=n,!0):(9===f&&"rotateZ"===t&&(t="rotate"),void(r+=t+n+" "))}),o&&(r="perspective"+o+" "+r)}x.setPropertyValue(e,"transform",r)}};x.Hooks.register(),x.Normalizations.register(),v.hook=function(e,t,r){var n=a;return e=o(e),$.each(e,function(e,o){if(i(o)===a&&v.init(o),r===a)n===a&&(n=v.CSS.getPropertyValue(o,t));else{var s=v.CSS.setPropertyValue(o,t,r);"transform"===s[0]&&v.CSS.flushTransformCache(o),n=s}}),n};var S=function(){function e(){return l?T.promise||null:f}function n(){function e(e){function p(e,t){var r=a,i=a,s=a;return g.isArray(e)?(r=e[0],!g.isArray(e[1])&&/^[\d-]/.test(e[1])||g.isFunction(e[1])||x.RegEx.isHex.test(e[1])?s=e[1]:(g.isString(e[1])&&!x.RegEx.isHex.test(e[1])||g.isArray(e[1]))&&(i=t?e[1]:u(e[1],o.duration),e[2]!==a&&(s=e[2]))):r=e,t||(i=i||o.easing),g.isFunction(r)&&(r=r.call(n,w,P)),g.isFunction(s)&&(s=s.call(n,w,P)),[r||0,i,s]}function f(e,t){var r,a;return a=(t||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(e){return r=e,""}),r||(r=x.Values.getUnitType(e)),[a,r]}function d(){var e={myParent:n.parentNode||r.body,position:x.getPropertyValue(n,"position"),fontSize:x.getPropertyValue(n,"fontSize")},a=e.position===N.lastPosition&&e.myParent===N.lastParent,o=e.fontSize===N.lastFontSize;N.lastParent=e.myParent,N.lastPosition=e.position,N.lastFontSize=e.fontSize;var s=100,l={};if(o&&a)l.emToPx=N.lastEmToPx,l.percentToPxWidth=N.lastPercentToPxWidth,l.percentToPxHeight=N.lastPercentToPxHeight;else{var u=i(n).isSVG?r.createElementNS("http://www.w3.org/2000/svg","rect"):r.createElement("div");v.init(u),e.myParent.appendChild(u),$.each(["overflow","overflowX","overflowY"],function(e,t){v.CSS.setPropertyValue(u,t,"hidden")}),v.CSS.setPropertyValue(u,"position",e.position),v.CSS.setPropertyValue(u,"fontSize",e.fontSize),v.CSS.setPropertyValue(u,"boxSizing","content-box"),$.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(e,t){v.CSS.setPropertyValue(u,t,s+"%")}),v.CSS.setPropertyValue(u,"paddingLeft",s+"em"),l.percentToPxWidth=N.lastPercentToPxWidth=(parseFloat(x.getPropertyValue(u,"width",null,!0))||1)/s,l.percentToPxHeight=N.lastPercentToPxHeight=(parseFloat(x.getPropertyValue(u,"height",null,!0))||1)/s,l.emToPx=N.lastEmToPx=(parseFloat(x.getPropertyValue(u,"paddingLeft"))||1)/s,e.myParent.removeChild(u)}return null===N.remToPx&&(N.remToPx=parseFloat(x.getPropertyValue(r.body,"fontSize"))||16),null===N.vwToPx&&(N.vwToPx=parseFloat(t.innerWidth)/100,N.vhToPx=parseFloat(t.innerHeight)/100),l.remToPx=N.remToPx,l.vwToPx=N.vwToPx,l.vhToPx=N.vhToPx,v.debug>=1&&console.log("Unit ratios: "+JSON.stringify(l),n),l}if(o.begin&&0===w)try{o.begin.call(m,m)}catch(y){setTimeout(function(){throw y},1)}if("scroll"===k){var C,A,F,S=/^x$/i.test(o.axis)?"Left":"Top",V=parseFloat(o.offset)||0;o.container?g.isWrapped(o.container)||g.isNode(o.container)?(o.container=o.container[0]||o.container,C=o.container["scroll"+S],F=C+$(n).position()[S.toLowerCase()]+V):o.container=null:(C=v.State.scrollAnchor[v.State["scrollProperty"+S]],A=v.State.scrollAnchor[v.State["scrollProperty"+("Left"===S?"Top":"Left")]],F=$(n).offset()[S.toLowerCase()]+V),s={scroll:{rootPropertyValue:!1,startValue:C,currentValue:C,endValue:F,unitType:"",easing:o.easing,scrollData:{container:o.container,direction:S,alternateValue:A}},element:n},v.debug&&console.log("tweensContainer (scroll): ",s.scroll,n)}else if("reverse"===k){if(!i(n).tweensContainer)return void $.dequeue(n,o.queue);"none"===i(n).opts.display&&(i(n).opts.display="auto"),"hidden"===i(n).opts.visibility&&(i(n).opts.visibility="visible"),i(n).opts.loop=!1,i(n).opts.begin=null,i(n).opts.complete=null,b.easing||delete o.easing,b.duration||delete o.duration,o=$.extend({},i(n).opts,o);var E=$.extend(!0,{},i(n).tweensContainer);for(var j in E)if("element"!==j){var H=E[j].startValue;E[j].startValue=E[j].currentValue=E[j].endValue,E[j].endValue=H,g.isEmptyObject(b)||(E[j].easing=o.easing),v.debug&&console.log("reverse tweensContainer ("+j+"): "+JSON.stringify(E[j]),n)}s=E}else if("start"===k){var E;i(n).tweensContainer&&i(n).isAnimating===!0&&(E=i(n).tweensContainer),$.each(h,function(e,t){if(RegExp("^"+x.Lists.colors.join("$|^")+"$").test(e)){var r=p(t,!0),n=r[0],o=r[1],i=r[2];if(x.RegEx.isHex.test(n)){for(var s=["Red","Green","Blue"],l=x.Values.hexToRgb(n),u=i?x.Values.hexToRgb(i):a,c=0;c<s.length;c++){var f=[l[c]];o&&f.push(o),u!==a&&f.push(u[c]),h[e+s[c]]=f}delete h[e]}}});for(var R in h){var O=p(h[R]),z=O[0],q=O[1],M=O[2];R=x.Names.camelCase(R);var I=x.Hooks.getRoot(R),B=!1;if(i(n).isSVG||"tween"===I||x.Names.prefixCheck(I)[1]!==!1||x.Normalizations.registered[I]!==a){(o.display!==a&&null!==o.display&&"none"!==o.display||o.visibility!==a&&"hidden"!==o.visibility)&&/opacity|filter/.test(R)&&!M&&0!==z&&(M=0),o._cacheValues&&E&&E[R]?(M===a&&(M=E[R].endValue+E[R].unitType),B=i(n).rootPropertyValueCache[I]):x.Hooks.registered[R]?M===a?(B=x.getPropertyValue(n,I),M=x.getPropertyValue(n,R,B)):B=x.Hooks.templates[I][1]:M===a&&(M=x.getPropertyValue(n,R));var W,G,D,X=!1;if(W=f(R,M),M=W[0],D=W[1],W=f(R,z),z=W[0].replace(/^([+-\/*])=/,function(e,t){return X=t,""}),G=W[1],M=parseFloat(M)||0,z=parseFloat(z)||0,"%"===G&&(/^(fontSize|lineHeight)$/.test(R)?(z/=100,G="em"):/^scale/.test(R)?(z/=100,G=""):/(Red|Green|Blue)$/i.test(R)&&(z=z/100*255,G="")),/[\/*]/.test(X))G=D;else if(D!==G&&0!==M)if(0===z)G=D;else{l=l||d();var Y=/margin|padding|left|right|width|text|word|letter/i.test(R)||/X$/.test(R)||"x"===R?"x":"y";switch(D){case"%":M*="x"===Y?l.percentToPxWidth:l.percentToPxHeight;break;case"px":break;default:M*=l[D+"ToPx"]}switch(G){case"%":M*=1/("x"===Y?l.percentToPxWidth:l.percentToPxHeight);break;case"px":break;default:M*=1/l[G+"ToPx"]}}switch(X){case"+":z=M+z;break;case"-":z=M-z;break;case"*":z=M*z;break;case"/":z=M/z}s[R]={rootPropertyValue:B,startValue:M,currentValue:M,endValue:z,unitType:G,easing:q},v.debug&&console.log("tweensContainer ("+R+"): "+JSON.stringify(s[R]),n)}else v.debug&&console.log("Skipping ["+I+"] due to a lack of browser support.")}s.element=n}s.element&&(x.Values.addClass(n,"velocity-animating"),L.push(s),""===o.queue&&(i(n).tweensContainer=s,i(n).opts=o),i(n).isAnimating=!0,w===P-1?(v.State.calls.push([L,m,o,null,T.resolver]),v.State.isTicking===!1&&(v.State.isTicking=!0,c())):w++)}var l,n=this,o=$.extend({},v.defaults,b),s={};switch(i(n)===a&&v.init(n),parseFloat(o.delay)&&o.queue!==!1&&$.queue(n,o.queue,function(e){v.velocityQueueEntryFlag=!0,i(n).delayTimer={setTimeout:setTimeout(e,parseFloat(o.delay)),next:e}}),o.duration.toString().toLowerCase()){case"fast":o.duration=200;break;case"normal":o.duration=y;break;case"slow":o.duration=600;break;default:o.duration=parseFloat(o.duration)||1}v.mock!==!1&&(v.mock===!0?o.duration=o.delay=1:(o.duration*=parseFloat(v.mock)||1,o.delay*=parseFloat(v.mock)||1)),o.easing=u(o.easing,o.duration),o.begin&&!g.isFunction(o.begin)&&(o.begin=null),o.progress&&!g.isFunction(o.progress)&&(o.progress=null),o.complete&&!g.isFunction(o.complete)&&(o.complete=null),o.display!==a&&null!==o.display&&(o.display=o.display.toString().toLowerCase(),"auto"===o.display&&(o.display=v.CSS.Values.getDisplayType(n))),o.visibility!==a&&null!==o.visibility&&(o.visibility=o.visibility.toString().toLowerCase()),o.mobileHA=o.mobileHA&&v.State.isMobile&&!v.State.isGingerbread,o.queue===!1?o.delay?setTimeout(e,o.delay):e():$.queue(n,o.queue,function(t,r){return r===!0?(T.promise&&T.resolver(m),!0):(v.velocityQueueEntryFlag=!0,void e(t))}),""!==o.queue&&"fx"!==o.queue||"inprogress"===$.queue(n)[0]||$.dequeue(n)}var l,f,d,m,h,b,s=arguments[0]&&(arguments[0].p||$.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||g.isString(arguments[0].properties));if(g.isWrapped(this)?(l=!1,d=0,m=this,f=this):(l=!0,d=1,m=s?arguments[0].elements||arguments[0].e:arguments[0]),m=o(m)){s?(h=arguments[0].properties||arguments[0].p,b=arguments[0].options||arguments[0].o):(h=arguments[d],b=arguments[d+1]);var P=m.length,w=0;if(!/^(stop|finish)$/i.test(h)&&!$.isPlainObject(b)){var V=d+1;b={};for(var C=V;C<arguments.length;C++)g.isArray(arguments[C])||!/^(fast|normal|slow)$/i.test(arguments[C])&&!/^\d/.test(arguments[C])?g.isString(arguments[C])||g.isArray(arguments[C])?b.easing=arguments[C]:g.isFunction(arguments[C])&&(b.complete=arguments[C]):b.duration=arguments[C]}var T={promise:null,resolver:null,rejecter:null};l&&v.Promise&&(T.promise=new v.Promise(function(e,t){T.resolver=e,T.rejecter=t}));var k;switch(h){case"scroll":k="scroll";break;case"reverse":k="reverse";break;case"finish":case"stop":$.each(m,function(e,t){i(t)&&i(t).delayTimer&&(clearTimeout(i(t).delayTimer.setTimeout),i(t).delayTimer.next&&i(t).delayTimer.next(),delete i(t).delayTimer)});var A=[];return $.each(v.State.calls,function(e,t){t&&$.each(t[1],function(r,n){var o=b===a?"":b;return o===!0||t[2].queue===o||b===a&&t[2].queue===!1?void $.each(m,function(r,a){a===n&&((b===!0||g.isString(b))&&($.each($.queue(a,g.isString(b)?b:""),function(e,t){g.isFunction(t)&&t(null,!0)}),$.queue(a,g.isString(b)?b:"",[])),"stop"===h?(i(a)&&i(a).tweensContainer&&o!==!1&&$.each(i(a).tweensContainer,function(e,t){t.endValue=t.currentValue}),A.push(e)):"finish"===h&&(t[2].duration=1))}):!0})}),"stop"===h&&($.each(A,function(e,t){p(t,!0)}),T.promise&&T.resolver(m)),e();default:if(!$.isPlainObject(h)||g.isEmptyObject(h)){if(g.isString(h)&&v.Redirects[h]){var F=$.extend({},b),E=F.duration,j=F.delay||0;return F.backwards===!0&&(m=$.extend(!0,[],m).reverse()),$.each(m,function(e,t){parseFloat(F.stagger)?F.delay=j+parseFloat(F.stagger)*e:g.isFunction(F.stagger)&&(F.delay=j+F.stagger.call(t,e,P)),F.drag&&(F.duration=parseFloat(E)||(/^(callout|transition)/.test(h)?1e3:y),F.duration=Math.max(F.duration*(F.backwards?1-e/P:(e+1)/P),.75*F.duration,200)),v.Redirects[h].call(t,t,F||{},e,P,m,T.promise?T:a)}),e()}var H="Velocity: First argument ("+h+") was not a property map, a known action, or a registered redirect. Aborting.";return T.promise?T.rejecter(new Error(H)):console.log(H),e()}k="start"}var N={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},L=[];$.each(m,function(e,t){g.isNode(t)&&n.call(t)});var R,F=$.extend({},v.defaults,b);if(F.loop=parseInt(F.loop),R=2*F.loop-1,F.loop)for(var O=0;R>O;O++){var z={delay:F.delay,progress:F.progress};O===R-1&&(z.display=F.display,z.visibility=F.visibility,z.complete=F.complete),S(m,"reverse",z)}return e()}};v=$.extend(S,v),v.animate=S;var P=t.requestAnimationFrame||d;return v.State.isMobile||r.hidden===a||r.addEventListener("visibilitychange",function(){r.hidden?(P=function(e){return setTimeout(function(){e(!0)},16)},c()):P=t.requestAnimationFrame||d}),e.Velocity=v,e!==t&&(e.fn.velocity=S,e.fn.velocity.defaults=v.defaults),$.each(["Down","Up"],function(e,t){v.Redirects["slide"+t]=function(e,r,n,o,i,s){var l=$.extend({},r),u=l.begin,c=l.complete,p={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""},f={};l.display===a&&(l.display="Down"===t?"inline"===v.CSS.Values.getDisplayType(e)?"inline-block":"block":"none"),l.begin=function(){u&&u.call(i,i);for(var r in p){f[r]=e.style[r];var a=v.CSS.getPropertyValue(e,r);p[r]="Down"===t?[a,0]:[0,a]}f.overflow=e.style.overflow,e.style.overflow="hidden"},l.complete=function(){for(var t in f)e.style[t]=f[t];c&&c.call(i,i),s&&s.resolver(i)},v(e,p,l)}}),$.each(["In","Out"],function(e,t){v.Redirects["fade"+t]=function(e,r,n,o,i,s){var l=$.extend({},r),u={opacity:"In"===t?1:0},c=l.complete;l.complete=n!==o-1?l.begin=null:function(){c&&c.call(i,i),s&&s.resolver(i)},l.display===a&&(l.display="In"===t?"auto":"none"),v(this,u,l)}}),v}(window.jQuery||window.Zepto||window,window,document)}),!function(a,b){var c=b(a,a.document);a.lazySizes=c,"object"==typeof module&&module.exports&&(module.exports=c)}(window,function(a,b){"use strict";if(b.getElementsByClassName){var c,d,e=b.documentElement,f=a.Date,g=a.HTMLPictureElement,h="addEventListener",i="getAttribute",j=a[h],k=a.setTimeout,l=a.requestAnimationFrame||k,m=a.requestIdleCallback,n=/^picture$/i,o=["load","error","lazyincluded","_lazyloaded"],p={},q=Array.prototype.forEach,r=function(a,b){return p[b]||(p[b]=new RegExp("(\\s|^)"+b+"(\\s|$)")),p[b].test(a[i]("class")||"")&&p[b]},s=function(a,b){r(a,b)||a.setAttribute("class",(a[i]("class")||"").trim()+" "+b)},t=function(a,b){var c;(c=r(a,b))&&a.setAttribute("class",(a[i]("class")||"").replace(c," "))},u=function(a,b,c){var d=c?h:"removeEventListener";c&&u(a,b),o.forEach(function(c){a[d](c,b)})},v=function(a,d,e,f,g){var h=b.createEvent("CustomEvent");return e||(e={}),e.instance=c,h.initCustomEvent(d,!f,!g,e),a.dispatchEvent(h),h},w=function(b,c){var e;!g&&(e=a.picturefill||d.pf)?e({reevaluate:!0,elements:[b]}):c&&c.src&&(b.src=c.src)},x=function(a,b){return(getComputedStyle(a,null)||{})[b]},y=function(a,b,c){for(c=c||a.offsetWidth;c<d.minSize&&b&&!a._lazysizesWidth;)c=b.offsetWidth,b=b.parentNode;return c},z=function(){var a,c,d=[],e=[],f=d,g=function(){var b=f;for(f=d.length?e:d,a=!0,c=!1;b.length;)b.shift()();a=!1},h=function(d,e){a&&!e?d.apply(this,arguments):(f.push(d),c||(c=!0,(b.hidden?k:l)(g)))};return h._lsFlush=g,h}(),A=function(a,b){return b?function(){z(a)}:function(){var b=this,c=arguments;z(function(){a.apply(b,c)})}},B=function(a){var b,c=0,d=125,e=666,g=e,h=function(){b=!1,c=f.now(),a()},i=m?function(){m(h,{timeout:g}),g!==e&&(g=e)}:A(function(){k(h)},!0);return function(a){var e;(a=a===!0)&&(g=44),b||(b=!0,e=d-(f.now()-c),0>e&&(e=0),a||9>e&&m?i():k(i,e))}},C=function(a){var b,c,d=99,e=function(){b=null,a()},g=function(){var a=f.now()-c;d>a?k(g,d-a):(m||e)(e)};return function(){c=f.now(),b||(b=k(g,d))}},D=function(){var g,l,m,o,p,y,D,F,G,H,I,J,K,L,M=/^img$/i,N=/^iframe$/i,O="onscroll"in a&&!/glebot/.test(navigator.userAgent),P=0,Q=0,R=0,S=-1,T=function(a){R--,a&&a.target&&u(a.target,T),(!a||0>R||!a.target)&&(R=0)},U=function(a,c){var d,f=a,g="hidden"==x(b.body,"visibility")||"hidden"!=x(a,"visibility");for(F-=c,I+=c,G-=c,H+=c;g&&(f=f.offsetParent)&&f!=b.body&&f!=e;)g=(x(f,"opacity")||1)>0,g&&"visible"!=x(f,"overflow")&&(d=f.getBoundingClientRect(),g=H>d.left&&G<d.right&&I>d.top-1&&F<d.bottom+1);return g},V=function(){var a,f,h,j,k,m,n,p,q,r=c.elements;if((o=d.loadMode)&&8>R&&(a=r.length)){f=0,S++,null==K&&("expand"in d||(d.expand=e.clientHeight>500&&e.clientWidth>500?500:370),J=d.expand,K=J*d.expFactor),K>Q&&1>R&&S>2&&o>2&&!b.hidden?(Q=K,S=0):Q=o>1&&S>1&&6>R?J:P;for(;a>f;f++)if(r[f]&&!r[f]._lazyRace)if(O)if((p=r[f][i]("data-expand"))&&(m=1*p)||(m=Q),q!==m&&(y=innerWidth+m*L,D=innerHeight+m,n=-1*m,q=m),h=r[f].getBoundingClientRect(),(I=h.bottom)>=n&&(F=h.top)<=D&&(H=h.right)>=n*L&&(G=h.left)<=y&&(I||H||G||F)&&(d.loadHidden||"hidden"!=x(r[f],"visibility"))&&(l&&3>R&&!p&&(3>o||4>S)||U(r[f],m))){if(ba(r[f]),k=!0,R>9)break}else!k&&l&&!j&&4>R&&4>S&&o>2&&(g[0]||d.preloadAfterLoad)&&(g[0]||!p&&(I||H||G||F||"auto"!=r[f][i](d.sizesAttr)))&&(j=g[0]||r[f]);else ba(r[f]);j&&!k&&ba(j)}},W=B(V),X=function(a){s(a.target,d.loadedClass),t(a.target,d.loadingClass),u(a.target,Z),v(a.target,"lazyloaded")},Y=A(X),Z=function(a){Y({target:a.target})},$=function(a,b){try{a.contentWindow.location.replace(b)}catch(c){a.src=b}},_=function(a){var b,c=a[i](d.srcsetAttr);(b=d.customMedia[a[i]("data-media")||a[i]("media")])&&a.setAttribute("media",b),c&&a.setAttribute("srcset",c)},aa=A(function(a,b,c,e,f){var g,h,j,l,o,p;(o=v(a,"lazybeforeunveil",b)).defaultPrevented||(e&&(c?s(a,d.autosizesClass):a.setAttribute("sizes",e)),h=a[i](d.srcsetAttr),g=a[i](d.srcAttr),f&&(j=a.parentNode,l=j&&n.test(j.nodeName||"")),p=b.firesLoad||"src"in a&&(h||g||l),o={target:a},p&&(u(a,T,!0),clearTimeout(m),m=k(T,2500),s(a,d.loadingClass),u(a,Z,!0)),l&&q.call(j.getElementsByTagName("source"),_),h?a.setAttribute("srcset",h):g&&!l&&(N.test(a.nodeName)?$(a,g):a.src=g),f&&(h||l)&&w(a,{src:g})),a._lazyRace&&delete a._lazyRace,t(a,d.lazyClass),z(function(){(!p||a.complete&&a.naturalWidth>1)&&(p?T(o):R--,X(o))},!0)}),ba=function(a){var b,c=M.test(a.nodeName),e=c&&(a[i](d.sizesAttr)||a[i]("sizes")),f="auto"==e;(!f&&l||!c||!a[i]("src")&&!a.srcset||a.complete||r(a,d.errorClass))&&(b=v(a,"lazyunveilread").detail,f&&E.updateElem(a,!0,a.offsetWidth),a._lazyRace=!0,R++,aa(a,b,f,e,c))},ca=function(){if(!l){if(f.now()-p<999)return void k(ca,999);var a=C(function(){d.loadMode=3,W()});l=!0,d.loadMode=3,W(),j("scroll",function(){3==d.loadMode&&(d.loadMode=2),a()},!0)}};return{_:function(){p=f.now(),c.elements=b.getElementsByClassName(d.lazyClass),g=b.getElementsByClassName(d.lazyClass+" "+d.preloadClass),L=d.hFac,j("scroll",W,!0),j("resize",W,!0),a.MutationObserver?new MutationObserver(W).observe(e,{childList:!0,subtree:!0,attributes:!0}):(e[h]("DOMNodeInserted",W,!0),e[h]("DOMAttrModified",W,!0),setInterval(W,999)),j("hashchange",W,!0),["focus","mouseover","click","load","transitionend","animationend","webkitAnimationEnd"].forEach(function(a){b[h](a,W,!0)}),/d$|^c/.test(b.readyState)?ca():(j("load",ca),b[h]("DOMContentLoaded",W),k(ca,2e4)),c.elements.length?(V(),z._lsFlush()):W()},checkElems:W,unveil:ba}}(),E=function(){var a,c=A(function(a,b,c,d){var e,f,g;if(a._lazysizesWidth=d,d+="px",a.setAttribute("sizes",d),n.test(b.nodeName||""))for(e=b.getElementsByTagName("source"),f=0,g=e.length;g>f;f++)e[f].setAttribute("sizes",d);c.detail.dataAttr||w(a,c.detail)}),e=function(a,b,d){var e,f=a.parentNode;f&&(d=y(a,f,d),e=v(a,"lazybeforesizes",{width:d,dataAttr:!!b}),e.defaultPrevented||(d=e.detail.width,d&&d!==a._lazysizesWidth&&c(a,f,e,d)))},f=function(){var b,c=a.length;if(c)for(b=0;c>b;b++)e(a[b])},g=C(f);return{_:function(){a=b.getElementsByClassName(d.autosizesClass),j("resize",g)},checkElems:g,updateElem:e}}(),F=function(){F.i||(F.i=!0,E._(),D._())};return function(){var b,c={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2,loadHidden:!0};d=a.lazySizesConfig||a.lazysizesConfig||{};for(b in c)b in d||(d[b]=c[b]);a.lazySizesConfig=d,k(function(){d.init&&F()})}(),c={cfg:d,autoSizer:E,loader:D,init:F,uP:w,aC:s,rC:t,hC:r,fire:v,gW:y,rAF:z}}}),function($){"use strict";var ACTIVE_CLASS="kinetic-active";window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback,element){window.setTimeout(callback,1e3/60)}}()),$.support=$.support||{},$.extend($.support,{touch:"ontouchend"in document});var selectStart=function(){return!1},Kinetic=function(element,settings){return this.settings=settings,this.el=element,this.$el=$(element),this._initElements(),this};Kinetic.DATA_KEY="kinetic",Kinetic.DEFAULTS={cursor:"move",decelerate:!0,triggerHardware:!1,y:!0,x:!0,slowdown:.9,maxvelocity:40,throttleFPS:60,movingClass:{up:"kinetic-moving-up",down:"kinetic-moving-down",left:"kinetic-moving-left",right:"kinetic-moving-right"},deceleratingClass:{up:"kinetic-decelerating-up",down:"kinetic-decelerating-down",left:"kinetic-decelerating-left",right:"kinetic-decelerating-right"}},Kinetic.prototype.start=function(options){this.settings=$.extend(this.settings,options),this.velocity=options.velocity||this.velocity,this.velocityY=options.velocityY||this.velocityY,this.settings.decelerate=!1,this._move()},Kinetic.prototype.end=function(){this.settings.decelerate=!0},Kinetic.prototype.stop=function(){this.velocity=0,this.velocityY=0,this.settings.decelerate=!0,$.isFunction(this.settings.stopped)&&this.settings.stopped.call(this)},Kinetic.prototype.detach=function(){this._detachListeners(),this.$el.removeClass(ACTIVE_CLASS).css("cursor","")},Kinetic.prototype.attach=function(){this.$el.hasClass(ACTIVE_CLASS)||(this._attachListeners(this.$el),this.$el.addClass(ACTIVE_CLASS).css("cursor",this.settings.cursor))},Kinetic.prototype._initElements=function(){this.$el.addClass(ACTIVE_CLASS),$.extend(this,{xpos:null,prevXPos:!1,ypos:null,prevYPos:!1,mouseDown:!1,throttleTimeout:1e3/this.settings.throttleFPS,lastMove:null,elementFocused:null}),this.velocity=0,this.velocityY=0,$(document).mouseup($.proxy(this._resetMouse,this)).click($.proxy(this._resetMouse,this)),this._initEvents(),this.$el.css("cursor",this.settings.cursor),this.settings.triggerHardware&&this.$el.css({"-webkit-transform":"translate3d(0,0,0)","-webkit-perspective":"1000","-webkit-backface-visibility":"hidden"})},Kinetic.prototype._initEvents=function(){var self=this;this.settings.events={touchStart:function(e){var touch;self._useTarget(e.target,e)&&(touch=e.originalEvent.touches[0],self._start(touch.clientX,touch.clientY),e.stopPropagation())},touchMove:function(e){var touch;self.mouseDown&&(touch=e.originalEvent.touches[0],self._inputmove(touch.clientX,touch.clientY),e.preventDefault&&e.preventDefault())},inputDown:function(e){self._useTarget(e.target,e)&&(self._start(e.clientX,e.clientY),self.elementFocused=e.target,"IMG"===e.target.nodeName&&e.preventDefault(),e.stopPropagation())},inputEnd:function(e){self._useTarget(e.target,e)&&(self._end(),self.elementFocused=null,e.preventDefault&&e.preventDefault())},inputMove:function(e){self.mouseDown&&(self._inputmove(e.clientX,e.clientY),e.preventDefault&&e.preventDefault())},scroll:function(e){$.isFunction(self.settings.moved)&&self.settings.moved.call(self,self.settings),e.preventDefault&&e.preventDefault()},inputClick:function(e){return Math.abs(self.velocity)>0?(e.preventDefault(),!1):void 0},dragStart:function(e){return self._useTarget(e.target,e)&&self.elementFocused?!1:void 0}},this._attachListeners(this.$el,this.settings)},Kinetic.prototype._inputmove=function(clientX,clientY){var $this=this.$el;this.el;if((!this.lastMove||new Date>new Date(this.lastMove.getTime()+this.throttleTimeout))&&(this.lastMove=new Date,this.mouseDown&&(this.xpos||this.ypos))){this.elementFocused&&($(this.elementFocused).blur(),this.elementFocused=null,$this.focus()),this.settings.decelerate=!1,this.velocity=this.velocityY=0;var scrollLeft=this.scrollLeft(),scrollTop=this.scrollTop(),movedX=clientX-this.xpos,movedY=clientY-this.ypos;this.scrollLeft(this.settings.x?scrollLeft-movedX:scrollLeft),this.scrollTop(this.settings.y?scrollTop-movedY:scrollTop),this.prevXPos=this.xpos,this.prevYPos=this.ypos,this.xpos=clientX,this.ypos=clientY,this._calculateVelocities(),this._setMoveClasses(this.settings.movingClass),$.isFunction(this.settings.moved)&&this.settings.moved.call($this,this.settings)}},Kinetic.prototype._calculateVelocities=function(){this.velocity=this._capVelocity(this.prevXPos-this.xpos,this.settings.maxvelocity),this.velocityY=this._capVelocity(this.prevYPos-this.ypos,this.settings.maxvelocity)},Kinetic.prototype._end=function(){this.xpos&&this.prevXPos&&this.settings.decelerate===!1&&(this.settings.decelerate=!0,this._calculateVelocities(),this.xpos=this.prevXPos=this.mouseDown=!1,this._move())},Kinetic.prototype._useTarget=function(target,event){return $.isFunction(this.settings.filterTarget)?this.settings.filterTarget.call(this,target,event)!==!1:!0},Kinetic.prototype._start=function(clientX,clientY){this.mouseDown=!0,this.velocity=this.prevXPos=0,this.velocityY=this.prevYPos=0,this.xpos=clientX,this.ypos=clientY},Kinetic.prototype._resetMouse=function(){this.xpos=!1,this.ypos=!1,this.mouseDown=!1},Kinetic.prototype._decelerateVelocity=function(velocity,slowdown){return 0===Math.floor(Math.abs(velocity))?0:velocity*slowdown},Kinetic.prototype._capVelocity=function(velocity,max){var newVelocity=velocity;return velocity>0?velocity>max&&(newVelocity=max):0-max>velocity&&(newVelocity=0-max),newVelocity},Kinetic.prototype._setMoveClasses=function(classes){var settings=this.settings,$this=this.$el;$this.removeClass(settings.movingClass.up).removeClass(settings.movingClass.down).removeClass(settings.movingClass.left).removeClass(settings.movingClass.right).removeClass(settings.deceleratingClass.up).removeClass(settings.deceleratingClass.down).removeClass(settings.deceleratingClass.left).removeClass(settings.deceleratingClass.right),this.velocity>0&&$this.addClass(classes.right),this.velocity<0&&$this.addClass(classes.left),this.velocityY>0&&$this.addClass(classes.down),this.velocityY<0&&$this.addClass(classes.up)},Kinetic.prototype._move=function(){var scroller=(this.$el,this.el),self=this,settings=self.settings;settings.x&&scroller.scrollWidth>0?(this.scrollLeft(this.scrollLeft()+this.velocity),Math.abs(this.velocity)>0&&(this.velocity=settings.decelerate?self._decelerateVelocity(this.velocity,settings.slowdown):this.velocity)):this.velocity=0,settings.y&&scroller.scrollHeight>0?(this.scrollTop(this.scrollTop()+this.velocityY),Math.abs(this.velocityY)>0&&(this.velocityY=settings.decelerate?self._decelerateVelocity(this.velocityY,settings.slowdown):this.velocityY)):this.velocityY=0,self._setMoveClasses(settings.deceleratingClass),$.isFunction(settings.moved)&&settings.moved.call(this,settings),Math.abs(this.velocity)>0||Math.abs(this.velocityY)>0?this.moving||(this.moving=!0,window.requestAnimationFrame(function(){self.moving=!1,self._move()})):self.stop()},Kinetic.prototype._getScroller=function(){var $scroller=this.$el;return(this.$el.is("body")||this.$el.is("html"))&&($scroller=$(window)),$scroller},Kinetic.prototype.scrollLeft=function(left){var $scroller=this._getScroller();return"number"!=typeof left?$scroller.scrollLeft():($scroller.scrollLeft(left),void(this.settings.scrollLeft=left))},Kinetic.prototype.scrollTop=function(top){var $scroller=this._getScroller();return"number"!=typeof top?$scroller.scrollTop():($scroller.scrollTop(top),void(this.settings.scrollTop=top))},Kinetic.prototype._attachListeners=function(){var $this=this.$el,settings=this.settings;$.support.touch?$this.bind("touchstart",settings.events.touchStart).bind("touchend",settings.events.inputEnd).bind("touchmove",settings.events.touchMove):$this.mousedown(settings.events.inputDown).mouseup(settings.events.inputEnd).mousemove(settings.events.inputMove),$this.click(settings.events.inputClick).scroll(settings.events.scroll).bind("selectstart",selectStart).bind("dragstart",settings.events.dragStart)},Kinetic.prototype._detachListeners=function(){var $this=this.$el,settings=this.settings;$.support.touch?$this.unbind("touchstart",settings.events.touchStart).unbind("touchend",settings.events.inputEnd).unbind("touchmove",settings.events.touchMove):$this.unbind("mousedown",settings.events.inputDown).unbind("mouseup",settings.events.inputEnd).unbind("mousemove",settings.events.inputMove),$this.unbind("click",settings.events.inputClick).unbind("scroll",settings.events.scroll).unbind("selectstart",selectStart).unbind("dragstart",settings.events.dragStart)},$.Kinetic=Kinetic,$.fn.kinetic=function(option,callOptions){return this.each(function(){var $this=$(this),instance=$this.data(Kinetic.DATA_KEY),options=$.extend({},Kinetic.DEFAULTS,$this.data(),"object"==typeof option&&option);instance||$this.data(Kinetic.DATA_KEY,instance=new Kinetic(this,options)),"string"==typeof option&&instance[option](callOptions)})}}(window.jQuery||window.Zepto),!function(t){function e(){}function i(t){function i(e){e.prototype.option||(e.prototype.option=function(e){t.isPlainObject(e)&&(this.options=t.extend(!0,this.options,e))})}function o(e,i){t.fn[e]=function(o){if("string"==typeof o){for(var s=n.call(arguments,1),a=0,l=this.length;l>a;a++){var c=this[a],h=t.data(c,e);if(h)if(t.isFunction(h[o])&&"_"!==o.charAt(0)){var d=h[o].apply(h,s);if(void 0!==d)return d}else r("no such method '"+o+"' for "+e+" instance");else r("cannot call methods on "+e+" prior to initialization; attempted to call '"+o+"'")}return this}return this.each(function(){var n=t.data(this,e);n?(n.option(o),n._init()):(n=new i(this,o),t.data(this,e,n))})}}if(t){var r="undefined"==typeof console?e:function(t){console.error(t)};return t.bridget=function(t,e){i(e),o(t,e)},t.bridget}}var n=Array.prototype.slice;"function"==typeof define&&define.amd?define("jquery-bridget/jquery.bridget",["jquery"],i):i("object"==typeof exports?require("jquery"):t.jQuery)}(window),function(t){function e(t){return new RegExp("(^|\\s+)"+t+"(\\s+|$)")}function i(t,e){var i=n(t,e)?r:o;i(t,e)}var n,o,r;"classList"in document.documentElement?(n=function(t,e){return t.classList.contains(e)},o=function(t,e){t.classList.add(e)},r=function(t,e){t.classList.remove(e)}):(n=function(t,i){return e(i).test(t.className)},o=function(t,e){n(t,e)||(t.className=t.className+" "+e)},r=function(t,i){t.className=t.className.replace(e(i)," ")});var s={hasClass:n,addClass:o,removeClass:r,toggleClass:i,has:n,add:o,remove:r,toggle:i};"function"==typeof define&&define.amd?define("classie/classie",s):"object"==typeof exports?module.exports=s:t.classie=s}(window),function(){function t(){}function e(t,e){for(var i=t.length;i--;)if(t[i].listener===e)return i;return-1}function i(t){return function(){return this[t].apply(this,arguments)}}var n=t.prototype,o=this,r=o.EventEmitter;n.getListeners=function(t){var e,i,n=this._getEvents();if(t instanceof RegExp){e={};for(i in n)n.hasOwnProperty(i)&&t.test(i)&&(e[i]=n[i])}else e=n[t]||(n[t]=[]);return e},n.flattenListeners=function(t){var e,i=[];for(e=0;e<t.length;e+=1)i.push(t[e].listener);return i},n.getListenersAsObject=function(t){var e,i=this.getListeners(t);return i instanceof Array&&(e={},e[t]=i),e||i},n.addListener=function(t,i){var n,o=this.getListenersAsObject(t),r="object"==typeof i;for(n in o)o.hasOwnProperty(n)&&-1===e(o[n],i)&&o[n].push(r?i:{listener:i,once:!1});return this},n.on=i("addListener"),n.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},n.once=i("addOnceListener"),n.defineEvent=function(t){return this.getListeners(t),this},n.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},n.removeListener=function(t,i){var n,o,r=this.getListenersAsObject(t);for(o in r)r.hasOwnProperty(o)&&(n=e(r[o],i),-1!==n&&r[o].splice(n,1));return this},n.off=i("removeListener"),n.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},n.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},n.manipulateListeners=function(t,e,i){var n,o,r=t?this.removeListener:this.addListener,s=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(n=i.length;n--;)r.call(this,e,i[n]);else for(n in e)e.hasOwnProperty(n)&&(o=e[n])&&("function"==typeof o?r.call(this,n,o):s.call(this,n,o));return this},n.removeEvent=function(t){var e,i=typeof t,n=this._getEvents();if("string"===i)delete n[t];else if(t instanceof RegExp)for(e in n)n.hasOwnProperty(e)&&t.test(e)&&delete n[e];else delete this._events;return this},n.removeAllListeners=i("removeEvent"),n.emitEvent=function(t,e){
var i,n,o,r,s=this.getListenersAsObject(t);for(o in s)if(s.hasOwnProperty(o))for(n=s[o].length;n--;)i=s[o][n],i.once===!0&&this.removeListener(t,i.listener),r=i.listener.apply(this,e||[]),r===this._getOnceReturnValue()&&this.removeListener(t,i.listener);return this},n.trigger=i("emitEvent"),n.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},n.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},n._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},n._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return o.EventEmitter=r,t},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return t}):"object"==typeof module&&module.exports?module.exports=t:o.EventEmitter=t}.call(this),function(t){function e(e){var i=t.event;return i.target=i.target||i.srcElement||e,i}var i=document.documentElement,n=function(){};i.addEventListener?n=function(t,e,i){t.addEventListener(e,i,!1)}:i.attachEvent&&(n=function(t,i,n){t[i+n]=n.handleEvent?function(){var i=e(t);n.handleEvent.call(n,i)}:function(){var i=e(t);n.call(t,i)},t.attachEvent("on"+i,t[i+n])});var o=function(){};i.removeEventListener?o=function(t,e,i){t.removeEventListener(e,i,!1)}:i.detachEvent&&(o=function(t,e,i){t.detachEvent("on"+e,t[e+i]);try{delete t[e+i]}catch(n){t[e+i]=void 0}});var r={bind:n,unbind:o};"function"==typeof define&&define.amd?define("eventie/eventie",r):"object"==typeof exports?module.exports=r:t.eventie=r}(window),function(t){function e(t){if(t){if("string"==typeof n[t])return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var e,o=0,r=i.length;r>o;o++)if(e=i[o]+t,"string"==typeof n[e])return e}}var i="Webkit Moz ms Ms O".split(" "),n=document.documentElement.style;"function"==typeof define&&define.amd?define("get-style-property/get-style-property",[],function(){return e}):"object"==typeof exports?module.exports=e:t.getStyleProperty=e}(window),function(t){function e(t){var e=parseFloat(t),i=-1===t.indexOf("%")&&!isNaN(e);return i&&e}function i(){}function n(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0,i=s.length;i>e;e++){var n=s[e];t[n]=0}return t}function o(i){function o(){if(!p){p=!0;var n=t.getComputedStyle;if(c=function(){var t=n?function(t){return n(t,null)}:function(t){return t.currentStyle};return function(e){var i=t(e);return i||r("Style returned "+i+". Are you running this code in a hidden iframe on Firefox? See http://bit.ly/getsizebug1"),i}}(),h=i("boxSizing")){var o=document.createElement("div");o.style.width="200px",o.style.padding="1px 2px 3px 4px",o.style.borderStyle="solid",o.style.borderWidth="1px 2px 3px 4px",o.style[h]="border-box";var s=document.body||document.documentElement;s.appendChild(o);var a=c(o);d=200===e(a.width),s.removeChild(o)}}}function a(t){if(o(),"string"==typeof t&&(t=document.querySelector(t)),t&&"object"==typeof t&&t.nodeType){var i=c(t);if("none"===i.display)return n();var r={};r.width=t.offsetWidth,r.height=t.offsetHeight;for(var a=r.isBorderBox=!(!h||!i[h]||"border-box"!==i[h]),p=0,u=s.length;u>p;p++){var f=s[p],v=i[f];v=l(t,v);var y=parseFloat(v);r[f]=isNaN(y)?0:y}var g=r.paddingLeft+r.paddingRight,m=r.paddingTop+r.paddingBottom,b=r.marginLeft+r.marginRight,x=r.marginTop+r.marginBottom,S=r.borderLeftWidth+r.borderRightWidth,C=r.borderTopWidth+r.borderBottomWidth,w=a&&d,E=e(i.width);E!==!1&&(r.width=E+(w?0:g+S));var P=e(i.height);return P!==!1&&(r.height=P+(w?0:m+C)),r.innerWidth=r.width-(g+S),r.innerHeight=r.height-(m+C),r.outerWidth=r.width+b,r.outerHeight=r.height+x,r}}function l(e,i){if(t.getComputedStyle||-1===i.indexOf("%"))return i;var n=e.style,o=n.left,r=e.runtimeStyle,s=r&&r.left;return s&&(r.left=e.currentStyle.left),n.left=i,i=n.pixelLeft,n.left=o,s&&(r.left=s),i}var c,h,d,p=!1;return a}var r="undefined"==typeof console?i:function(t){console.error(t)},s=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];"function"==typeof define&&define.amd?define("get-size/get-size",["get-style-property/get-style-property"],o):"object"==typeof exports?module.exports=o(require("desandro-get-style-property")):t.getSize=o(t.getStyleProperty)}(window),function(t){function e(t){"function"==typeof t&&(e.isReady?t():s.push(t))}function i(t){var i="readystatechange"===t.type&&"complete"!==r.readyState;e.isReady||i||n()}function n(){e.isReady=!0;for(var t=0,i=s.length;i>t;t++){var n=s[t];n()}}function o(o){return"complete"===r.readyState?n():(o.bind(r,"DOMContentLoaded",i),o.bind(r,"readystatechange",i),o.bind(t,"load",i)),e}var r=t.document,s=[];e.isReady=!1,"function"==typeof define&&define.amd?define("doc-ready/doc-ready",["eventie/eventie"],o):"object"==typeof exports?module.exports=o(require("eventie")):t.docReady=o(t.eventie)}(window),function(t){function e(t,e){return t[s](e)}function i(t){if(!t.parentNode){var e=document.createDocumentFragment();e.appendChild(t)}}function n(t,e){i(t);for(var n=t.parentNode.querySelectorAll(e),o=0,r=n.length;r>o;o++)if(n[o]===t)return!0;return!1}function o(t,n){return i(t),e(t,n)}var r,s=function(){if(t.matches)return"matches";if(t.matchesSelector)return"matchesSelector";for(var e=["webkit","moz","ms","o"],i=0,n=e.length;n>i;i++){var o=e[i],r=o+"MatchesSelector";if(t[r])return r}}();if(s){var a=document.createElement("div"),l=e(a,"div");r=l?e:o}else r=n;"function"==typeof define&&define.amd?define("matches-selector/matches-selector",[],function(){return r}):"object"==typeof exports?module.exports=r:window.matchesSelector=r}(Element.prototype),function(t,e){"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["doc-ready/doc-ready","matches-selector/matches-selector"],function(i,n){return e(t,i,n)}):"object"==typeof exports?module.exports=e(t,require("doc-ready"),require("desandro-matches-selector")):t.fizzyUIUtils=e(t,t.docReady,t.matchesSelector)}(window,function(t,e,i){var n={};n.extend=function(t,e){for(var i in e)t[i]=e[i];return t},n.modulo=function(t,e){return(t%e+e)%e};var o=Object.prototype.toString;n.isArray=function(t){return"[object Array]"==o.call(t)},n.makeArray=function(t){var e=[];if(n.isArray(t))e=t;else if(t&&"number"==typeof t.length)for(var i=0,o=t.length;o>i;i++)e.push(t[i]);else e.push(t);return e},n.indexOf=Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return i;return-1},n.removeFrom=function(t,e){var i=n.indexOf(t,e);-1!=i&&t.splice(i,1)},n.isElement="function"==typeof HTMLElement||"object"==typeof HTMLElement?function(t){return t instanceof HTMLElement}:function(t){return t&&"object"==typeof t&&1==t.nodeType&&"string"==typeof t.nodeName},n.setText=function(){function t(t,i){e=e||(void 0!==document.documentElement.textContent?"textContent":"innerText"),t[e]=i}var e;return t}(),n.getParent=function(t,e){for(;t!=document.body;)if(t=t.parentNode,i(t,e))return t},n.getQueryElement=function(t){return"string"==typeof t?document.querySelector(t):t},n.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},n.filterFindElements=function(t,e){t=n.makeArray(t);for(var o=[],r=0,s=t.length;s>r;r++){var a=t[r];if(n.isElement(a))if(e){i(a,e)&&o.push(a);for(var l=a.querySelectorAll(e),c=0,h=l.length;h>c;c++)o.push(l[c])}else o.push(a)}return o},n.debounceMethod=function(t,e,i){var n=t.prototype[e],o=e+"Timeout";t.prototype[e]=function(){var t=this[o];t&&clearTimeout(t);var e=arguments,r=this;this[o]=setTimeout(function(){n.apply(r,e),delete r[o]},i||100)}},n.toDashed=function(t){return t.replace(/(.)([A-Z])/g,function(t,e,i){return e+"-"+i}).toLowerCase()};var r=t.console;return n.htmlInit=function(i,o){e(function(){for(var e=n.toDashed(o),s=document.querySelectorAll(".js-"+e),a="data-"+e+"-options",l=0,c=s.length;c>l;l++){var h,d=s[l],p=d.getAttribute(a);try{h=p&&JSON.parse(p)}catch(u){r&&r.error("Error parsing "+a+" on "+d.nodeName.toLowerCase()+(d.id?"#"+d.id:"")+": "+u);continue}var f=new i(d,h),v=t.jQuery;v&&v.data(d,o,f)}})},n}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/cell",["get-size/get-size"],function(i){return e(t,i)}):"object"==typeof exports?module.exports=e(t,require("get-size")):(t.Flickity=t.Flickity||{},t.Flickity.Cell=e(t,t.getSize))}(window,function(t,e){function i(t,e){this.element=t,this.parent=e,this.create()}var n="attachEvent"in t;return i.prototype.create=function(){this.element.style.position="absolute",n&&this.element.setAttribute("unselectable","on"),this.x=0,this.shift=0},i.prototype.destroy=function(){this.element.style.position="";var t=this.parent.originSide;this.element.style[t]=""},i.prototype.getSize=function(){this.size=e(this.element)},i.prototype.setPosition=function(t){this.x=t,this.setDefaultTarget(),this.renderPosition(t)},i.prototype.setDefaultTarget=function(){var t="left"==this.parent.originSide?"marginLeft":"marginRight";this.target=this.x+this.size[t]+this.size.width*this.parent.cellAlign},i.prototype.renderPosition=function(t){var e=this.parent.originSide;this.element.style[e]=this.parent.getPositionValue(t)},i.prototype.wrapShift=function(t){this.shift=t,this.renderPosition(this.x+this.parent.slideableWidth*t)},i.prototype.remove=function(){this.element.parentNode.removeChild(this.element)},i}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/animate",["get-style-property/get-style-property","fizzy-ui-utils/utils"],function(i,n){return e(t,i,n)}):"object"==typeof exports?module.exports=e(t,require("desandro-get-style-property"),require("fizzy-ui-utils")):(t.Flickity=t.Flickity||{},t.Flickity.animatePrototype=e(t,t.getStyleProperty,t.fizzyUIUtils))}(window,function(t,e,i){for(var n,o=0,r="webkit moz ms o".split(" "),s=t.requestAnimationFrame,a=t.cancelAnimationFrame,l=0;l<r.length&&(!s||!a);l++)n=r[l],s=s||t[n+"RequestAnimationFrame"],a=a||t[n+"CancelAnimationFrame"]||t[n+"CancelRequestAnimationFrame"];s&&a||(s=function(e){var i=(new Date).getTime(),n=Math.max(0,16-(i-o)),r=t.setTimeout(function(){e(i+n)},n);return o=i+n,r},a=function(e){t.clearTimeout(e)});var c={};c.startAnimation=function(){this.isAnimating||(this.isAnimating=!0,this.restingFrames=0,this.animate())},c.animate=function(){this.applySelectedAttraction();var t=this.x;if(this.integratePhysics(),this.positionSlider(),this.settle(t),this.isAnimating){var e=this;s(function(){e.animate()})}};var h=e("transform"),d=!!e("perspective");return c.positionSlider=function(){var t=this.x;this.options.wrapAround&&this.cells.length>1&&(t=i.modulo(t,this.slideableWidth),t-=this.slideableWidth,this.shiftWrapCells(t)),t+=this.cursorPosition,t=this.options.rightToLeft&&h?-t:t;var e=this.getPositionValue(t);h?this.slider.style[h]=d&&this.isAnimating?"translate3d("+e+",0,0)":"translateX("+e+")":this.slider.style[this.originSide]=e},c.positionSliderAtSelected=function(){if(this.cells.length){var t=this.cells[this.selectedIndex];this.x=-t.target,this.positionSlider()}},c.getPositionValue=function(t){return this.options.percentPosition?.01*Math.round(t/this.size.innerWidth*1e4)+"%":Math.round(t)+"px"},c.settle=function(t){this.isPointerDown||Math.round(100*this.x)!=Math.round(100*t)||this.restingFrames++,this.restingFrames>2&&(this.isAnimating=!1,delete this.isFreeScrolling,d&&this.positionSlider(),this.dispatchEvent("settle"))},c.shiftWrapCells=function(t){var e=this.cursorPosition+t;this._shiftCells(this.beforeShiftCells,e,-1);var i=this.size.innerWidth-(t+this.slideableWidth+this.cursorPosition);this._shiftCells(this.afterShiftCells,i,1)},c._shiftCells=function(t,e,i){for(var n=0,o=t.length;o>n;n++){var r=t[n],s=e>0?i:0;r.wrapShift(s),e-=r.size.outerWidth}},c._unshiftCells=function(t){if(t&&t.length)for(var e=0,i=t.length;i>e;e++)t[e].wrapShift(0)},c.integratePhysics=function(){this.velocity+=this.accel,this.x+=this.velocity,this.velocity*=this.getFrictionFactor(),this.accel=0},c.applyForce=function(t){this.accel+=t},c.getFrictionFactor=function(){return 1-this.options[this.isFreeScrolling?"freeScrollFriction":"friction"]},c.getRestingPosition=function(){return this.x+this.velocity/(1-this.getFrictionFactor())},c.applySelectedAttraction=function(){var t=this.cells.length;if(!this.isPointerDown&&!this.isFreeScrolling&&t){var e=this.cells[this.selectedIndex],i=this.options.wrapAround&&t>1?this.slideableWidth*Math.floor(this.selectedIndex/t):0,n=-1*(e.target+i)-this.x,o=n*this.options.selectedAttraction;this.applyForce(o)}},c}),function(t,e){if("function"==typeof define&&define.amd)define("flickity/js/flickity",["classie/classie","eventEmitter/EventEmitter","eventie/eventie","get-size/get-size","fizzy-ui-utils/utils","./cell","./animate"],function(i,n,o,r,s,a,l){return e(t,i,n,o,r,s,a,l)});else if("object"==typeof exports)module.exports=e(t,require("desandro-classie"),require("wolfy87-eventemitter"),require("eventie"),require("get-size"),require("fizzy-ui-utils"),require("./cell"),require("./animate"));else{var i=t.Flickity;t.Flickity=e(t,t.classie,t.EventEmitter,t.eventie,t.getSize,t.fizzyUIUtils,i.Cell,i.animatePrototype)}}(window,function(t,e,i,n,o,r,s,a){function l(t,e){for(t=r.makeArray(t);t.length;)e.appendChild(t.shift())}function c(t,e){var i=r.getQueryElement(t);return i?(this.element=i,h&&(this.$element=h(this.element)),this.options=r.extend({},this.constructor.defaults),this.option(e),void this._create()):void(p&&p.error("Bad element for Flickity: "+(i||t)))}var h=t.jQuery,d=t.getComputedStyle,p=t.console,u=0,f={};c.defaults={accessibility:!0,cellAlign:"center",freeScrollFriction:.075,friction:.28,percentPosition:!0,resize:!0,selectedAttraction:.025,setGallerySize:!0},c.createMethods=[],r.extend(c.prototype,i.prototype),c.prototype._create=function(){var e=this.guid=++u;this.element.flickityGUID=e,f[e]=this,this.selectedIndex=this.options.initialIndex||0,this.restingFrames=0,this.x=0,this.velocity=0,this.accel=0,this.originSide=this.options.rightToLeft?"right":"left",this.viewport=document.createElement("div"),this.viewport.className="flickity-viewport",c.setUnselectable(this.viewport),this._createSlider(),(this.options.resize||this.options.watchCSS)&&(n.bind(t,"resize",this),this.isResizeBound=!0);for(var i=0,o=c.createMethods.length;o>i;i++){var r=c.createMethods[i];this[r]()}this.options.watchCSS?this.watchCSS():this.activate()},c.prototype.option=function(t){r.extend(this.options,t)},c.prototype.activate=function(){if(!this.isActive){this.isActive=!0,e.add(this.element,"flickity-enabled"),this.options.rightToLeft&&e.add(this.element,"flickity-rtl");var t=this._filterFindCellElements(this.element.children);l(t,this.slider),this.viewport.appendChild(this.slider),this.element.appendChild(this.viewport),this.getSize(),this.reloadCells(),this.options.accessibility&&(this.element.tabIndex=0,n.bind(this.element,"keydown",this)),this.emit("activate"),this.positionSliderAtSelected(),this.select(this.selectedIndex)}},c.prototype._createSlider=function(){var t=document.createElement("div");t.className="flickity-slider",t.style[this.originSide]=0,this.slider=t},c.prototype._filterFindCellElements=function(t){return r.filterFindElements(t,this.options.cellSelector)},c.prototype.reloadCells=function(){this.cells=this._makeCells(this.slider.children),this.positionCells(),this._getWrapShiftCells(),this.setGallerySize()},c.prototype._makeCells=function(t){for(var e=this._filterFindCellElements(t),i=[],n=0,o=e.length;o>n;n++){var r=e[n],a=new s(r,this);i.push(a)}return i},c.prototype.getLastCell=function(){return this.cells[this.cells.length-1]},c.prototype.positionCells=function(){this._sizeCells(this.cells),this._positionCells(0)},c.prototype._positionCells=function(t){this.maxCellHeight=t?this.maxCellHeight||0:0;var e=0;if(t>0){var i=this.cells[t-1];e=i.x+i.size.outerWidth}for(var n,o=this.cells.length,r=t;o>r;r++)n=this.cells[r],n.setPosition(e),e+=n.size.outerWidth,this.maxCellHeight=Math.max(n.size.outerHeight,this.maxCellHeight);this.slideableWidth=e,this._containCells()},c.prototype._sizeCells=function(t){for(var e=0,i=t.length;i>e;e++){var n=t[e];n.getSize()}},c.prototype._init=c.prototype.reposition=function(){this.positionCells(),this.positionSliderAtSelected()},c.prototype.getSize=function(){this.size=o(this.element),this.setCellAlign(),this.cursorPosition=this.size.innerWidth*this.cellAlign};var v={center:{left:.5,right:.5},left:{left:0,right:1},right:{right:0,left:1}};c.prototype.setCellAlign=function(){var t=v[this.options.cellAlign];this.cellAlign=t?t[this.originSide]:this.options.cellAlign},c.prototype.setGallerySize=function(){this.options.setGallerySize&&(this.viewport.style.height=this.maxCellHeight+"px")},c.prototype._getWrapShiftCells=function(){if(this.options.wrapAround){this._unshiftCells(this.beforeShiftCells),this._unshiftCells(this.afterShiftCells);var t=this.cursorPosition,e=this.cells.length-1;this.beforeShiftCells=this._getGapCells(t,e,-1),t=this.size.innerWidth-this.cursorPosition,this.afterShiftCells=this._getGapCells(t,0,1)}},c.prototype._getGapCells=function(t,e,i){for(var n=[];t>0;){var o=this.cells[e];if(!o)break;n.push(o),e+=i,t-=o.size.outerWidth}return n},c.prototype._containCells=function(){if(this.options.contain&&!this.options.wrapAround&&this.cells.length)for(var t=this.options.rightToLeft?"marginRight":"marginLeft",e=this.options.rightToLeft?"marginLeft":"marginRight",i=this.cells[0].size[t],n=this.getLastCell(),o=this.slideableWidth-n.size[e],r=o-this.size.innerWidth*(1-this.cellAlign),s=o<this.size.innerWidth,a=0,l=this.cells.length;l>a;a++){var c=this.cells[a];c.setDefaultTarget(),s?c.target=o*this.cellAlign:(c.target=Math.max(c.target,this.cursorPosition+i),c.target=Math.min(c.target,r))}},c.prototype.dispatchEvent=function(t,e,i){var n=[e].concat(i);if(this.emitEvent(t,n),h&&this.$element)if(e){var o=h.Event(e);o.type=t,this.$element.trigger(o,i)}else this.$element.trigger(t,i)},c.prototype.select=function(t,e){if(this.isActive){var i=this.cells.length;this.options.wrapAround&&i>1&&(0>t?this.x-=this.slideableWidth:t>=i&&(this.x+=this.slideableWidth)),(this.options.wrapAround||e)&&(t=r.modulo(t,i)),this.cells[t]&&(this.selectedIndex=t,this.setSelectedCell(),this.startAnimation(),this.dispatchEvent("cellSelect"))}},c.prototype.previous=function(t){this.select(this.selectedIndex-1,t)},c.prototype.next=function(t){this.select(this.selectedIndex+1,t)},c.prototype.setSelectedCell=function(){this._removeSelectedCellClass(),this.selectedCell=this.cells[this.selectedIndex],this.selectedElement=this.selectedCell.element,e.add(this.selectedElement,"is-selected")},c.prototype._removeSelectedCellClass=function(){this.selectedCell&&e.remove(this.selectedCell.element,"is-selected")},c.prototype.getCell=function(t){for(var e=0,i=this.cells.length;i>e;e++){var n=this.cells[e];if(n.element==t)return n}},c.prototype.getCells=function(t){t=r.makeArray(t);for(var e=[],i=0,n=t.length;n>i;i++){var o=t[i],s=this.getCell(o);s&&e.push(s)}return e},c.prototype.getCellElements=function(){for(var t=[],e=0,i=this.cells.length;i>e;e++)t.push(this.cells[e].element);return t},c.prototype.getParentCell=function(t){var e=this.getCell(t);return e?e:(t=r.getParent(t,".flickity-slider > *"),this.getCell(t))},c.prototype.uiChange=function(){this.emit("uiChange")},c.prototype.childUIPointerDown=function(t){this.emitEvent("childUIPointerDown",[t])},c.prototype.onresize=function(){this.watchCSS(),this.resize()},r.debounceMethod(c,"onresize",150),c.prototype.resize=function(){this.isActive&&(this.getSize(),this.options.wrapAround&&(this.x=r.modulo(this.x,this.slideableWidth)),this.positionCells(),this._getWrapShiftCells(),this.setGallerySize(),this.positionSliderAtSelected())};var y=c.supportsConditionalCSS=function(){var t;return function(){if(void 0!==t)return t;if(!d)return void(t=!1);var e=document.createElement("style"),i=document.createTextNode('body:after { content: "foo"; display: none; }');e.appendChild(i),document.head.appendChild(e);var n=d(document.body,":after").content;return t=-1!=n.indexOf("foo"),document.head.removeChild(e),t}}();c.prototype.watchCSS=function(){var t=this.options.watchCSS;if(t){var e=y();if(!e){var i="fallbackOn"==t?"activate":"deactivate";return void this[i]()}var n=d(this.element,":after").content;-1!=n.indexOf("flickity")?this.activate():this.deactivate()}},c.prototype.onkeydown=function(t){if(this.options.accessibility&&(!document.activeElement||document.activeElement==this.element))if(37==t.keyCode){var e=this.options.rightToLeft?"next":"previous";this.uiChange(),this[e]()}else if(39==t.keyCode){var i=this.options.rightToLeft?"previous":"next";this.uiChange(),this[i]()}},c.prototype.deactivate=function(){if(this.isActive){e.remove(this.element,"flickity-enabled"),e.remove(this.element,"flickity-rtl");for(var t=0,i=this.cells.length;i>t;t++){var o=this.cells[t];o.destroy()}this._removeSelectedCellClass(),this.element.removeChild(this.viewport),l(this.slider.children,this.element),this.options.accessibility&&(this.element.removeAttribute("tabIndex"),n.unbind(this.element,"keydown",this)),this.isActive=!1,this.emit("deactivate")}},c.prototype.destroy=function(){this.deactivate(),this.isResizeBound&&n.unbind(t,"resize",this),this.emit("destroy"),h&&this.$element&&h.removeData(this.element,"flickity"),delete this.element.flickityGUID,delete f[this.guid]},r.extend(c.prototype,a);var g="attachEvent"in t;return c.setUnselectable=function(t){g&&t.setAttribute("unselectable","on")},c.data=function(t){t=r.getQueryElement(t);var e=t&&t.flickityGUID;return e&&f[e]},r.htmlInit(c,"flickity"),h&&h.bridget&&h.bridget("flickity",c),c.Cell=s,c}),function(t,e){"function"==typeof define&&define.amd?define("unipointer/unipointer",["eventEmitter/EventEmitter","eventie/eventie"],function(i,n){return e(t,i,n)}):"object"==typeof exports?module.exports=e(t,require("wolfy87-eventemitter"),require("eventie")):t.Unipointer=e(t,t.EventEmitter,t.eventie)}(window,function(t,e,i){function n(){}function o(){}o.prototype=new e,o.prototype.bindStartEvent=function(t){this._bindStartEvent(t,!0)},o.prototype.unbindStartEvent=function(t){this._bindStartEvent(t,!1)},o.prototype._bindStartEvent=function(e,n){n=void 0===n?!0:!!n;var o=n?"bind":"unbind";t.navigator.pointerEnabled?i[o](e,"pointerdown",this):t.navigator.msPointerEnabled?i[o](e,"MSPointerDown",this):(i[o](e,"mousedown",this),i[o](e,"touchstart",this))},o.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},o.prototype.getTouch=function(t){for(var e=0,i=t.length;i>e;e++){var n=t[e];if(n.identifier==this.pointerIdentifier)return n}},o.prototype.onmousedown=function(t){var e=t.button;e&&0!==e&&1!==e||this._pointerDown(t,t)},o.prototype.ontouchstart=function(t){this._pointerDown(t,t.changedTouches[0])},o.prototype.onMSPointerDown=o.prototype.onpointerdown=function(t){this._pointerDown(t,t)},o.prototype._pointerDown=function(t,e){this.isPointerDown||(this.isPointerDown=!0,this.pointerIdentifier=void 0!==e.pointerId?e.pointerId:e.identifier,this.pointerDown(t,e))},o.prototype.pointerDown=function(t,e){this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e])};var r={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"],MSPointerDown:["MSPointerMove","MSPointerUp","MSPointerCancel"]};return o.prototype._bindPostStartEvents=function(e){if(e){for(var n=r[e.type],o=e.preventDefault?t:document,s=0,a=n.length;a>s;s++){var l=n[s];i.bind(o,l,this)}this._boundPointerEvents={events:n,node:o}}},o.prototype._unbindPostStartEvents=function(){var t=this._boundPointerEvents;if(t&&t.events){for(var e=0,n=t.events.length;n>e;e++){var o=t.events[e];i.unbind(t.node,o,this)}delete this._boundPointerEvents}},o.prototype.onmousemove=function(t){this._pointerMove(t,t)},o.prototype.onMSPointerMove=o.prototype.onpointermove=function(t){t.pointerId==this.pointerIdentifier&&this._pointerMove(t,t)},o.prototype.ontouchmove=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerMove(t,e)},o.prototype._pointerMove=function(t,e){this.pointerMove(t,e)},o.prototype.pointerMove=function(t,e){this.emitEvent("pointerMove",[t,e])},o.prototype.onmouseup=function(t){this._pointerUp(t,t)},o.prototype.onMSPointerUp=o.prototype.onpointerup=function(t){t.pointerId==this.pointerIdentifier&&this._pointerUp(t,t)},o.prototype.ontouchend=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerUp(t,e)},o.prototype._pointerUp=function(t,e){this._pointerDone(),this.pointerUp(t,e)},o.prototype.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e])},o.prototype._pointerDone=function(){this.isPointerDown=!1,delete this.pointerIdentifier,this._unbindPostStartEvents(),this.pointerDone()},o.prototype.pointerDone=n,o.prototype.onMSPointerCancel=o.prototype.onpointercancel=function(t){t.pointerId==this.pointerIdentifier&&this._pointerCancel(t,t)},o.prototype.ontouchcancel=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerCancel(t,e)},o.prototype._pointerCancel=function(t,e){this._pointerDone(),this.pointerCancel(t,e)},o.prototype.pointerCancel=function(t,e){this.emitEvent("pointerCancel",[t,e])},o.getPointerPoint=function(t){return{x:void 0!==t.pageX?t.pageX:t.clientX,y:void 0!==t.pageY?t.pageY:t.clientY}},o}),function(t,e){"function"==typeof define&&define.amd?define("unidragger/unidragger",["eventie/eventie","unipointer/unipointer"],function(i,n){return e(t,i,n)}):"object"==typeof exports?module.exports=e(t,require("eventie"),require("unipointer")):t.Unidragger=e(t,t.eventie,t.Unipointer)}(window,function(t,e,i){function n(){}function o(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function r(){}function s(){return!1}r.prototype=new i,r.prototype.bindHandles=function(){this._bindHandles(!0)},r.prototype.unbindHandles=function(){this._bindHandles(!1)};var a=t.navigator;r.prototype._bindHandles=function(t){t=void 0===t?!0:!!t;var i;i=a.pointerEnabled?function(e){e.style.touchAction=t?"none":""}:a.msPointerEnabled?function(e){e.style.msTouchAction=t?"none":""}:function(){t&&c(s)};for(var n=t?"bind":"unbind",o=0,r=this.handles.length;r>o;o++){var s=this.handles[o];this._bindStartEvent(s,t),i(s),e[n](s,"click",this)}};var l="attachEvent"in document.documentElement,c=l?function(t){"IMG"==t.nodeName&&(t.ondragstart=s);for(var e=t.querySelectorAll("img"),i=0,n=e.length;n>i;i++){var o=e[i];o.ondragstart=s}}:n;return r.prototype.pointerDown=function(t,e){this._dragPointerDown(t,e);var i=document.activeElement;i&&i.blur&&i.blur(),this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e])},r.prototype._dragPointerDown=function(t,e){this.pointerDownPoint=i.getPointerPoint(e);var n="touchstart"==t.type,r=t.target.nodeName;n||"SELECT"==r||o(t)},r.prototype.pointerMove=function(t,e){var i=this._dragPointerMove(t,e);this.emitEvent("pointerMove",[t,e,i]),this._dragMove(t,e,i)},r.prototype._dragPointerMove=function(t,e){var n=i.getPointerPoint(e),o={x:n.x-this.pointerDownPoint.x,y:n.y-this.pointerDownPoint.y};return!this.isDragging&&this.hasDragStarted(o)&&this._dragStart(t,e),o},r.prototype.hasDragStarted=function(t){return Math.abs(t.x)>3||Math.abs(t.y)>3},r.prototype.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e]),this._dragPointerUp(t,e)},r.prototype._dragPointerUp=function(t,e){this.isDragging?this._dragEnd(t,e):this._staticClick(t,e)},r.prototype._dragStart=function(t,e){this.isDragging=!0,this.dragStartPoint=r.getPointerPoint(e),this.isPreventingClicks=!0,this.dragStart(t,e)},r.prototype.dragStart=function(t,e){this.emitEvent("dragStart",[t,e])},r.prototype._dragMove=function(t,e,i){this.isDragging&&this.dragMove(t,e,i)},r.prototype.dragMove=function(t,e,i){o(t),this.emitEvent("dragMove",[t,e,i])},r.prototype._dragEnd=function(t,e){this.isDragging=!1;var i=this;setTimeout(function(){delete i.isPreventingClicks}),this.dragEnd(t,e)},r.prototype.dragEnd=function(t,e){this.emitEvent("dragEnd",[t,e])},r.prototype.onclick=function(t){this.isPreventingClicks&&o(t)},r.prototype._staticClick=function(t,e){var i=t.target.nodeName;("INPUT"==i||"TEXTAREA"==i)&&t.target.focus(),this.staticClick(t,e)},r.prototype.staticClick=function(t,e){this.emitEvent("staticClick",[t,e])},r.getPointerPoint=function(t){return{x:void 0!==t.pageX?t.pageX:t.clientX,y:void 0!==t.pageY?t.pageY:t.clientY}},r.getPointerPoint=i.getPointerPoint,r}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/drag",["classie/classie","eventie/eventie","./flickity","unidragger/unidragger","fizzy-ui-utils/utils"],function(i,n,o,r,s){return e(t,i,n,o,r,s)}):"object"==typeof exports?module.exports=e(t,require("desandro-classie"),require("eventie"),require("./flickity"),require("unidragger"),require("fizzy-ui-utils")):(t.Flickity=t.Flickity||{},t.Flickity.dragPrototype=e(t,t.classie,t.eventie,t.Flickity,t.Unidragger,t.fizzyUIUtils))}(window,function(t,e,i,n,o,r){function s(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function a(e){var i=o.getPointerPoint(e);return i.y-t.pageYOffset}r.extend(n.defaults,{draggable:!0,touchVerticalScroll:!0}),n.createMethods.push("_createDrag");var l={};r.extend(l,o.prototype),l._createDrag=function(){this.on("activate",this.bindDrag),this.on("uiChange",this._uiChangeDrag),this.on("childUIPointerDown",this._childUIPointerDownDrag),this.on("deactivate",this.unbindDrag)},l.bindDrag=function(){this.options.draggable&&!this.isDragBound&&(e.add(this.element,"is-draggable"),this.handles=[this.viewport],this.bindHandles(),this.isDragBound=!0)},l.unbindDrag=function(){this.isDragBound&&(e.remove(this.element,"is-draggable"),this.unbindHandles(),delete this.isDragBound)},l._uiChangeDrag=function(){delete this.isFreeScrolling},l._childUIPointerDownDrag=function(t){s(t),this.pointerDownFocus(t)},l.pointerDown=function(t,i){this._dragPointerDown(t,i);var n=document.activeElement;n&&n.blur&&n!=this.element&&n!=document.body&&n.blur(),this.pointerDownFocus(t),this.velocity=0,e.add(this.viewport,"is-pointer-down"),this._bindPostStartEvents(t),this.dispatchEvent("pointerDown",t,[i])};var c={touchstart:!0,MSPointerDown:!0},h={INPUT:!0,SELECT:!0};l.pointerDownFocus=function(t){!this.options.accessibility||c[t.type]||h[t.target.nodeName]||this.element.focus()},l.pointerMove=function(t,e){var i=this._dragPointerMove(t,e);this.touchVerticalScrollMove(t,e,i),this._dragMove(t,e,i),this.dispatchEvent("pointerMove",t,[e,i])},l.hasDragStarted=function(t){return!this.isTouchScrolling&&Math.abs(t.x)>3},l.pointerUp=function(t,i){delete this.isTouchScrolling,e.remove(this.viewport,"is-pointer-down"),this.dispatchEvent("pointerUp",t,[i]),this._dragPointerUp(t,i)};var d={touchmove:!0,MSPointerMove:!0};return l.touchVerticalScrollMove=function(e,i,n){var o=this.options.touchVerticalScroll,r="withDrag"==o?!o:this.isDragging||!o;!r&&d[e.type]&&!this.isTouchScrolling&&Math.abs(n.y)>10&&(this.startScrollY=t.pageYOffset,this.pointerWindowStartY=a(i),this.isTouchScrolling=!0)},l.dragStart=function(t,e){this.dragStartPosition=this.x,this.startAnimation(),this.dispatchEvent("dragStart",t,[e])},l.dragMove=function(t,e,i){s(t),this.previousDragX=this.x;var n=i.x,o=this.options.rightToLeft?-1:1;if(this.x=this.dragStartPosition+n*o,!this.options.wrapAround&&this.cells.length){var r=Math.max(-this.cells[0].target,this.dragStartPosition);this.x=this.x>r?.5*(this.x-r)+r:this.x;var a=Math.min(-this.getLastCell().target,this.dragStartPosition);this.x=this.x<a?.5*(this.x-a)+a:this.x}this.previousDragMoveTime=this.dragMoveTime,this.dragMoveTime=new Date,this.dispatchEvent("dragMove",t,[e,i])},l.dragEnd=function(t,e){this.dragEndFlick(),this.options.freeScroll&&(this.isFreeScrolling=!0);var i=this.dragEndRestingSelect();if(this.options.freeScroll&&!this.options.wrapAround){var n=this.getRestingPosition();this.isFreeScrolling=-n>this.cells[0].target&&-n<this.getLastCell().target}else this.options.freeScroll||i!=this.selectedIndex||(i+=this.dragEndBoostSelect());
this.select(i),this.dispatchEvent("dragEnd",t,[e])},l.dragEndFlick=function(){if(isFinite(this.previousDragX)){var t=this.dragMoveTime-this.previousDragMoveTime;if(t){t/=1e3/60;var e=this.x-this.previousDragX;this.velocity=e/t}delete this.previousDragX}},l.dragEndRestingSelect=function(){var t=this.getRestingPosition(),e=Math.abs(this.getCellDistance(-t,this.selectedIndex)),i=this._getClosestResting(t,e,1),n=this._getClosestResting(t,e,-1),o=i.distance<n.distance?i.index:n.index;return this.options.contain&&!this.options.wrapAround&&(o=Math.abs(o-this.selectedIndex)<=1?this.selectedIndex:o),o},l._getClosestResting=function(t,e,i){for(var n=this.selectedIndex,o=1/0,r=this.options.contain&&!this.options.wrapAround?function(t,e){return e>=t}:function(t,e){return e>t};r(e,o)&&(n+=i,o=e,e=this.getCellDistance(-t,n),null!==e);)e=Math.abs(e);return{distance:o,index:n-i}},l.getCellDistance=function(t,e){var i=this.cells.length,n=this.options.wrapAround&&i>1,o=n?r.modulo(e,i):e,s=this.cells[o];if(!s)return null;var a=n?this.slideableWidth*Math.floor(e/i):0;return t-(s.target+a)},l.dragEndBoostSelect=function(){var t=this.getCellDistance(-this.x,this.selectedIndex);return t>0&&this.velocity<-1?1:0>t&&this.velocity>1?-1:0},l.staticClick=function(t,e){var i=this.getParentCell(t.target),n=i&&i.element,o=i&&r.indexOf(this.cells,i);this.dispatchEvent("staticClick",t,[e,n,o])},r.extend(n.prototype,l),n}),function(t,e){"function"==typeof define&&define.amd?define("tap-listener/tap-listener",["unipointer/unipointer"],function(i){return e(t,i)}):"object"==typeof exports?module.exports=e(t,require("unipointer")):t.TapListener=e(t,t.Unipointer)}(window,function(t,e){function i(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function n(t){this.bindTap(t)}n.prototype=new e,n.prototype.bindTap=function(t){t&&(this.unbindTap(),this.tapElement=t,this._bindStartEvent(t,!0))},n.prototype.unbindTap=function(){this.tapElement&&(this._bindStartEvent(this.tapElement,!0),delete this.tapElement)};var o=n.prototype.pointerDown;n.prototype.pointerDown=function(t){"touchstart"==t.type&&i(t),o.apply(this,arguments)};var r=void 0!==t.pageYOffset;return n.prototype.pointerUp=function(i,n){var o=e.getPointerPoint(n),s=this.tapElement.getBoundingClientRect(),a=r?t.pageXOffset:document.body.scrollLeft,l=r?t.pageYOffset:document.body.scrollTop,c=o.x>=s.left+a&&o.x<=s.right+a&&o.y>=s.top+l&&o.y<=s.bottom+l;c&&this.emitEvent("tap",[i,n])},n.prototype.destroy=function(){this.pointerDone(),this.unbindTap()},n}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/prev-next-button",["eventie/eventie","./flickity","tap-listener/tap-listener","fizzy-ui-utils/utils"],function(i,n,o,r){return e(t,i,n,o,r)}):"object"==typeof exports?module.exports=e(t,require("eventie"),require("./flickity"),require("tap-listener"),require("fizzy-ui-utils")):(t.Flickity=t.Flickity||{},t.Flickity.PrevNextButton=e(t,t.eventie,t.Flickity,t.TapListener,t.fizzyUIUtils))}(window,function(t,e,i,n,o){function r(t,e){this.direction=t,this.parent=e,this._create()}var s="http://www.w3.org/2000/svg",a=function(){function t(){if(void 0!==e)return e;var t=document.createElement("div");return t.innerHTML="<svg/>",e=(t.firstChild&&t.firstChild.namespaceURI)==s}var e;return t}();return r.prototype=new n,r.prototype._create=function(){this.isEnabled=!0,this.isPrevious=-1==this.direction;var t=this.parent.options.rightToLeft?1:-1;this.isLeft=this.direction==t;var e=this.element=document.createElement("button");if(e.className="flickity-prev-next-button",e.className+=this.isPrevious?" previous":" next",e.setAttribute("type","button"),i.setUnselectable(e),a()){var n=this.createSVG();e.appendChild(n)}else this.setArrowText(),e.className+=" no-svg";var o=this;this.onCellSelect=function(){o.update()},this.parent.on("cellSelect",this.onCellSelect),this.on("tap",this.onTap),this.on("pointerDown",function(t,e){o.parent.childUIPointerDown(e)})},r.prototype.activate=function(){this.update(),this.bindTap(this.element),e.bind(this.element,"click",this),this.parent.element.appendChild(this.element)},r.prototype.deactivate=function(){this.parent.element.removeChild(this.element),n.prototype.destroy.call(this),e.unbind(this.element,"click",this)},r.prototype.createSVG=function(){var t=document.createElementNS(s,"svg");t.setAttribute("viewBox","0 0 100 100");var e=document.createElementNS(s,"path");e.setAttribute("d","M 50,0 L 60,10 L 20,50 L 60,90 L 50,100 L 0,50 Z"),e.setAttribute("class","arrow");var i=this.isLeft?"translate(15,0)":"translate(85,100) rotate(180)";return e.setAttribute("transform",i),t.appendChild(e),t},r.prototype.setArrowText=function(){var t=this.parent.options,e=this.isLeft?t.leftArrowText:t.rightArrowText;o.setText(this.element,e)},r.prototype.onTap=function(){if(this.isEnabled){this.parent.uiChange();var t=this.isPrevious?"previous":"next";this.parent[t]()}},r.prototype.handleEvent=o.handleEvent,r.prototype.onclick=function(){var t=document.activeElement;t&&t==this.element&&this.onTap()},r.prototype.enable=function(){this.isEnabled||(this.element.disabled=!1,this.isEnabled=!0)},r.prototype.disable=function(){this.isEnabled&&(this.element.disabled=!0,this.isEnabled=!1)},r.prototype.update=function(){var t=this.parent.cells;if(this.parent.options.wrapAround&&t.length>1)return void this.enable();var e=t.length?t.length-1:0,i=this.isPrevious?0:e,n=this.parent.selectedIndex==i?"disable":"enable";this[n]()},r.prototype.destroy=function(){this.deactivate()},o.extend(i.defaults,{prevNextButtons:!0,leftArrowText:"â€¹",rightArrowText:"â€º"}),i.createMethods.push("_createPrevNextButtons"),i.prototype._createPrevNextButtons=function(){this.options.prevNextButtons&&(this.prevButton=new r(-1,this),this.nextButton=new r(1,this),this.on("activate",this.activatePrevNextButtons))},i.prototype.activatePrevNextButtons=function(){this.prevButton.activate(),this.nextButton.activate(),this.on("deactivate",this.deactivatePrevNextButtons)},i.prototype.deactivatePrevNextButtons=function(){this.prevButton.deactivate(),this.nextButton.deactivate(),this.off("deactivate",this.deactivatePrevNextButtons)},i.PrevNextButton=r,r}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/page-dots",["eventie/eventie","./flickity","tap-listener/tap-listener","fizzy-ui-utils/utils"],function(i,n,o,r){return e(t,i,n,o,r)}):"object"==typeof exports?module.exports=e(t,require("eventie"),require("./flickity"),require("tap-listener"),require("fizzy-ui-utils")):(t.Flickity=t.Flickity||{},t.Flickity.PageDots=e(t,t.eventie,t.Flickity,t.TapListener,t.fizzyUIUtils))}(window,function(t,e,i,n,o){function r(t){this.parent=t,this._create()}return r.prototype=new n,r.prototype._create=function(){this.holder=document.createElement("ol"),this.holder.className="flickity-page-dots",i.setUnselectable(this.holder),this.dots=[];var t=this;this.onCellSelect=function(){t.updateSelected()},this.parent.on("cellSelect",this.onCellSelect),this.on("tap",this.onTap),this.on("pointerDown",function(e,i){t.parent.childUIPointerDown(i)})},r.prototype.activate=function(){this.setDots(),this.updateSelected(),this.bindTap(this.holder),this.parent.element.appendChild(this.holder)},r.prototype.deactivate=function(){this.parent.element.removeChild(this.holder),n.prototype.destroy.call(this)},r.prototype.setDots=function(){var t=this.parent.cells.length-this.dots.length;t>0?this.addDots(t):0>t&&this.removeDots(-t)},r.prototype.addDots=function(t){for(var e=document.createDocumentFragment(),i=[];t;){var n=document.createElement("li");n.className="dot",e.appendChild(n),i.push(n),t--}this.holder.appendChild(e),this.dots=this.dots.concat(i)},r.prototype.removeDots=function(t){for(var e=this.dots.splice(this.dots.length-t,t),i=0,n=e.length;n>i;i++){var o=e[i];this.holder.removeChild(o)}},r.prototype.updateSelected=function(){this.selectedDot&&(this.selectedDot.className="dot"),this.dots.length&&(this.selectedDot=this.dots[this.parent.selectedIndex],this.selectedDot.className="dot is-selected")},r.prototype.onTap=function(t){var e=t.target;if("LI"==e.nodeName){this.parent.uiChange();var i=o.indexOf(this.dots,e);this.parent.select(i)}},r.prototype.destroy=function(){this.deactivate()},i.PageDots=r,o.extend(i.defaults,{pageDots:!0}),i.createMethods.push("_createPageDots"),i.prototype._createPageDots=function(){this.options.pageDots&&(this.pageDots=new r(this),this.on("activate",this.activatePageDots),this.on("cellAddedRemoved",this.onCellAddedRemovedPageDots),this.on("deactivate",this.deactivatePageDots))},i.prototype.activatePageDots=function(){this.pageDots.activate()},i.prototype.onCellAddedRemovedPageDots=function(){this.pageDots.setDots()},i.prototype.deactivatePageDots=function(){this.pageDots.deactivate()},i.PageDots=r,r}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/player",["eventEmitter/EventEmitter","eventie/eventie","./flickity"],function(t,i,n){return e(t,i,n)}):"object"==typeof exports?module.exports=e(require("wolfy87-eventemitter"),require("eventie"),require("./flickity")):(t.Flickity=t.Flickity||{},t.Flickity.Player=e(t.EventEmitter,t.eventie,t.Flickity))}(window,function(t,e,i){function n(t){if(this.isPlaying=!1,this.parent=t,r){var e=this;this.onVisibilityChange=function(){e.visibilityChange()}}}var o,r;return"hidden"in document?(o="hidden",r="visibilitychange"):"webkitHidden"in document&&(o="webkitHidden",r="webkitvisibilitychange"),n.prototype=new t,n.prototype.play=function(){this.isPlaying=!0,delete this.isPaused,r&&document.addEventListener(r,this.onVisibilityChange,!1),this.tick()},n.prototype.tick=function(){if(this.isPlaying&&!this.isPaused){this.tickTime=new Date;var t=this.parent.options.autoPlay;t="number"==typeof t?t:3e3;var e=this;this.timeout=setTimeout(function(){e.parent.next(!0),e.tick()},t)}},n.prototype.stop=function(){this.isPlaying=!1,delete this.isPaused,this.clear(),r&&document.removeEventListener(r,this.onVisibilityChange,!1)},n.prototype.clear=function(){clearTimeout(this.timeout)},n.prototype.pause=function(){this.isPlaying&&(this.isPaused=!0,this.clear())},n.prototype.unpause=function(){this.isPaused&&this.play()},n.prototype.visibilityChange=function(){var t=document[o];this[t?"pause":"unpause"]()},i.createMethods.push("_createPlayer"),i.prototype._createPlayer=function(){this.player=new n(this),this.on("activate",this.activatePlayer),this.on("uiChange",this.stopPlayer),this.on("pointerDown",this.stopPlayer),this.on("deactivate",this.deactivatePlayer)},i.prototype.activatePlayer=function(){this.options.autoPlay&&(this.player.play(),e.bind(this.element,"mouseenter",this),this.isMouseenterBound=!0)},i.prototype.stopPlayer=function(){this.player.stop()},i.prototype.deactivatePlayer=function(){this.player.stop(),this.isMouseenterBound&&(e.unbind(this.element,"mouseenter",this),delete this.isMouseenterBound)},i.prototype.onmouseenter=function(){this.player.pause(),e.bind(this.element,"mouseleave",this)},i.prototype.onmouseleave=function(){this.player.unpause(),e.unbind(this.element,"mouseleave",this)},i.Player=n,n}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/add-remove-cell",["./flickity","fizzy-ui-utils/utils"],function(i,n){return e(t,i,n)}):"object"==typeof exports?module.exports=e(t,require("./flickity"),require("fizzy-ui-utils")):(t.Flickity=t.Flickity||{},t.Flickity=e(t,t.Flickity,t.fizzyUIUtils))}(window,function(t,e,i){function n(t){for(var e=document.createDocumentFragment(),i=0,n=t.length;n>i;i++){var o=t[i];e.appendChild(o.element)}return e}return e.prototype.insert=function(t,e){var i=this._makeCells(t);if(i&&i.length){var o=this.cells.length;e=void 0===e?o:e;var r=n(i),s=e==o;if(s)this.slider.appendChild(r);else{var a=this.cells[e].element;this.slider.insertBefore(r,a)}if(0===e)this.cells=i.concat(this.cells);else if(s)this.cells=this.cells.concat(i);else{var l=this.cells.splice(e,o-e);this.cells=this.cells.concat(i).concat(l)}this._sizeCells(i);var c=e>this.selectedIndex?0:i.length;this._cellAddedRemoved(e,c)}},e.prototype.append=function(t){this.insert(t,this.cells.length)},e.prototype.prepend=function(t){this.insert(t,0)},e.prototype.remove=function(t){var e,n,o,r=this.getCells(t),s=0;for(e=0,n=r.length;n>e;e++){o=r[e];var a=i.indexOf(this.cells,o)<this.selectedIndex;s-=a?1:0}for(e=0,n=r.length;n>e;e++)o=r[e],o.remove(),i.removeFrom(this.cells,o);r.length&&this._cellAddedRemoved(0,s)},e.prototype._cellAddedRemoved=function(t,e){e=e||0,this.selectedIndex+=e,this.selectedIndex=Math.max(0,Math.min(this.cells.length-1,this.selectedIndex)),this.emitEvent("cellAddedRemoved",[t,e]),this.cellChange(t)},e.prototype.cellSizeChange=function(t){var e=this.getCell(t);if(e){e.getSize();var n=i.indexOf(this.cells,e);this.cellChange(n)}},e.prototype.cellChange=function(t){t=t||0,this._positionCells(t),this._getWrapShiftCells(),this.setGallerySize(),this.options.freeScroll?this.positionSlider():(this.positionSliderAtSelected(),this.select(this.selectedIndex))},e}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/index",["./flickity","./drag","./prev-next-button","./page-dots","./player","./add-remove-cell"],e):"object"==typeof exports&&(module.exports=e(require("./flickity"),require("./drag"),require("./prev-next-button"),require("./page-dots"),require("./player"),require("./add-remove-cell")))}(window,function(t){return t}),function(t,e){"function"==typeof define&&define.amd?define("flickity-as-nav-for/as-nav-for",["classie/classie","flickity/js/index","fizzy-ui-utils/utils"],function(i,n,o){return e(t,i,n,o)}):"object"==typeof exports?module.exports=e(t,require("desandro-classie"),require("flickity"),require("fizzy-ui-utils")):t.Flickity=e(t,t.classie,t.Flickity,t.fizzyUIUtils)}(window,function(t,e,i,n){return i.createMethods.push("_createAsNavFor"),i.prototype._createAsNavFor=function(){this.on("activate",this.activateAsNavFor),this.on("deactivate",this.deactivateAsNavFor),this.on("destroy",this.destroyAsNavFor);var t=this.options.asNavFor;if(t){var e=this;setTimeout(function(){e.setNavCompanion(t)})}},i.prototype.setNavCompanion=function(t){t=n.getQueryElement(t);var e=i.data(t);if(e&&e!=this){this.navCompanion=e;var o=this;this.onNavCompanionSelect=function(){o.navCompanionSelect()},e.on("cellSelect",this.onNavCompanionSelect),this.on("staticClick",this.onNavStaticClick),this.navCompanionSelect()}},i.prototype.navCompanionSelect=function(){if(this.navCompanion){var t=this.navCompanion.selectedIndex;this.select(t),this.removeNavSelectedElement(),this.selectedIndex==t&&(this.navSelectedElement=this.cells[t].element,e.add(this.navSelectedElement,"is-nav-selected"))}},i.prototype.activateAsNavFor=function(){this.navCompanionSelect()},i.prototype.removeNavSelectedElement=function(){this.navSelectedElement&&(e.remove(this.navSelectedElement,"is-nav-selected"),delete this.navSelectedElement)},i.prototype.onNavStaticClick=function(t,e,i,n){"number"==typeof n&&this.navCompanion.select(n)},i.prototype.deactivateAsNavFor=function(){this.removeNavSelectedElement()},i.prototype.destroyAsNavFor=function(){this.navCompanion&&(this.navCompanion.off("cellSelect",this.onNavCompanionSelect),this.off("staticClick",this.onNavStaticClick),delete this.navCompanion)},i}),function(t,e){"function"==typeof define&&define.amd?define("imagesloaded/imagesloaded",["eventEmitter/EventEmitter","eventie/eventie"],function(i,n){return e(t,i,n)}):"object"==typeof exports?module.exports=e(t,require("wolfy87-eventemitter"),require("eventie")):t.imagesLoaded=e(t,t.EventEmitter,t.eventie)}(window,function(t,e,i){function n(t,e){for(var i in e)t[i]=e[i];return t}function o(t){return"[object Array]"===p.call(t)}function r(t){var e=[];if(o(t))e=t;else if("number"==typeof t.length)for(var i=0,n=t.length;n>i;i++)e.push(t[i]);else e.push(t);return e}function s(t,e,i){if(!(this instanceof s))return new s(t,e);"string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=r(t),this.options=n({},this.options),"function"==typeof e?i=e:n(this.options,e),i&&this.on("always",i),this.getImages(),c&&(this.jqDeferred=new c.Deferred);var o=this;setTimeout(function(){o.check()})}function a(t){this.img=t}function l(t){this.src=t,u[t]=this}var c=t.jQuery,h=t.console,d="undefined"!=typeof h,p=Object.prototype.toString;s.prototype=new e,s.prototype.options={},s.prototype.getImages=function(){this.images=[];for(var t=0,e=this.elements.length;e>t;t++){var i=this.elements[t];"IMG"===i.nodeName&&this.addImage(i);var n=i.nodeType;if(n&&(1===n||9===n||11===n))for(var o=i.querySelectorAll("img"),r=0,s=o.length;s>r;r++){var a=o[r];this.addImage(a)}}},s.prototype.addImage=function(t){var e=new a(t);this.images.push(e)},s.prototype.check=function(){function t(t,o){return e.options.debug&&d&&h.log("confirm",t,o),e.progress(t),i++,i===n&&e.complete(),!0}var e=this,i=0,n=this.images.length;if(this.hasAnyBroken=!1,!n)return void this.complete();for(var o=0;n>o;o++){var r=this.images[o];r.on("confirm",t),r.check()}},s.prototype.progress=function(t){this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded;var e=this;setTimeout(function(){e.emit("progress",e,t),e.jqDeferred&&e.jqDeferred.notify&&e.jqDeferred.notify(e,t)})},s.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var e=this;setTimeout(function(){if(e.emit(t,e),e.emit("always",e),e.jqDeferred){var i=e.hasAnyBroken?"reject":"resolve";e.jqDeferred[i](e)}})},c&&(c.fn.imagesLoaded=function(t,e){var i=new s(this,t,e);return i.jqDeferred.promise(c(this))}),a.prototype=new e,a.prototype.check=function(){var t=u[this.img.src]||new l(this.img.src);if(t.isConfirmed)return void this.confirm(t.isLoaded,"cached was confirmed");if(this.img.complete&&void 0!==this.img.naturalWidth)return void this.confirm(0!==this.img.naturalWidth,"naturalWidth");var e=this;t.on("confirm",function(t,i){return e.confirm(t.isLoaded,i),!0}),t.check()},a.prototype.confirm=function(t,e){this.isLoaded=t,this.emit("confirm",this,e)};var u={};return l.prototype=new e,l.prototype.check=function(){if(!this.isChecked){var t=new Image;i.bind(t,"load",this),i.bind(t,"error",this),t.src=this.src,this.isChecked=!0}},l.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},l.prototype.onload=function(t){this.confirm(!0,"onload"),this.unbindProxyEvents(t)},l.prototype.onerror=function(t){this.confirm(!1,"onerror"),this.unbindProxyEvents(t)},l.prototype.confirm=function(t,e){this.isConfirmed=!0,this.isLoaded=t,this.emit("confirm",this,e)},l.prototype.unbindProxyEvents=function(t){i.unbind(t.target,"load",this),i.unbind(t.target,"error",this)},s}),function(t,e){"function"==typeof define&&define.amd?define(["flickity/js/index","imagesloaded/imagesloaded"],function(i,n){return e(t,i,n)}):"object"==typeof exports?module.exports=e(t,require("flickity"),require("imagesloaded")):t.Flickity=e(t,t.Flickity,t.imagesLoaded)}(window,function(t,e,i){return e.createMethods.push("_createImagesLoaded"),e.prototype._createImagesLoaded=function(){this.on("activate",this.imagesLoaded)},e.prototype.imagesLoaded=function(){function t(t,i){var n=e.getParentCell(i.img);e.cellSizeChange(n&&n.element)}if(this.options.imagesLoaded){var e=this;i(this.slider).on("progress",t)}},e}),function($){"use strict";$.fn.fitVids=function(options){var settings={customSelector:null,ignore:null};if(!document.getElementById("fit-vids-style")){var head=document.head||document.getElementsByTagName("head")[0],css=".fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}",div=document.createElement("div");div.innerHTML='<p>x</p><style id="fit-vids-style">'+css+"</style>",head.appendChild(div.childNodes[1])}return options&&$.extend(settings,options),this.each(function(){var selectors=['iframe[src*="player.vimeo.com"]','iframe[src*="youtube.com"]','iframe[src*="youtube-nocookie.com"]','iframe[src*="kickstarter.com"][src*="video.html"]',"object","embed"];settings.customSelector&&selectors.push(settings.customSelector);var ignoreList=".fitvidsignore";settings.ignore&&(ignoreList=ignoreList+", "+settings.ignore);var $allVideos=$(this).find(selectors.join(","));$allVideos=$allVideos.not("object object"),$allVideos=$allVideos.not(ignoreList),$allVideos.each(function(count){var $this=$(this);if(!($this.parents(ignoreList).length>0||"embed"===this.tagName.toLowerCase()&&$this.parent("object").length||$this.parent(".fluid-width-video-wrapper").length)){$this.css("height")||$this.css("width")||!isNaN($this.attr("height"))&&!isNaN($this.attr("width"))||($this.attr("height",9),$this.attr("width",16));var height="object"===this.tagName.toLowerCase()||$this.attr("height")&&!isNaN(parseInt($this.attr("height"),10))?parseInt($this.attr("height"),10):$this.height(),width=isNaN(parseInt($this.attr("width"),10))?$this.width():parseInt($this.attr("width"),10),aspectRatio=height/width;if(!$this.attr("id")){var videoID="fitvid"+count;$this.attr("id",videoID)}$this.wrap('<div class="fluid-width-video-wrapper"></div>').parent(".fluid-width-video-wrapper").css("padding-top",100*aspectRatio+"%"),$this.removeAttr("height").removeAttr("width")}})})}}(window.jQuery||window.Zepto),function($,window,document,undefined){"use strict";function Plugin(element,options){if(this.el=element,this.$el=$(element),this.s=$.extend({},defaults,options),this.s.dynamic&&"undefined"!==this.s.dynamicEl&&this.s.dynamicEl.constructor===Array&&!this.s.dynamicEl.length)throw"When using dynamic mode, you must also define dynamicEl as an Array.";return this.modules={},this.lGalleryOn=!1,this.lgBusy=!1,this.hideBartimeout=!1,this.isTouch="ontouchstart"in document.documentElement,this.s.slideEndAnimatoin&&(this.s.hideControlOnEnd=!1),this.s.dynamic?this.$items=this.s.dynamicEl:"this"===this.s.selector?this.$items=this.$el:""!==this.s.selector?this.s.selectWithin?this.$items=$(this.s.selectWithin).find(this.s.selector):this.$items=this.$el.find($(this.s.selector)):this.$items=this.$el.children(),this.$slide="",this.$outer="",this.init(),this}var defaults={mode:"lg-slide",cssEasing:"ease",easing:"linear",speed:600,height:"100%",width:"100%",addClass:"",startClass:"lg-start-zoom",backdropDuration:150,hideBarsDelay:6e3,useLeft:!1,closable:!0,loop:!0,escKey:!0,keyPress:!0,controls:!0,slideEndAnimatoin:!0,hideControlOnEnd:!1,mousewheel:!0,getCaptionFromTitleOrAlt:!0,appendSubHtmlTo:".lg-sub-html",subHtmlSelectorRelative:!1,preload:1,showAfterLoad:!0,selector:"",selectWithin:"",nextHtml:"",prevHtml:"",index:!1,iframeMaxWidth:"100%",download:!0,counter:!0,appendCounterTo:".lg-toolbar",swipeThreshold:50,enableSwipe:!0,enableDrag:!0,dynamic:!1,dynamicEl:[],galleryId:1};Plugin.prototype.init=function(){var _this=this;_this.s.preload>_this.$items.length&&(_this.s.preload=_this.$items.length);var _hash=window.location.hash;_hash.indexOf("lg="+this.s.galleryId)>0&&(_this.index=parseInt(_hash.split("&slide=")[1],10),$("body").addClass("lg-from-hash"),$("body").hasClass("lg-on")||(setTimeout(function(){_this.build(_this.index)}),$("body").addClass("lg-on"))),_this.s.dynamic?(_this.$el.trigger("onBeforeOpen.lg"),_this.index=_this.s.index||0,$("body").hasClass("lg-on")||setTimeout(function(){_this.build(_this.index),$("body").addClass("lg-on")})):_this.$items.on("click.lgcustom",function(event){try{event.preventDefault(),event.preventDefault()}catch(er){event.returnValue=!1}_this.$el.trigger("onBeforeOpen.lg"),_this.index=_this.s.index||_this.$items.index(this),$("body").hasClass("lg-on")||(_this.build(_this.index),$("body").addClass("lg-on"))})},Plugin.prototype.build=function(index){var _this=this;_this.structure(),$.each($.fn.lightGallery.modules,function(key){_this.modules[key]=new $.fn.lightGallery.modules[key](_this.el)}),_this.slide(index,!1,!1),_this.s.keyPress&&_this.keyPress(),_this.$items.length>1&&(_this.arrow(),setTimeout(function(){_this.enableDrag(),_this.enableSwipe()},50),_this.s.mousewheel&&_this.mousewheel()),_this.counter(),_this.closeGallery(),_this.$el.trigger("onAfterOpen.lg"),_this.$outer.on("mousemove.lg click.lg touchstart.lg",function(){_this.$outer.removeClass("lg-hide-items"),clearTimeout(_this.hideBartimeout),_this.hideBartimeout=setTimeout(function(){_this.$outer.addClass("lg-hide-items")},_this.s.hideBarsDelay)})},Plugin.prototype.structure=function(){var template,list="",controls="",i=0,subHtmlCont="",_this=this;for($("body").append('<div class="lg-backdrop"></div>'),$(".lg-backdrop").css("transition-duration",this.s.backdropDuration+"ms"),i=0;i<this.$items.length;i++)list+='<div class="lg-item"></div>';if(this.s.controls&&this.$items.length>1&&(controls='<div class="lg-actions"><div class="lg-prev lg-icon">'+this.s.prevHtml+'</div><div class="lg-next lg-icon">'+this.s.nextHtml+"</div></div>"),".lg-sub-html"===this.s.appendSubHtmlTo&&(subHtmlCont='<div class="lg-sub-html"></div>'),template='<div class="lg-outer '+this.s.addClass+" "+this.s.startClass+'"><div class="lg" style="width:'+this.s.width+"; height:"+this.s.height+'"><div class="lg-inner">'+list+'</div><div class="lg-toolbar group"><span class="lg-close lg-icon"></span></div>'+controls+subHtmlCont+"</div></div>",$("body").append(template),this.$outer=$(".lg-outer"),this.$slide=this.$outer.find(".lg-item"),this.s.useLeft?(this.$outer.addClass("lg-use-left"),this.s.mode="lg-slide"):this.$outer.addClass("lg-use-css3"),_this.setTop(),$(window).on("resize.lg orientationchange.lg",function(){setTimeout(function(){_this.setTop()},100)}),this.$slide.eq(this.index).addClass("lg-current"),this.doCss()?this.$outer.addClass("lg-css3"):(this.$outer.addClass("lg-css"),this.s.speed=0),this.$outer.addClass(this.s.mode),this.s.enableDrag&&this.$items.length>1&&this.$outer.addClass("lg-grab"),this.s.showAfterLoad&&this.$outer.addClass("lg-show-after-load"),this.doCss()){var $inner=this.$outer.find(".lg-inner");$inner.css("transition-timing-function",this.s.cssEasing),$inner.css("transition-duration",this.s.speed+"ms")}$(".lg-backdrop").addClass("in"),setTimeout(function(){_this.$outer.addClass("lg-visible")},this.s.backdropDuration),this.s.download&&this.$outer.find(".lg-toolbar").append('<a id="lg-download" target="_blank" download class="lg-download lg-icon"></a>'),this.prevScrollTop=$(window).scrollTop()},Plugin.prototype.setTop=function(){if("100%"!==this.s.height){var wH=$(window).height(),top=(wH-parseInt(this.s.height,10))/2,$lGallery=this.$outer.find(".lg");wH>=parseInt(this.s.height,10)?$lGallery.css("top",top+"px"):$lGallery.css("top","0px")}},Plugin.prototype.doCss=function(){var support=function(){var transition=["transition","MozTransition","WebkitTransition","OTransition","msTransition","KhtmlTransition"],root=document.documentElement,i=0;for(i=0;i<transition.length;i++)if(transition[i]in root.style)return!0};return!!support()},Plugin.prototype.isVideo=function(src,index){var html;if(html=this.s.dynamic?this.s.dynamicEl[index].html:this.$items.eq(index).attr("data-html"),!src&&html)return{html5:!0};var youtube=src.match(/\/\/(?:www\.)?youtu(?:\.be|be\.com)\/(?:watch\?v=|embed\/)?([a-z0-9\-\_\%]+)/i),vimeo=src.match(/\/\/(?:www\.)?vimeo.com\/([0-9a-z\-_]+)/i),dailymotion=src.match(/\/\/(?:www\.)?dai.ly\/([0-9a-z\-_]+)/i),vk=src.match(/\/\/(?:www\.)?(?:vk\.com|vkontakte\.ru)\/(?:video_ext\.php\?)(.*)/i);return youtube?{youtube:youtube}:vimeo?{vimeo:vimeo}:dailymotion?{dailymotion:dailymotion}:vk?{vk:vk}:void 0},Plugin.prototype.counter=function(){this.s.counter&&$(this.s.appendCounterTo).append('<div id="lg-counter"><span id="lg-counter-current">'+(parseInt(this.index,10)+1)+'</span> / <span id="lg-counter-all">'+this.$items.length+"</span></div>")},Plugin.prototype.addHtml=function(index){var subHtmlUrl,$currentEle,subHtml=null;if(this.s.dynamic?this.s.dynamicEl[index].subHtmlUrl?subHtmlUrl=this.s.dynamicEl[index].subHtmlUrl:subHtml=this.s.dynamicEl[index].subHtml:($currentEle=this.$items.eq(index),$currentEle.attr("data-sub-html-url")?subHtmlUrl=$currentEle.attr("data-sub-html-url"):(subHtml=$currentEle.attr("data-sub-html"),this.s.getCaptionFromTitleOrAlt&&!subHtml&&(subHtml=$currentEle.attr("title")||$currentEle.find("img").first().attr("alt")))),!subHtmlUrl)if("undefined"!=typeof subHtml&&null!==subHtml){var fL=subHtml.substring(0,1);"."!==fL&&"#"!==fL||(subHtml=this.s.subHtmlSelectorRelative&&!this.s.dynamic?$currentEle.find(subHtml).html():$(subHtml).html())}else subHtml="";".lg-sub-html"===this.s.appendSubHtmlTo?subHtmlUrl?this.$outer.find(this.s.appendSubHtmlTo).load(subHtmlUrl):this.$outer.find(this.s.appendSubHtmlTo).html(subHtml):subHtmlUrl?this.$slide.eq(index).load(subHtmlUrl):this.$slide.eq(index).append(subHtml),"undefined"!=typeof subHtml&&null!==subHtml&&(""===subHtml?this.$outer.find(this.s.appendSubHtmlTo).addClass("lg-empty-html"):this.$outer.find(this.s.appendSubHtmlTo).removeClass("lg-empty-html")),this.$el.trigger("onAfterAppendSubHtml.lg",[index])},Plugin.prototype.preload=function(index){var i=1,j=1;for(i=1;i<=this.s.preload&&!(i>=this.$items.length-index);i++)this.loadContent(index+i,!1,0);for(j=1;j<=this.s.preload&&!(0>index-j);j++)this.loadContent(index-j,!1,0)},Plugin.prototype.loadContent=function(index,rec,delay){var _$img,_src,_poster,_srcset,_sizes,_html,_this=this,_hasPoster=!1,getResponsiveSrc=function(srcItms){for(var rsWidth=[],rsSrc=[],i=0;i<srcItms.length;i++){var __src=srcItms[i].split(" ");""===__src[0]&&__src.splice(0,1),rsSrc.push(__src[0]),rsWidth.push(__src[1])}for(var wWidth=$(window).width(),j=0;j<rsWidth.length;j++)if(parseInt(rsWidth[j],10)>wWidth){_src=rsSrc[j];break}};if(_this.s.dynamic){if(_this.s.dynamicEl[index].poster&&(_hasPoster=!0,_poster=_this.s.dynamicEl[index].poster),_html=_this.s.dynamicEl[index].html,_src=_this.s.dynamicEl[index].src,_this.s.dynamicEl[index].responsive){var srcDyItms=_this.s.dynamicEl[index].responsive.split(",");getResponsiveSrc(srcDyItms)}_srcset=_this.s.dynamicEl[index].srcset,_sizes=_this.s.dynamicEl[index].sizes}else{if(_this.$items.eq(index).attr("data-poster")&&(_hasPoster=!0,_poster=_this.$items.eq(index).attr("data-poster")),_html=_this.$items.eq(index).attr("data-html"),_src=_this.$items.eq(index).attr("href")||_this.$items.eq(index).attr("data-src"),_this.$items.eq(index).attr("data-responsive")){var srcItms=_this.$items.eq(index).attr("data-responsive").split(",");getResponsiveSrc(srcItms)}_srcset=_this.$items.eq(index).attr("data-srcset"),_sizes=_this.$items.eq(index).attr("data-sizes")}var iframe=!1;_this.s.dynamic?_this.s.dynamicEl[index].iframe&&(iframe=!0):"true"===_this.$items.eq(index).attr("data-iframe")&&(iframe=!0);var _isVideo=_this.isVideo(_src,index);if(!_this.$slide.eq(index).hasClass("lg-loaded")){if(iframe)_this.$slide.eq(index).prepend('<div class="lg-video-cont" style="max-width:'+_this.s.iframeMaxWidth+'"><div class="lg-video"><iframe class="lg-object" frameborder="0" src="'+_src+'"  allowfullscreen="true"></iframe></div></div>');else if(_hasPoster){var videoClass="";videoClass=_isVideo&&_isVideo.youtube?"lg-has-youtube":_isVideo&&_isVideo.vimeo?"lg-has-vimeo":"lg-has-html5",_this.$slide.eq(index).prepend('<div class="lg-video-cont '+videoClass+' "><div class="lg-video"><span class="lg-video-play"></span><img class="lg-object lg-has-poster" src="'+_poster+'" /></div></div>')}else _isVideo?(_this.$slide.eq(index).prepend('<div class="lg-video-cont "><div class="lg-video"></div></div>'),_this.$el.trigger("hasVideo.lg",[index,_src,_html])):_this.$slide.eq(index).prepend('<div class="lg-img-wrap"><img class="lg-object lg-image" src="'+_src+'" /></div>');if(_this.$el.trigger("onAferAppendSlide.lg",[index]),_$img=_this.$slide.eq(index).find(".lg-object"),_sizes&&_$img.attr("sizes",_sizes),_srcset){_$img.attr("srcset",_srcset);try{picturefill({elements:[_$img[0]]})}catch(e){console.error("Make sure you have included Picturefill version 2")}}".lg-sub-html"!==this.s.appendSubHtmlTo&&_this.addHtml(index),_this.$slide.eq(index).addClass("lg-loaded")}_this.$slide.eq(index).find(".lg-object").on("load.lg error.lg",function(){
var _speed=0;delay&&!$("body").hasClass("lg-from-hash")&&(_speed=delay),setTimeout(function(){_this.$slide.eq(index).addClass("lg-complete"),_this.$el.trigger("onSlideItemLoad.lg",[index,delay||0])},_speed)}),_isVideo&&_isVideo.html5&&!_hasPoster&&_this.$slide.eq(index).addClass("lg-complete"),rec===!0&&(_this.$slide.eq(index).hasClass("lg-complete")?_this.preload(index):_this.$slide.eq(index).find(".lg-object").on("load.lg error.lg",function(){_this.preload(index)}))},Plugin.prototype.slide=function(index,fromTouch,fromThumb){var _prevIndex=this.$outer.find(".lg-current").index(),_this=this;if(!_this.lGalleryOn||_prevIndex!==index){var _length=this.$slide.length,_time=_this.lGalleryOn?this.s.speed:0,_next=!1,_prev=!1;if(!_this.lgBusy){if(this.s.download){var _src;_src=_this.s.dynamic?_this.s.dynamicEl[index].downloadUrl!==!1&&(_this.s.dynamicEl[index].downloadUrl||_this.s.dynamicEl[index].src):"false"!==_this.$items.eq(index).attr("data-download-url")&&(_this.$items.eq(index).attr("data-download-url")||_this.$items.eq(index).attr("href")||_this.$items.eq(index).attr("data-src")),_src?($("#lg-download").attr("href",_src),_this.$outer.removeClass("lg-hide-download")):_this.$outer.addClass("lg-hide-download")}if(this.$el.trigger("onBeforeSlide.lg",[_prevIndex,index,fromTouch,fromThumb]),_this.lgBusy=!0,clearTimeout(_this.hideBartimeout),".lg-sub-html"===this.s.appendSubHtmlTo&&setTimeout(function(){_this.addHtml(index)},_time),this.arrowDisable(index),fromTouch){var touchPrev=index-1,touchNext=index+1;0===index&&_prevIndex===_length-1?(touchNext=0,touchPrev=_length-1):index===_length-1&&0===_prevIndex&&(touchNext=0,touchPrev=_length-1),this.$slide.removeClass("lg-prev-slide lg-current lg-next-slide"),_this.$slide.eq(touchPrev).addClass("lg-prev-slide"),_this.$slide.eq(touchNext).addClass("lg-next-slide"),_this.$slide.eq(index).addClass("lg-current")}else _this.$outer.addClass("lg-no-trans"),this.$slide.removeClass("lg-prev-slide lg-next-slide"),_prevIndex>index?(_prev=!0,0!==index||_prevIndex!==_length-1||fromThumb||(_prev=!1,_next=!0)):index>_prevIndex&&(_next=!0,index!==_length-1||0!==_prevIndex||fromThumb||(_prev=!0,_next=!1)),_prev?(this.$slide.eq(index).addClass("lg-prev-slide"),this.$slide.eq(_prevIndex).addClass("lg-next-slide")):_next&&(this.$slide.eq(index).addClass("lg-next-slide"),this.$slide.eq(_prevIndex).addClass("lg-prev-slide")),setTimeout(function(){_this.$slide.removeClass("lg-current"),_this.$slide.eq(index).addClass("lg-current"),_this.$outer.removeClass("lg-no-trans")},50);_this.lGalleryOn?(setTimeout(function(){_this.loadContent(index,!0,0)},this.s.speed+50),setTimeout(function(){_this.lgBusy=!1,_this.$el.trigger("onAfterSlide.lg",[_prevIndex,index,fromTouch,fromThumb])},this.s.speed)):(_this.loadContent(index,!0,_this.s.backdropDuration),_this.lgBusy=!1,_this.$el.trigger("onAfterSlide.lg",[_prevIndex,index,fromTouch,fromThumb])),_this.lGalleryOn=!0,this.s.counter&&$("#lg-counter-current").text(index+1)}}},Plugin.prototype.goToNextSlide=function(fromTouch){var _this=this;_this.lgBusy||(_this.index+1<_this.$slide.length?(_this.index++,_this.$el.trigger("onBeforeNextSlide.lg",[_this.index]),_this.slide(_this.index,fromTouch,!1)):_this.s.loop?(_this.index=0,_this.$el.trigger("onBeforeNextSlide.lg",[_this.index]),_this.slide(_this.index,fromTouch,!1)):_this.s.slideEndAnimatoin&&(_this.$outer.addClass("lg-right-end"),setTimeout(function(){_this.$outer.removeClass("lg-right-end")},400)))},Plugin.prototype.goToPrevSlide=function(fromTouch){var _this=this;_this.lgBusy||(_this.index>0?(_this.index--,_this.$el.trigger("onBeforePrevSlide.lg",[_this.index,fromTouch]),_this.slide(_this.index,fromTouch,!1)):_this.s.loop?(_this.index=_this.$items.length-1,_this.$el.trigger("onBeforePrevSlide.lg",[_this.index,fromTouch]),_this.slide(_this.index,fromTouch,!1)):_this.s.slideEndAnimatoin&&(_this.$outer.addClass("lg-left-end"),setTimeout(function(){_this.$outer.removeClass("lg-left-end")},400)))},Plugin.prototype.keyPress=function(){var _this=this;this.$items.length>1&&$(window).on("keyup.lg",function(e){_this.$items.length>1&&(37===e.keyCode&&(e.preventDefault(),_this.goToPrevSlide()),39===e.keyCode&&(e.preventDefault(),_this.goToNextSlide()))}),$(window).on("keydown.lg",function(e){_this.s.escKey===!0&&27===e.keyCode&&(e.preventDefault(),_this.$outer.hasClass("lg-thumb-open")?_this.$outer.removeClass("lg-thumb-open"):_this.destroy())})},Plugin.prototype.arrow=function(){var _this=this;this.$outer.find(".lg-prev").on("click.lg",function(){_this.goToPrevSlide()}),this.$outer.find(".lg-next").on("click.lg",function(){_this.goToNextSlide()})},Plugin.prototype.arrowDisable=function(index){!this.s.loop&&this.s.hideControlOnEnd&&(index+1<this.$slide.length?this.$outer.find(".lg-next").removeAttr("disabled").removeClass("disabled"):this.$outer.find(".lg-next").attr("disabled","disabled").addClass("disabled"),index>0?this.$outer.find(".lg-prev").removeAttr("disabled").removeClass("disabled"):this.$outer.find(".lg-prev").attr("disabled","disabled").addClass("disabled"))},Plugin.prototype.setTranslate=function($el,xValue,yValue){this.s.useLeft?$el.css("left",xValue):$el.css({transform:"translate3d("+xValue+"px, "+yValue+"px, 0px)"})},Plugin.prototype.touchMove=function(startCoords,endCoords){var distance=endCoords-startCoords;Math.abs(distance)>15&&(this.$outer.addClass("lg-dragging"),this.setTranslate(this.$slide.eq(this.index),distance,0),this.setTranslate($(".lg-prev-slide"),-this.$slide.eq(this.index).width()+distance,0),this.setTranslate($(".lg-next-slide"),this.$slide.eq(this.index).width()+distance,0))},Plugin.prototype.touchEnd=function(distance){var _this=this;"lg-slide"!==_this.s.mode&&_this.$outer.addClass("lg-slide"),this.$slide.not(".lg-current, .lg-prev-slide, .lg-next-slide").css("opacity","0"),setTimeout(function(){_this.$outer.removeClass("lg-dragging"),0>distance&&Math.abs(distance)>_this.s.swipeThreshold?_this.goToNextSlide(!0):distance>0&&Math.abs(distance)>_this.s.swipeThreshold?_this.goToPrevSlide(!0):Math.abs(distance)<5&&_this.$el.trigger("onSlideClick.lg"),_this.$slide.removeAttr("style")}),setTimeout(function(){_this.$outer.hasClass("lg-dragging")||"lg-slide"===_this.s.mode||_this.$outer.removeClass("lg-slide")},_this.s.speed+100)},Plugin.prototype.enableSwipe=function(){var _this=this,startCoords=0,endCoords=0,isMoved=!1;_this.s.enableSwipe&&_this.isTouch&&_this.doCss()&&(_this.$slide.on("touchstart.lg",function(e){_this.$outer.hasClass("lg-zoomed")||_this.lgBusy||(e.preventDefault(),_this.manageSwipeClass(),startCoords=e.originalEvent.targetTouches[0].pageX)}),_this.$slide.on("touchmove.lg",function(e){_this.$outer.hasClass("lg-zoomed")||(e.preventDefault(),endCoords=e.originalEvent.targetTouches[0].pageX,_this.touchMove(startCoords,endCoords),isMoved=!0)}),_this.$slide.on("touchend.lg",function(){_this.$outer.hasClass("lg-zoomed")||(isMoved?(isMoved=!1,_this.touchEnd(endCoords-startCoords)):_this.$el.trigger("onSlideClick.lg"))}))},Plugin.prototype.enableDrag=function(){var _this=this,startCoords=0,endCoords=0,isDraging=!1,isMoved=!1;_this.s.enableDrag&&!_this.isTouch&&_this.doCss()&&(_this.$slide.on("mousedown.lg",function(e){_this.$outer.hasClass("lg-zoomed")||($(e.target).hasClass("lg-object")||$(e.target).hasClass("lg-video-play"))&&(e.preventDefault(),_this.lgBusy||(_this.manageSwipeClass(),startCoords=e.pageX,isDraging=!0,_this.$outer.scrollLeft+=1,_this.$outer.scrollLeft-=1,_this.$outer.removeClass("lg-grab").addClass("lg-grabbing"),_this.$el.trigger("onDragstart.lg")))}),$(window).on("mousemove.lg",function(e){isDraging&&(isMoved=!0,endCoords=e.pageX,_this.touchMove(startCoords,endCoords),_this.$el.trigger("onDragmove.lg"))}),$(window).on("mouseup.lg",function(e){isMoved?(isMoved=!1,_this.touchEnd(endCoords-startCoords),_this.$el.trigger("onDragend.lg")):($(e.target).hasClass("lg-object")||$(e.target).hasClass("lg-video-play"))&&_this.$el.trigger("onSlideClick.lg"),isDraging&&(isDraging=!1,_this.$outer.removeClass("lg-grabbing").addClass("lg-grab"))}))},Plugin.prototype.manageSwipeClass=function(){var touchNext=this.index+1,touchPrev=this.index-1,length=this.$slide.length;this.s.loop&&(0===this.index?touchPrev=length-1:this.index===length-1&&(touchNext=0)),this.$slide.removeClass("lg-next-slide lg-prev-slide"),touchPrev>-1&&this.$slide.eq(touchPrev).addClass("lg-prev-slide"),this.$slide.eq(touchNext).addClass("lg-next-slide")},Plugin.prototype.mousewheel=function(){var _this=this;_this.$outer.on("mousewheel.lg",function(e){e.deltaY&&(e.deltaY>0?_this.goToPrevSlide():_this.goToNextSlide(),e.preventDefault())})},Plugin.prototype.closeGallery=function(){var _this=this,mousedown=!1;this.$outer.find(".lg-close").on("click.lg",function(){_this.destroy()}),_this.s.closable&&(_this.$outer.on("mousedown.lg",function(e){mousedown=!!($(e.target).is(".lg-outer")||$(e.target).is(".lg-item ")||$(e.target).is(".lg-img-wrap"))}),_this.$outer.on("mouseup.lg",function(e){($(e.target).is(".lg-outer")||$(e.target).is(".lg-item ")||$(e.target).is(".lg-img-wrap")&&mousedown)&&(_this.$outer.hasClass("lg-dragging")||_this.destroy())}))},Plugin.prototype.destroy=function(d){var _this=this;d||_this.$el.trigger("onBeforeClose.lg"),$(window).scrollTop(_this.prevScrollTop),d&&(_this.s.dynamic||this.$items.off("click.lg click.lgcustom"),$.removeData(_this.el,"lightGallery")),this.$el.off(".lg.tm"),$.each($.fn.lightGallery.modules,function(key){_this.modules[key]&&_this.modules[key].destroy()}),this.lGalleryOn=!1,clearTimeout(_this.hideBartimeout),this.hideBartimeout=!1,$(window).off(".lg"),$("body").removeClass("lg-on lg-from-hash"),_this.$outer&&_this.$outer.removeClass("lg-visible"),$(".lg-backdrop").removeClass("in"),setTimeout(function(){_this.$outer&&_this.$outer.remove(),$(".lg-backdrop").remove(),d||_this.$el.trigger("onCloseAfter.lg")},_this.s.backdropDuration+50)},$.fn.lightGallery=function(options){return this.each(function(){if($.data(this,"lightGallery"))try{$(this).data("lightGallery").init()}catch(err){console.error("lightGallery has not initiated properly")}else $.data(this,"lightGallery",new Plugin(this,options))})},$.fn.lightGallery.modules={}}(jQuery,window,document),function($,window,document,undefined){"use strict";var defaults={scale:1,zoom:!0,actualSize:!0,enableZoomAfter:300},Zoom=function(element){return this.core=$(element).data("lightGallery"),this.core.s=$.extend({},defaults,this.core.s),this.core.s.zoom&&this.core.doCss()&&(this.init(),this.zoomabletimeout=!1,this.pageX=$(window).width()/2,this.pageY=$(window).height()/2+$(window).scrollTop()),this};Zoom.prototype.init=function(){var _this=this,zoomIcons='<span id="lg-zoom-in" class="lg-icon"></span><span id="lg-zoom-out" class="lg-icon"></span>';_this.core.s.actualSize&&(zoomIcons+='<span id="lg-actual-size" class="lg-icon"></span>'),this.core.$outer.find(".lg-toolbar").append(zoomIcons),_this.core.$el.on("onSlideItemLoad.lg.tm.zoom",function(event,index,delay){var _speed=_this.core.s.enableZoomAfter+delay;$("body").hasClass("lg-from-hash")&&delay?_speed=0:$("body").removeClass("lg-from-hash"),_this.zoomabletimeout=setTimeout(function(){_this.core.$slide.eq(index).addClass("lg-zoomable")},_speed+30)});var scale=1,zoom=function(scaleVal){var _x,_y,$image=_this.core.$outer.find(".lg-current .lg-image"),offsetX=($(window).width()-$image.width())/2,offsetY=($(window).height()-$image.height())/2+$(window).scrollTop();_x=_this.pageX-offsetX,_y=_this.pageY-offsetY;var x=(scaleVal-1)*_x,y=(scaleVal-1)*_y;$image.css("transform","scale3d("+scaleVal+", "+scaleVal+", 1)").attr("data-scale",scaleVal),$image.parent().css({left:-x+"px",top:-y+"px"}).attr("data-x",x).attr("data-y",y)},callScale=function(){scale>1?_this.core.$outer.addClass("lg-zoomed"):_this.resetZoom(),1>scale&&(scale=1),zoom(scale)},actualSize=function(event,$image,index,fromIcon){var nw,w=$image.width();nw=_this.core.s.dynamic?_this.core.s.dynamicEl[index].width||$image[0].naturalWidth||w:_this.core.$items.eq(index).attr("data-width")||$image[0].naturalWidth||w;var _scale;_this.core.$outer.hasClass("lg-zoomed")?scale=1:nw>w&&(_scale=nw/w,scale=_scale||2),fromIcon?(_this.pageX=$(window).width()/2,_this.pageY=$(window).height()/2+$(window).scrollTop()):(_this.pageX=event.pageX||event.originalEvent.targetTouches[0].pageX,_this.pageY=event.pageY||event.originalEvent.targetTouches[0].pageY),callScale(),setTimeout(function(){_this.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")},10)},tapped=!1;_this.core.$el.on("onAferAppendSlide.lg.tm.zoom",function(event,index){var $image=_this.core.$slide.eq(index).find(".lg-image");$image.on("dblclick",function(event){actualSize(event,$image,index)}),$image.on("touchstart",function(event){tapped?(clearTimeout(tapped),tapped=null,actualSize(event,$image,index)):tapped=setTimeout(function(){tapped=null},300),event.preventDefault()})}),$(window).on("resize.lg.zoom scroll.lg.zoom orientationchange.lg.zoom",function(){_this.pageX=$(window).width()/2,_this.pageY=$(window).height()/2+$(window).scrollTop(),zoom(scale)}),$("#lg-zoom-out").on("click.lg",function(){_this.core.$outer.find(".lg-current .lg-image").length&&(scale-=_this.core.s.scale,callScale())}),$("#lg-zoom-in").on("click.lg",function(){_this.core.$outer.find(".lg-current .lg-image").length&&(scale+=_this.core.s.scale,callScale())}),$("#lg-actual-size").on("click.lg",function(event){actualSize(event,_this.core.$slide.eq(_this.core.index).find(".lg-image"),_this.core.index,!0)}),_this.core.$el.on("onBeforeSlide.lg.tm",function(){scale=1,_this.resetZoom()}),_this.core.isTouch||_this.zoomDrag(),_this.core.isTouch&&_this.zoomSwipe()},Zoom.prototype.resetZoom=function(){this.core.$outer.removeClass("lg-zoomed"),this.core.$slide.find(".lg-img-wrap").removeAttr("style data-x data-y"),this.core.$slide.find(".lg-image").removeAttr("style data-scale"),this.pageX=$(window).width()/2,this.pageY=$(window).height()/2+$(window).scrollTop()},Zoom.prototype.zoomSwipe=function(){var _this=this,startCoords={},endCoords={},isMoved=!1,allowX=!1,allowY=!1;_this.core.$slide.on("touchstart.lg",function(e){if(_this.core.$outer.hasClass("lg-zoomed")){var $image=_this.core.$slide.eq(_this.core.index).find(".lg-object");allowY=$image.outerHeight()*$image.attr("data-scale")>_this.core.$outer.find(".lg").height(),allowX=$image.outerWidth()*$image.attr("data-scale")>_this.core.$outer.find(".lg").width(),(allowX||allowY)&&(e.preventDefault(),startCoords={x:e.originalEvent.targetTouches[0].pageX,y:e.originalEvent.targetTouches[0].pageY})}}),_this.core.$slide.on("touchmove.lg",function(e){if(_this.core.$outer.hasClass("lg-zoomed")){var distanceX,distanceY,_$el=_this.core.$slide.eq(_this.core.index).find(".lg-img-wrap");e.preventDefault(),isMoved=!0,endCoords={x:e.originalEvent.targetTouches[0].pageX,y:e.originalEvent.targetTouches[0].pageY},_this.core.$outer.addClass("lg-zoom-dragging"),distanceY=allowY?-Math.abs(_$el.attr("data-y"))+(endCoords.y-startCoords.y):-Math.abs(_$el.attr("data-y")),distanceX=allowX?-Math.abs(_$el.attr("data-x"))+(endCoords.x-startCoords.x):-Math.abs(_$el.attr("data-x")),(Math.abs(endCoords.x-startCoords.x)>15||Math.abs(endCoords.y-startCoords.y)>15)&&_$el.css({left:distanceX+"px",top:distanceY+"px"})}}),_this.core.$slide.on("touchend.lg",function(){_this.core.$outer.hasClass("lg-zoomed")&&isMoved&&(isMoved=!1,_this.core.$outer.removeClass("lg-zoom-dragging"),_this.touchendZoom(startCoords,endCoords,allowX,allowY))})},Zoom.prototype.zoomDrag=function(){var _this=this,startCoords={},endCoords={},isDraging=!1,isMoved=!1,allowX=!1,allowY=!1;_this.core.$slide.on("mousedown.lg.zoom",function(e){var $image=_this.core.$slide.eq(_this.core.index).find(".lg-object");allowY=$image.outerHeight()*$image.attr("data-scale")>_this.core.$outer.find(".lg").height(),allowX=$image.outerWidth()*$image.attr("data-scale")>_this.core.$outer.find(".lg").width(),_this.core.$outer.hasClass("lg-zoomed")&&$(e.target).hasClass("lg-object")&&(allowX||allowY)&&(e.preventDefault(),startCoords={x:e.pageX,y:e.pageY},isDraging=!0,_this.core.$outer.scrollLeft+=1,_this.core.$outer.scrollLeft-=1,_this.core.$outer.removeClass("lg-grab").addClass("lg-grabbing"))}),$(window).on("mousemove.lg.zoom",function(e){if(isDraging){var distanceX,distanceY,_$el=_this.core.$slide.eq(_this.core.index).find(".lg-img-wrap");isMoved=!0,endCoords={x:e.pageX,y:e.pageY},_this.core.$outer.addClass("lg-zoom-dragging"),distanceY=allowY?-Math.abs(_$el.attr("data-y"))+(endCoords.y-startCoords.y):-Math.abs(_$el.attr("data-y")),distanceX=allowX?-Math.abs(_$el.attr("data-x"))+(endCoords.x-startCoords.x):-Math.abs(_$el.attr("data-x")),_$el.css({left:distanceX+"px",top:distanceY+"px"})}}),$(window).on("mouseup.lg.zoom",function(e){isDraging&&(isDraging=!1,_this.core.$outer.removeClass("lg-zoom-dragging"),!isMoved||startCoords.x===endCoords.x&&startCoords.y===endCoords.y||(endCoords={x:e.pageX,y:e.pageY},_this.touchendZoom(startCoords,endCoords,allowX,allowY)),isMoved=!1),_this.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")})},Zoom.prototype.touchendZoom=function(startCoords,endCoords,allowX,allowY){var _this=this,_$el=_this.core.$slide.eq(_this.core.index).find(".lg-img-wrap"),$image=_this.core.$slide.eq(_this.core.index).find(".lg-object"),distanceX=-Math.abs(_$el.attr("data-x"))+(endCoords.x-startCoords.x),distanceY=-Math.abs(_$el.attr("data-y"))+(endCoords.y-startCoords.y),minY=(_this.core.$outer.find(".lg").height()-$image.outerHeight())/2,maxY=Math.abs($image.outerHeight()*Math.abs($image.attr("data-scale"))-_this.core.$outer.find(".lg").height()+minY),minX=(_this.core.$outer.find(".lg").width()-$image.outerWidth())/2,maxX=Math.abs($image.outerWidth()*Math.abs($image.attr("data-scale"))-_this.core.$outer.find(".lg").width()+minX);(Math.abs(endCoords.x-startCoords.x)>15||Math.abs(endCoords.y-startCoords.y)>15)&&(allowY&&(-maxY>=distanceY?distanceY=-maxY:distanceY>=-minY&&(distanceY=-minY)),allowX&&(-maxX>=distanceX?distanceX=-maxX:distanceX>=-minX&&(distanceX=-minX)),allowY?_$el.attr("data-y",Math.abs(distanceY)):distanceY=-Math.abs(_$el.attr("data-y")),allowX?_$el.attr("data-x",Math.abs(distanceX)):distanceX=-Math.abs(_$el.attr("data-x")),_$el.css({left:distanceX+"px",top:distanceY+"px"}))},Zoom.prototype.destroy=function(){var _this=this;_this.core.$el.off(".lg.zoom"),$(window).off(".lg.zoom"),_this.core.$slide.off(".lg.zoom"),_this.core.$el.off(".lg.tm.zoom"),_this.resetZoom(),clearTimeout(_this.zoomabletimeout),_this.zoomabletimeout=!1},$.fn.lightGallery.modules.zoom=Zoom}(jQuery,window,document),function($,window,document,undefined){"use strict";var defaults={hash:!0},Hash=function(element){return this.core=$(element).data("lightGallery"),this.core.s=$.extend({},defaults,this.core.s),this.core.s.hash&&(this.oldHash=window.location.hash,this.init()),this};Hash.prototype.init=function(){var _hash,_this=this;_this.core.$el.on("onAfterSlide.lg.tm",function(event,prevIndex,index){window.location.hash="lg="+_this.core.s.galleryId+"&slide="+index}),$(window).on("hashchange.lg.hash",function(){_hash=window.location.hash;var _idx=parseInt(_hash.split("&slide=")[1],10);_hash.indexOf("lg="+_this.core.s.galleryId)>-1?_this.core.slide(_idx,!1,!1):_this.core.lGalleryOn&&_this.core.destroy()})},Hash.prototype.destroy=function(){this.core.s.hash&&(this.oldHash&&this.oldHash.indexOf("lg="+this.core.s.galleryId)<0?window.location.hash=this.oldHash:history.pushState?history.pushState("",document.title,window.location.pathname+window.location.search):window.location.hash="",this.core.$el.off(".lg.hash"))},$.fn.lightGallery.modules.hash=Hash}(jQuery,window,document);